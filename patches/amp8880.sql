CREATE OR REPLACE VIEW v_districts AS SELECT al.amp_activity_id, cvl.location_name,l.location_id,sum(al.location_percentage) as location_percentage from amp_category_value_location cvl, amp_activity_location al, amp_location l, amp_category_value t where t.category_value='District' and al.amp_location_id=l.amp_location_id and l.location_id=cvl.id and cvl.parent_category_value=t.id group by al.amp_activity_id, l.location_id;
CREATE OR REPLACE VIEW v_zones AS SELECT al.amp_activity_id, cvl.location_name,l.location_id,sum(al.location_percentage) as location_percentage from amp_category_value_location cvl, amp_activity_location al, amp_location l, amp_category_value t where t.category_value='Zone' and al.amp_location_id=l.amp_location_id and l.location_id=cvl.id and cvl.parent_category_value=t.id group by al.amp_activity_id, l.location_id;
INSERT INTO amp_columns (columnName,aliasName,cellType,extractorView) VALUES ('District','district','org.dgfoundation.amp.ar.cell.MetaTextCell','v_districts');
INSERT INTO amp_columns (columnName,aliasName,cellType,extractorView) VALUES ('Zone','zone','org.dgfoundation.amp.ar.cell.MetaTextCell','v_zones');