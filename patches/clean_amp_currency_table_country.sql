CREATE FUNCTION applyThousandsForVisibility (d double) RETURNS double begin declare thousands char(5);select settingsValue into thousands from amp_global_settings where settingsName='Amounts in Thousands';if thousands='true' then return d*0.001;end if;return d;END;;
CREATE FUNCTION getExchange (currency char(3), cdate datetime) RETURNS double begin
declare r double;
DECLARE CONTINUE HANDLER FOR NOT FOUND BEGIN END;
if currency='USD' then return 1;
end if;
select exchange_rate into r from amp_currency_rate where to_currency_code=currency and exchange_rate_date=cdate;
if r is not null then return r;
end if;
select exchange_rate into r from amp_currency_rate where to_currency_code=currency and exchange_rate_date<=cdate order by exchange_rate_date desc limit 1;
if r is not null then return r;
end if;
select exchange_rate into r from amp_currency_rate where to_currency_code=currency and exchange_rate_date>=cdate order by exchange_rate_date limit 1;
if r is not null then return r;
end if;
return 1;
END;;
CREATE FUNCTION getExchangeWithFixed (currency char(3), cdate datetime,fixedExchangeRate double) RETURNS double begin if fixedExchangeRate is not null then return fixedExchangeRate;end if;return getExchange(currency,cdate);end;;
CREATE FUNCTION getParentSectorId (sectorId BIGINT(20)) RETURNS bigint(20) BEGIN        declare sid bigint(20);        declare pid bigint(20);        select parent_sector_id into pid from amp_sector where amp_sector_id=sectorId;        if pid is null then                 return sectorId;        end if;        while pid is not null do                set sid =pid;                select parent_sector_id into pid from amp_sector where amp_sector_id=sid;        end while;        return sid;END;;
CREATE FUNCTION getParentSubSectorId (sectorId BIGINT(20)) RETURNS bigint(20) BEGIN     declare sid bigint(20); 	declare depth int; 	select getSectorDepth(sectorId) into depth from dual; 	if (depth = 1) then 		return sectorId; 	end if; 	if (depth = 2) then 	        select parent_sector_id into sid from amp_sector where amp_sector_id=sectorId; 		return sid; 	end if; 		return 0; END;;
CREATE FUNCTION getReportColumnId (cn varchar(64)) RETURNS double begin declare id double;select columnId into id from amp_columns where columnName=cn limit 1;return id;END;;
CREATE FUNCTION getSectorDepth (sectorId BIGINT(20)) RETURNS int(11) BEGIN        	declare depth int;         declare sid bigint(20);         declare pid bigint(20); 	set depth = 0;         select parent_sector_id into pid from amp_sector where amp_sector_id=sectorId;         if pid is null then                  return depth;         end if;         while pid is not null do 		set depth = depth + 1;                 set sid = pid;                 select parent_sector_id into pid from amp_sector where amp_sector_id=sid;         end while;         return depth; END;;
CREATE FUNCTION getSectorName (sectorId BIGINT(20)) RETURNS varchar(256) CHARSET latin1 BEGIN         declare ret varchar(256);         select name into ret from amp_sector where amp_sector_id=sectorId;    return ret;END;;
CREATE FUNCTION getSQLDateFormat () RETURNS varchar(12) CHARSET latin1 begin declare gsFormat varchar(12);select settingsValue into gsFormat from amp_global_settings where settingsName='Default Date Format';if gsFormat='dd/MM/yyyy' then return '%d/%m/%Y';end if;if gsFormat='dd/MMM/yyyy' then return '%d/%b/%Y';end if;if gsFormat='MMM/dd/yyyy' then return '%b/%d/%Y';end if;if gsFormat='MM/dd/yyyy' then return '%m/%d/%Y';end if;return 'none';END;;
CREATE FUNCTION getTransactionAmmountUSD (fdId long) RETURNS double begin declare r double; declare code char(3); declare dateFD datetime;  declare amount double;  select transaction_amount/fixed_exchange_rate into r from amp_funding_detail where amp_fund_detail_id =fdId and fixed_exchange_rate is not NULL;if r is not null then return r;end if; select cur.currency_code, transaction_date, transaction_amount into code,dateFD,amount from amp_currency cur inner join amp_funding_detail det on cur.amp_currency_id=det.amp_currency_id where det.amp_fund_detail_id =fdId; return amount/getExchange(code,dateFD); END;;

CREATE OR REPLACE VIEW v_ac_chapters AS /* ALGORITHM=UNDEFINED */ select `acc`.`amp_activity_id` AS `amp_activity_id`,`acv`.`category_value` AS `name` from ((`amp_activities_categoryvalues` `acc` join `amp_category_value` `acv`) join `amp_category_class` `ac`) where ((`acv`.`id` = `acc`.`amp_categoryvalue_id`) and (`ac`.`id` = `acv`.`amp_category_class_id`) and (`ac`.`keyName` = _latin1'acchapter'));;
CREATE OR REPLACE VIEW v_accession_instruments AS /* ALGORITHM=UNDEFINED */ select `acc`.`amp_activity_id` AS `amp_activity_id`,`acv`.`category_value` AS `name` from ((`amp_activities_categoryvalues` `acc` join `amp_category_value` `acv`) join `amp_category_class` `ac`) where ((`acv`.`id` = `acc`.`amp_categoryvalue_id`) and (`ac`.`id` = `acv`.`amp_category_class_id`) and (`ac`.`keyName` = _latin1'accessioninstr'));;
CREATE OR REPLACE VIEW v_activity_changed_by AS /* ALGORITHM=UNDEFINED */ select `a`.`amp_activity_id` AS `amp_activity_id`,`u`.`EMAIL` AS `name`,`atm`.`user_` AS `user_id` from ((`amp_activity` `a` join `amp_team_member` `atm`) join `dg_user` `u`) where ((`atm`.`amp_team_mem_id` = `a`.`updated_by`) and (`atm`.`user_` = `u`.`ID`)) order by `a`.`amp_activity_id`;;
CREATE OR REPLACE VIEW v_activity_creator AS /* ALGORITHM=UNDEFINED */ select `a`.`amp_activity_id` AS `amp_activity_id`,concat(`u`.`FIRST_NAMES`,_latin1'\n         ',`u`.`LAST_NAME`) AS `name`,`atm`.`user_` AS `user_id` from ((`amp_activity` `a` join `amp_team_member` `atm`) join `dg_user` `u`) where ((`atm`.`amp_team_mem_id` = `a`.`activity_creator`) and (`atm`.`user_` = `u`.`ID`)) order by `a`.`amp_activity_id`;;
CREATE OR REPLACE VIEW v_actors AS /* ALGORITHM=UNDEFINED */ select `ai`.`amp_activity_id` AS `amp_activity_id`,`act`.`name` AS `name`,`act`.`amp_actor_id` AS `amp_actor_id` from (((`amp_activity` `a` join `amp_measure` `m`) join `amp_issues` `ai`) join `amp_actor` `act`) where ((`ai`.`amp_activity_id` = `a`.`amp_activity_id`) and (`ai`.`amp_issue_id` = `m`.`amp_issue_id`) and (`act`.`amp_measure_id` = `m`.`amp_measure_id`)) order by `ai`.`amp_activity_id`;;
CREATE OR REPLACE VIEW v_actual_approval_date AS /* ALGORITHM=UNDEFINED */ select `amp_activity`.`amp_activity_id` AS `amp_activity_id`,`amp_activity`.`actual_approval_date` AS `actual_approval_date` from `amp_activity` order by `amp_activity`.`amp_activity_id`;;
CREATE OR REPLACE VIEW v_actual_completion_date AS /* ALGORITHM=UNDEFINED */ select `amp_activity`.`amp_activity_id` AS `amp_activity_id`,date_format(`amp_activity`.`actual_completion_date`,_latin1'%Y-%m-%d') AS `actual_completion_date` from `amp_activity` order by `amp_activity`.`amp_activity_id`;;
CREATE OR REPLACE VIEW v_actual_proposed_date AS /* ALGORITHM=UNDEFINED */ select `amp_activity`.`amp_activity_id` AS `amp_activity_id`,`amp_activity`.`proposed_approval_date` AS `proposed_approval_date` from `amp_activity` order by `amp_activity`.`amp_activity_id`;;
CREATE OR REPLACE VIEW v_actual_start_date AS /* ALGORITHM=UNDEFINED */ select `amp_activity`.`amp_activity_id` AS `amp_activity_id`,date_format(`amp_activity`.`actual_start_date`,_latin1'%Y-%m-%d') AS `actual_start_date` from `amp_activity` order by `amp_activity`.`amp_activity_id`;;
CREATE OR REPLACE VIEW v_amp_id AS /* ALGORITHM=UNDEFINED */ select `amp_activity`.`amp_activity_id` AS `amp_activity_id`,`amp_activity`.`amp_id` AS `amp_id` from `amp_activity`;;
CREATE OR REPLACE VIEW v_amp_theme AS /* ALGORITHM=UNDEFINED */ select `amp_theme`.`amp_theme_id` AS `id`,`amp_theme`.`name` AS `value` from `amp_theme`;;
CREATE OR REPLACE VIEW v_ampid AS /* ALGORITHM=UNDEFINED */ select `amp_activity`.`amp_activity_id` AS `amp_activity_id`,`amp_activity`.`amp_id` AS `amp_id` from `amp_activity` order by `amp_activity`.`amp_activity_id`;;
CREATE OR REPLACE VIEW v_beneficiary_agency AS /* ALGORITHM=UNDEFINED */ select `f`.`activity` AS `amp_activity_id`,`o`.`name` AS `name`,`f`.`organisation` AS `amp_org_id` from ((`amp_org_role` `f` join `amp_organisation` `o`) join `amp_role` `r` on(((`f`.`organisation` = `o`.`amp_org_id`) and (`f`.`role` = `r`.`amp_role_id`) and (`r`.`role_code` = _latin1'BA')))) order by `f`.`activity`,`o`.`name`;;
CREATE OR REPLACE VIEW v_beneficiary_agency_groups AS /* ALGORITHM=UNDEFINED */ select `f`.`activity` AS `amp_activity_id`,`b`.`org_grp_name` AS `name`,`b`.`amp_org_grp_id` AS `amp_org_grp_id` from (((`amp_org_role` `f` join `amp_organisation` `o`) join `amp_role` `r`) join `amp_org_group` `b` on(((`f`.`organisation` = `o`.`amp_org_id`) and (`f`.`role` = `r`.`amp_role_id`) and (`r`.`role_code` = _latin1'BA') and (`o`.`org_grp_id` = `b`.`amp_org_grp_id`)))) order by `f`.`activity`,`o`.`name`;;
CREATE OR REPLACE VIEW v_bolivia_component_code AS /* ALGORITHM=UNDEFINED */ select `a`.`amp_activity_id` AS `amp_activity_id`,`c`.`code` AS `code` from (`amp_activity_components` `a` join `amp_components` `c` on((`a`.`amp_component_id` = `c`.`amp_component_id`))) order by `a`.`amp_activity_id`;;
CREATE OR REPLACE VIEW v_component_description AS /* ALGORITHM=UNDEFINED */ select distinct `a`.`amp_activity_id` AS `amp_activity_id`,`b`.`description` AS `title`,`b`.`amp_component_id` AS `amp_component_id` from ((`amp_activity` `a` join `amp_components` `b`) join `amp_component_funding` `c`) where ((`a`.`amp_activity_id` = `c`.`activity_id`) and (`b`.`amp_component_id` = `c`.`amp_component_id`));;
CREATE OR REPLACE VIEW v_component_funding AS /* ALGORITHM=UNDEFINED */ select `f`.`activity_id` AS `amp_activity_id`,`f`.`amp_component_funding_id` AS `amp_component_funding_id`,`f`.`amp_component_funding_id` AS `amp_fund_detail_id`,`c`.`title` AS `component_name`,`f`.`transaction_type` AS `transaction_type`,`f`.`adjustment_type` AS `adjustment_type`,`f`.`transaction_date` AS `transaction_date`,`f`.`transaction_amount` AS `transaction_amount`,`f`.`currency_id` AS `currency_id`,`cu`.`currency_code` AS `currency_code` from ((`amp_component_funding` `f` join `amp_components` `c`) join `amp_currency` `cu`) where ((`cu`.`amp_currency_id` = `f`.`currency_id`) and (`f`.`amp_component_id` = `c`.`amp_component_id`)) order by `f`.`activity_id`;;
CREATE OR REPLACE VIEW v_component_type AS /* ALGORITHM=UNDEFINED */ select `aac`.`amp_activity_id` AS `amp_activity_id`,`ct`.`name` AS `component_type`,`ct`.`type_id` AS `component_type_id` from ((`amp_components` `c` join `amp_component_type` `ct`) join `amp_activity_components` `aac`) where ((`c`.`type` = `ct`.`type_id`) and (`aac`.`amp_component_id` = `c`.`amp_component_id`));;
CREATE OR REPLACE VIEW v_componente AS /* ALGORITHM=UNDEFINED */ select `sa`.`amp_activity_id` AS `amp_activity_id`,`s`.`name` AS `name`,`sa`.`amp_sector_id` AS `amp_sector_id`,`sa`.`percentage` AS `percentage` from (`amp_activity_componente` `sa` join `amp_sector` `s` on((`sa`.`amp_sector_id` = `s`.`amp_sector_id`))) order by `sa`.`amp_activity_id`,`s`.`name`;;
CREATE OR REPLACE VIEW v_components AS /* ALGORITHM=UNDEFINED */ select distinct `a`.`amp_activity_id` AS `amp_activity_id`,`b`.`title` AS `title`,`b`.`amp_component_id` AS `amp_component_id` from ((`amp_activity` `a` join `amp_components` `b`) join `amp_component_funding` `c`) where ((`a`.`amp_activity_id` = `c`.`activity_id`) and (`b`.`amp_component_id` = `c`.`amp_component_id`));;
CREATE OR REPLACE VIEW v_contact_name AS /* ALGORITHM=UNDEFINED */ (select `amp_activity`.`amp_activity_id` AS `amp_activity_id`,concat_ws(_latin1' ',`amp_activity`.`cont_first_name`,`amp_activity`.`cont_last_name`) AS `contact`,`amp_activity`.`amp_activity_id` AS `contact_id` from `amp_activity` where (trim(concat_ws(_latin1' ',`amp_activity`.`cont_first_name`,`amp_activity`.`cont_last_name`)) <> _latin1'')) union (select `amp_activity`.`amp_activity_id` AS `amp_activity_id`,concat_ws(_latin1' ',`amp_activity`.`mofed_cnt_first_name`,`amp_activity`.`mofed_cnt_last_name`) AS `contact`,`amp_activity`.`amp_activity_id` AS `contact_id` from `amp_activity` where (trim(concat_ws(_latin1' ',`amp_activity`.`mofed_cnt_first_name`,`amp_activity`.`mofed_cnt_last_name`)) <> _latin1''));;
CREATE OR REPLACE VIEW v_contracting_agency AS /* ALGORITHM=UNDEFINED */ select `f`.`activity` AS `amp_activity_id`,`o`.`name` AS `name`,`f`.`organisation` AS `amp_org_id` from ((`amp_org_role` `f` join `amp_organisation` `o`) join `amp_role` `r` on(((`f`.`organisation` = `o`.`amp_org_id`) and (`f`.`role` = `r`.`amp_role_id`) and (`r`.`role_code` = _latin1'CA')))) order by `f`.`activity`,`o`.`name`;;
CREATE OR REPLACE VIEW v_contribution_funding AS /* ALGORITHM=UNDEFINED */ select `eu`.`amp_activity_id` AS `amp_activity_id`,`eu`.`id` AS `amp_funding_id`,`euc`.`id` AS `amp_funding_detail_id`,`o`.`name` AS `donor_name`,`euc`.`amount` AS `transaction_amount`,`euc`.`transaction_date` AS `transaction_date`,`c`.`currency_code` AS `currency_code`,`acv_term`.`category_value` AS `terms_assist_name`,`acv_mod`.`category_value` AS `financing_instrument_name`,`o`.`amp_org_id` AS `amp_org_id`,`o`.`org_grp_id` AS `org_grp_id`,`acv_term`.`id` AS `terms_assist_id` from (((((`amp_eu_activity` `eu` join `amp_eu_activity_contributions` `euc`) join `amp_currency` `c`) join `amp_category_value` `acv_term`) join `amp_category_value` `acv_mod`) join `amp_organisation` `o`) where ((`eu`.`id` = `euc`.`eu_activity_id`) and (`euc`.`amount_currency` = `c`.`amp_currency_id`) and (`acv_term`.`id` = `euc`.`financing_type_categ_val_id`) and (`acv_mod`.`id` = `euc`.`FINANCING_INSTR_CATEGORY_VALUE`) and (`o`.`amp_org_id` = `euc`.`donor_id`)) order by `eu`.`amp_activity_id`;;
CREATE OR REPLACE VIEW v_convenio_numcont AS /* ALGORITHM=UNDEFINED */ select `amp_activity`.`amp_activity_id` AS `amp_activity_id`,(case `amp_activity`.`convenio_numcont` when _utf8'-' then NULL when _utf8'.' then NULL else `amp_activity`.`convenio_numcont` end) AS `numcont` from `amp_activity` order by `amp_activity`.`amp_activity_id`;;
CREATE OR REPLACE VIEW v_costing_donors AS /* ALGORITHM=UNDEFINED */ select `eu`.`amp_activity_id` AS `amp_activity_id`,`o`.`name` AS `name`,`euc`.`donor_id` AS `donor_id` from (((`amp_activity` `a` join `amp_eu_activity` `eu`) join `amp_eu_activity_contributions` `euc`) join `amp_organisation` `o`) where ((`a`.`amp_activity_id` = `eu`.`amp_activity_id`) and (`eu`.`id` = `euc`.`eu_activity_id`) and (`euc`.`donor_id` = `o`.`amp_org_id`)) order by `o`.`name`;;
CREATE OR REPLACE VIEW v_costs AS /* ALGORITHM=UNDEFINED */ select `eu`.`amp_activity_id` AS `amp_activity_id`,`eu`.`id` AS `eu_id`,`eu`.`total_cost` AS `cost`,`c`.`currency_code` AS `currency_code`,`eu`.`transaction_date` AS `currency_date`,`getExchange`(`c`.`currency_code`,`eu`.`transaction_date`) AS `exchange_rate` from (`amp_eu_activity` `eu` join `amp_currency` `c`) where (`eu`.`total_cost_currency_id` = `c`.`amp_currency_id`);;
CREATE OR REPLACE VIEW v_creation_date AS /* ALGORITHM=UNDEFINED */ select `a`.`amp_activity_id` AS `amp_activity_id`,`a`.`date_created` AS `creation_date` from `amp_activity` `a` order by `a`.`amp_activity_id`;;
CREATE OR REPLACE VIEW v_date_formats AS /* ALGORITHM=UNDEFINED */ select `util_global_settings_possible_`.`value_id` AS `id`,`util_global_settings_possible_`.`value_shown` AS `value` from `util_global_settings_possible_` where (`util_global_settings_possible_`.`setting_name` = _utf8'Default Date Format');;
CREATE OR REPLACE VIEW v_default_number_format AS /* ALGORITHM=UNDEFINED */ select `util_global_settings_possible_`.`value_id` AS `id`,`util_global_settings_possible_`.`value_shown` AS `value` from `util_global_settings_possible_` where (`util_global_settings_possible_`.`setting_name` = _utf8'Default Number Format');;
CREATE OR REPLACE VIEW v_description AS /* ALGORITHM=UNDEFINED */ select distinct `amp_activity`.`amp_activity_id` AS `amp_activity_id`,trim(`dg_editor`.`BODY`) AS `ebody` from (`amp_activity` join `dg_editor`) where (`amp_activity`.`description` = `dg_editor`.`EDITOR_KEY`) order by `amp_activity`.`amp_activity_id`;;
CREATE OR REPLACE VIEW v_donor_commitment_date AS /* ALGORITHM=UNDEFINED */ select `f`.`amp_activity_id` AS `amp_activity_id`,`fd`.`transaction_date` AS `transaction_date` from (`amp_funding` `f` join `amp_funding_detail` `fd`) where ((`f`.`amp_funding_id` = `fd`.`amp_funding_id`) and (`fd`.`transaction_type` = 0)) order by `f`.`amp_activity_id`,`fd`.`transaction_date`;;
CREATE OR REPLACE VIEW v_donor_date_hierarchy AS /* ALGORITHM=UNDEFINED */ select `a`.`amp_activity_id` AS `amp_activity_id`,`fd`.`amp_fund_detail_id` AS `amp_fund_detail_id`,`fd`.`transaction_date` AS `full_date`,year(`fd`.`transaction_date`) AS `year`,month(`fd`.`transaction_date`) AS `month`,cast(monthname(`fd`.`transaction_date`) as char charset utf8) AS `month_name`,quarter(`fd`.`transaction_date`) AS `quarter`,concat(_utf8'Q',cast(quarter(`fd`.`transaction_date`) as char charset utf8)) AS `quarter_name` from ((`amp_activity` `a` join `amp_funding` `f`) join `amp_funding_detail` `fd`) where ((`a`.`amp_activity_id` = `f`.`amp_activity_id`) and (`f`.`amp_funding_id` = `fd`.`amp_funding_id`));;
CREATE OR REPLACE VIEW v_donor_funding AS /* ALGORITHM=UNDEFINED */ select `f`.`amp_activity_id` AS `amp_activity_id`,`f`.`amp_funding_id` AS `amp_funding_id`,`fd`.`amp_fund_detail_id` AS `amp_fund_detail_id`,`d`.`name` AS `donor_name`,`fd`.`transaction_type` AS `transaction_type`,`fd`.`adjustment_type` AS `adjustment_type`,`fd`.`transaction_date` AS `transaction_date`,`fd`.`transaction_amount` AS `transaction_amount`,`c`.`currency_code` AS `currency_code`,`cval`.`id` AS `terms_assist_id`,`cval`.`category_value` AS `terms_assist_name`,`fd`.`fixed_exchange_rate` AS `fixed_exchange_rate`,`b`.`org_grp_name` AS `org_grp_name`,`ot`.`org_type` AS `donor_type_name`,`cval2`.`category_value` AS `financing_instrument_name`,`cval2`.`id` AS `financing_instrument_id`,`d`.`amp_org_id` AS `org_id`,`d`.`org_grp_id` AS `org_grp_id`,`ot`.`amp_org_type_id` AS `org_type_id` from (((((((`amp_funding` `f` join `amp_funding_detail` `fd`) join `amp_category_value` `cval`) join `amp_currency` `c`) join `amp_organisation` `d`) join `amp_org_group` `b`) join `amp_org_type` `ot`) join `amp_category_value` `cval2`) where ((`cval2`.`id` = `f`.`financing_instr_category_value`) and (`c`.`amp_currency_id` = `fd`.`amp_currency_id`) and (`f`.`amp_funding_id` = `fd`.`amp_funding_id`) and (`cval`.`id` = `f`.`type_of_assistance_category_va`) and (`d`.`amp_org_id` = `f`.`amp_donor_org_id`) and (`d`.`org_grp_id` = `b`.`amp_org_grp_id`) and (`ot`.`amp_org_type_id` = `d`.`org_type_id`)) order by `f`.`amp_activity_id`;;
CREATE OR REPLACE VIEW v_donor_funding_cached AS /* ALGORITHM=UNDEFINED */ select `f`.`amp_activity_id` AS `amp_activity_id`,`f`.`amp_funding_id` AS `amp_funding_id`,`fd`.`amp_fund_detail_id` AS `amp_fund_detail_id`,`d`.`name` AS `donor_name`,`fd`.`transaction_type` AS `transaction_type`,`fd`.`adjustment_type` AS `adjustment_type`,`fd`.`transaction_date` AS `transaction_date`,((`fd`.`transaction_amount` * `sa`.`sector_percentage`) / 100) AS `transaction_amount`,`c`.`currency_code` AS `currency_code`,`cval`.`id` AS `terms_assist_id`,`cval`.`category_value` AS `terms_assist_name`,`fd`.`fixed_exchange_rate` AS `fixed_exchange_rate`,`b`.`org_grp_name` AS `org_grp_name`,`ot`.`org_type` AS `donor_type_name`,`cval2`.`category_value` AS `financing_instrument_name`,`cval2`.`id` AS `financing_instrument_id`,`d`.`amp_org_id` AS `org_grp_id`,`ot`.`amp_org_type_id` AS `org_type_id`,`fd`.`disbursement_order_rejected` AS `disb_ord_rej`,`getSectorName`(`getParentSectorId`(`s`.`amp_sector_id`)) AS `sectorname`,`getParentSectorId`(`s`.`amp_sector_id`) AS `amp_sector_id`,`sa`.`sector_percentage` AS `sector_percentage`,`ss`.`sec_scheme_name` AS `sec_scheme_name`,`cc`.`name` AS `classification_name`,`cc`.`classification_id` AS `classification_id`,`ss`.`amp_sec_scheme_id` AS `amp_sec_scheme_id`,`sa`.`classification_config_id` AS `sec_act_id`,`cc`.`id` AS `cc_id`,`s`.`sector_code` AS `sector_code` from (((((((((((`amp_funding` `f` join `amp_funding_detail` `fd` on((`f`.`amp_funding_id` = `fd`.`amp_funding_id`))) join `amp_category_value` `cval`) join `amp_currency` `c`) join `amp_organisation` `d`) join `amp_org_group` `b`) join `amp_org_type` `ot`) join `amp_category_value` `cval2`) join `amp_activity_sector` `sa` on((`f`.`amp_activity_id` = `sa`.`amp_activity_id`))) join `amp_sector` `s` on((`sa`.`amp_sector_id` = `s`.`amp_sector_id`))) join `amp_sector_scheme` `ss`) join `amp_classification_config` `cc`) where ((`cval2`.`id` = `f`.`financing_instr_category_value`) and (`c`.`amp_currency_id` = `fd`.`amp_currency_id`) and (`f`.`amp_funding_id` = `fd`.`amp_funding_id`) and (`cval`.`id` = `f`.`type_of_assistance_category_va`) and (`d`.`amp_org_id` = `f`.`amp_donor_org_id`) and (`d`.`org_grp_id` = `b`.`amp_org_grp_id`) and (`ot`.`amp_org_type_id` = `d`.`org_type_id`) and (`cc`.`name` = _latin1'Primary') and (`sa`.`classification_config_id` = `cc`.`id`) and (`cc`.`classification_id` = `ss`.`amp_sec_scheme_id`)) group by `getParentSectorId`(`s`.`amp_sector_id`),`fd`.`transaction_type`,`fd`.`amp_fund_detail_id`,`f`.`amp_funding_id`,`fd`.`adjustment_type`,`s`.`sector_code` order by `f`.`amp_activity_id`,`getSectorName`(`getParentSectorId`(`s`.`amp_sector_id`)),`fd`.`transaction_type`,`f`.`amp_funding_id`;;
CREATE OR REPLACE VIEW v_donor_groups AS /* ALGORITHM=UNDEFINED */ select `a`.`amp_activity_id` AS `amp_activity_id`,`b`.`org_grp_name` AS `name`,`b`.`amp_org_grp_id` AS `amp_org_grp_id` from ((`amp_funding` `a` join `amp_organisation` `c`) join `amp_org_group` `b`) where ((`a`.`amp_donor_org_id` = `c`.`amp_org_id`) and (`c`.`org_grp_id` = `b`.`amp_org_grp_id`)) order by `a`.`amp_activity_id`;;
CREATE OR REPLACE VIEW v_donor_type AS /* ALGORITHM=UNDEFINED */ select `f`.`amp_activity_id` AS `amp_activity_id`,`ot`.`org_type` AS `org_type`,`ot`.`amp_org_type_id` AS `org_type_id` from ((`amp_funding` `f` join `amp_organisation` `o`) join `amp_org_type` `ot`) where ((`f`.`amp_donor_org_id` = `o`.`amp_org_id`) and (`ot`.`amp_org_type_id` = `o`.`org_type_id`)) order by `f`.`amp_activity_id`,`ot`.`org_type`;;
CREATE OR REPLACE VIEW v_donors AS /* ALGORITHM=UNDEFINED */ select `f`.`amp_activity_id` AS `amp_activity_id`,`o`.`name` AS `name`,`f`.`amp_donor_org_id` AS `amp_donor_org_id`,`o`.`org_grp_id` AS `org_grp_id`,`o`.`org_type_id` AS `org_type_id` from (`amp_funding` `f` join `amp_organisation` `o`) where (`f`.`amp_donor_org_id` = `o`.`amp_org_id`) order by `f`.`amp_activity_id`,`o`.`name`;;
CREATE OR REPLACE VIEW v_executing_agency AS /* ALGORITHM=UNDEFINED */ select `f`.`activity` AS `amp_activity_id`,`o`.`name` AS `name`,`f`.`organisation` AS `amp_org_id`,`f`.`percentage` AS `percentage` from ((`amp_org_role` `f` join `amp_organisation` `o`) join `amp_role` `r` on(((`f`.`organisation` = `o`.`amp_org_id`) and (`f`.`role` = `r`.`amp_role_id`) and (`r`.`role_code` = _latin1'EA')))) order by `f`.`activity`,`o`.`name`;;
CREATE OR REPLACE VIEW v_executing_agency_groups AS /* ALGORITHM=UNDEFINED */ select `f`.`activity` AS `amp_activity_id`,`b`.`org_grp_name` AS `name`,`b`.`amp_org_grp_id` AS `amp_org_grp_id` from (((`amp_org_role` `f` join `amp_organisation` `o`) join `amp_role` `r`) join `amp_org_group` `b` on(((`f`.`organisation` = `o`.`amp_org_id`) and (`f`.`role` = `r`.`amp_role_id`) and (`r`.`role_code` = _latin1'EA') and (`o`.`org_grp_id` = `b`.`amp_org_grp_id`)))) order by `f`.`activity`,`o`.`name`;;
CREATE OR REPLACE VIEW v_financing_instrument AS /* ALGORITHM=UNDEFINED */ (select `f`.`amp_activity_id` AS `amp_activity_id`,`val`.`category_value` AS `name`,`f`.`financing_instr_category_value` AS `amp_modality_id` from (`amp_funding` `f` join `amp_category_value` `val`) where (`f`.`financing_instr_category_value` = `val`.`id`)) union (select `eu`.`amp_activity_id` AS `amp_activity_id`,`val`.`category_value` AS `category_value`,`eu_con`.`FINANCING_INSTR_CATEGORY_VALUE` AS `financing_instr_category_value` from ((`amp_eu_activity` `eu` join `amp_eu_activity_contributions` `eu_con`) join `amp_category_value` `val`) where ((`eu_con`.`eu_activity_id` = `eu`.`id`) and (`eu_con`.`FINANCING_INSTR_CATEGORY_VALUE` = `val`.`id`))) order by `amp_activity_id`,`name`;;
CREATE OR REPLACE VIEW v_g_settings_countries AS /* ALGORITHM=UNDEFINED */ select `dg_countries`.`ISO` AS `id`,`dg_countries`.`COUNTRY_NAME` AS `value` from `dg_countries` order by `dg_countries`.`COUNTRY_NAME`;;
CREATE OR REPLACE VIEW v_g_settings_curr_fiscal_year AS /* ALGORITHM=UNDEFINED */ select `util_global_settings_possible_`.`value_id` AS `id`,`util_global_settings_possible_`.`value_shown` AS `value` from `util_global_settings_possible_` where (`util_global_settings_possible_`.`setting_name` = _utf8'Current Fiscal Year');;
CREATE OR REPLACE VIEW v_g_settings_def_comp_type AS /* ALGORITHM=UNDEFINED */ select `amp_component_type`.`type_id` AS `id`,`amp_component_type`.`name` AS `value` from `amp_component_type` where (`amp_component_type`.`enable` = 1);;
CREATE OR REPLACE VIEW v_g_settings_default_calendar AS /* ALGORITHM=UNDEFINED */ select `amp_fiscal_calendar`.`amp_fiscal_cal_id` AS `id`,`amp_fiscal_calendar`.`name` AS `value` from `amp_fiscal_calendar`;;
CREATE OR REPLACE VIEW v_g_settings_feature_templates AS /* ALGORITHM=UNDEFINED */ select `amp_feature_templates`.`id` AS `id`,`amp_feature_templates`.`featureTemplateName` AS `value` from `amp_feature_templates`;;
CREATE OR REPLACE VIEW v_g_settings_filter_reports AS /* ALGORITHM=UNDEFINED */ select `util_global_settings_possible_`.`value_id` AS `id`,`util_global_settings_possible_`.`value_shown` AS `value` from `util_global_settings_possible_` where (`util_global_settings_possible_`.`setting_name` = _utf8'Filter reports by month');;
CREATE OR REPLACE VIEW v_g_settings_public_view AS /* ALGORITHM=UNDEFINED */ select `util_global_settings_possible_`.`value_id` AS `id`,`util_global_settings_possible_`.`value_shown` AS `value` from `util_global_settings_possible_` where (`util_global_settings_possible_`.`setting_name` = _utf8'Public View');;
CREATE OR REPLACE VIEW v_g_settings_pv_budget_filter AS /* ALGORITHM=UNDEFINED */ select `util_global_settings_possible_`.`value_id` AS `id`,`util_global_settings_possible_`.`value_shown` AS `value` from `util_global_settings_possible_` where (`util_global_settings_possible_`.`setting_name` = _utf8'Public View Budget Filter');;
CREATE OR REPLACE VIEW v_g_settings_sector_schemes AS /* ALGORITHM=UNDEFINED */ select `amp_sector_scheme`.`amp_sec_scheme_id` AS `id`,`amp_sector_scheme`.`sec_scheme_name` AS `value` from `amp_sector_scheme` order by `amp_sector_scheme`.`sec_scheme_name`;;
CREATE OR REPLACE VIEW v_g_settings_sh_comp_fund_year AS /* ALGORITHM=UNDEFINED */ select `util_global_settings_possible_`.`value_id` AS `id`,`util_global_settings_possible_`.`value_shown` AS `value` from `util_global_settings_possible_` where (`util_global_settings_possible_`.`setting_name` = _utf8'Show Component Funding by Year');;
CREATE OR REPLACE VIEW v_g_settings_templ_visibility AS /* ALGORITHM=UNDEFINED */ select `amp_templates_visibility`.`id` AS `id`,`amp_templates_visibility`.`name` AS `value` from `amp_templates_visibility`;;
CREATE OR REPLACE VIEW v_implementation_level AS /* ALGORITHM=UNDEFINED */ select `aac`.`amp_activity_id` AS `amp_activity_id`,`acv`.`category_value` AS `name`,`aac`.`amp_categoryvalue_id` AS `level_code` from ((`amp_category_value` `acv` join `amp_category_class` `acc`) join `amp_activities_categoryvalues` `aac`) where ((`acv`.`id` = `aac`.`amp_categoryvalue_id`) and (`acc`.`id` = `acv`.`amp_category_class_id`) and (`acc`.`keyName` = _latin1'implementation_level'));;
CREATE OR REPLACE VIEW v_implementation_location AS /* ALGORITHM=UNDEFINED */ select `aac`.`amp_activity_id` AS `amp_activity_id`,`acv`.`category_value` AS `name`,`aac`.`amp_categoryvalue_id` AS `amp_status_id` from ((`amp_category_value` `acv` join `amp_category_class` `acc`) join `amp_activities_categoryvalues` `aac`) where ((`acv`.`id` = `aac`.`amp_categoryvalue_id`) and (`acc`.`id` = `acv`.`amp_category_class_id`) and (`acc`.`keyName` = _latin1'implementation_location'));;
CREATE OR REPLACE VIEW v_implementing_agency AS /* ALGORITHM=UNDEFINED */ select `f`.`activity` AS `amp_activity_id`,`o`.`name` AS `name`,`f`.`organisation` AS `amp_org_id` from ((`amp_org_role` `f` join `amp_organisation` `o`) join `amp_role` `r` on(((`f`.`organisation` = `o`.`amp_org_id`) and (`f`.`role` = `r`.`amp_role_id`) and (`r`.`role_code` = _latin1'IA')))) order by `f`.`activity`,`o`.`name`;;
CREATE OR REPLACE VIEW v_implementing_agency_groups AS /* ALGORITHM=UNDEFINED */ select `f`.`activity` AS `amp_activity_id`,`b`.`org_grp_name` AS `name`,`b`.`amp_org_grp_id` AS `amp_org_grp_id` from (((`amp_org_role` `f` join `amp_organisation` `o`) join `amp_role` `r`) join `amp_org_group` `b` on(((`f`.`organisation` = `o`.`amp_org_id`) and (`f`.`role` = `r`.`amp_role_id`) and (`r`.`role_code` = _latin1'IA') and (`o`.`org_grp_id` = `b`.`amp_org_grp_id`)))) order by `f`.`activity`,`o`.`name`;;
CREATE OR REPLACE VIEW v_issues AS /* ALGORITHM=UNDEFINED */ select `ai`.`amp_activity_id` AS `amp_activity_id`,`ai`.`name` AS `name`,`ai`.`amp_issue_id` AS `amp_issue_id` from (`amp_issues` `ai` join `amp_activity` `a`) where (`ai`.`amp_activity_id` = `a`.`amp_activity_id`) order by `ai`.`amp_activity_id`;;
CREATE OR REPLACE VIEW v_measures_taken AS /* ALGORITHM=UNDEFINED */ select `ai`.`amp_activity_id` AS `amp_activity_id`,`m`.`name` AS `name`,`m`.`amp_measure_id` AS `amp_measure_id` from ((`amp_activity` `a` join `amp_measure` `m`) join `amp_issues` `ai`) where ((`ai`.`amp_activity_id` = `a`.`amp_activity_id`) and (`ai`.`amp_issue_id` = `m`.`amp_issue_id`)) order by `ai`.`amp_activity_id`;;
CREATE OR REPLACE VIEW v_nationalobjectives_all_level AS /* ALGORITHM=UNDEFINED */ select `a`.`amp_activity_id` AS `amp_activity_id`,`a`.`program_percentage` AS `program_percentage`,`b`.`amp_theme_id` AS `amp_program_id1`,`b`.`name` AS `n1`,`b`.`level_` AS `l1`,`b1`.`amp_theme_id` AS `amp_program_id2`,`b1`.`name` AS `n2`,`b1`.`level_` AS `l2`,`b2`.`amp_theme_id` AS `amp_program_id3`,`b2`.`name` AS `n3`,`b2`.`level_` AS `l3`,`b3`.`amp_theme_id` AS `amp_program_id4`,`b3`.`name` AS `n4`,`b3`.`level_` AS `l4`,`b4`.`amp_theme_id` AS `amp_program_id5`,`b4`.`name` AS `n5`,`b4`.`level_` AS `l5`,`b5`.`amp_theme_id` AS `amp_program_id6`,`b5`.`name` AS `n6`,`b5`.`level_` AS `l6`,`b6`.`amp_theme_id` AS `amp_program_id7`,`b6`.`name` AS `n7`,`b6`.`level_` AS `l7`,`b7`.`amp_theme_id` AS `amp_program_id8`,`b7`.`name` AS `n8`,`b7`.`level_` AS `l8` from ((((((((`amp_activity_program` `a` join `amp_theme` `b` on((`a`.`amp_program_id` = `b`.`amp_theme_id`))) left join `amp_theme` `b1` on((`b1`.`amp_theme_id` = `b`.`parent_theme_id`))) left join `amp_theme` `b2` on((`b2`.`amp_theme_id` = `b1`.`parent_theme_id`))) left join `amp_theme` `b3` on((`b3`.`amp_theme_id` = `b2`.`parent_theme_id`))) left join `amp_theme` `b4` on((`b4`.`amp_theme_id` = `b3`.`parent_theme_id`))) left join `amp_theme` `b5` on((`b5`.`amp_theme_id` = `b4`.`parent_theme_id`))) left join `amp_theme` `b6` on((`b6`.`amp_theme_id` = `b5`.`parent_theme_id`))) left join `amp_theme` `b7` on((`b7`.`amp_theme_id` = `b6`.`parent_theme_id`))) where (`a`.`program_setting` = 1);;
CREATE OR REPLACE VIEW v_nationalobjectives_level_0 AS /* ALGORITHM=UNDEFINED */ select `v_nationalobjectives_all_level`.`amp_activity_id` AS `amp_activity_id`,(case 0 when `v_nationalobjectives_all_level`.`l1` then `v_nationalobjectives_all_level`.`n1` when `v_nationalobjectives_all_level`.`l2` then `v_nationalobjectives_all_level`.`n2` when `v_nationalobjectives_all_level`.`l3` then `v_nationalobjectives_all_level`.`n3` when `v_nationalobjectives_all_level`.`l4` then `v_nationalobjectives_all_level`.`n4` when `v_nationalobjectives_all_level`.`l5` then `v_nationalobjectives_all_level`.`n5` when `v_nationalobjectives_all_level`.`l6` then `v_nationalobjectives_all_level`.`n6` when `v_nationalobjectives_all_level`.`l7` then `v_nationalobjectives_all_level`.`n7` when `v_nationalobjectives_all_level`.`l8` then `v_nationalobjectives_all_level`.`n8` end) AS `name`,(case 0 when `v_nationalobjectives_all_level`.`l1` then `v_nationalobjectives_all_level`.`amp_program_id1` when `v_nationalobjectives_all_level`.`l2` then `v_nationalobjectives_all_level`.`amp_program_id2` when `v_nationalobjectives_all_level`.`l3` then `v_nationalobjectives_all_level`.`amp_program_id3` when `v_nationalobjectives_all_level`.`l4` then `v_nationalobjectives_all_level`.`amp_program_id4` when `v_nationalobjectives_all_level`.`l5` then `v_nationalobjectives_all_level`.`amp_program_id5` when `v_nationalobjectives_all_level`.`l6` then `v_nationalobjectives_all_level`.`amp_program_id6` when `v_nationalobjectives_all_level`.`l7` then `v_nationalobjectives_all_level`.`amp_program_id7` when `v_nationalobjectives_all_level`.`l8` then `v_nationalobjectives_all_level`.`amp_program_id8` end) AS `amp_program_id`,sum(`v_nationalobjectives_all_level`.`program_percentage`) AS `program_percentage` from `v_nationalobjectives_all_level` group by `v_nationalobjectives_all_level`.`amp_activity_id`,(case 0 when `v_nationalobjectives_all_level`.`l1` then `v_nationalobjectives_all_level`.`amp_program_id1` when `v_nationalobjectives_all_level`.`l2` then `v_nationalobjectives_all_level`.`amp_program_id2` when `v_nationalobjectives_all_level`.`l3` then `v_nationalobjectives_all_level`.`amp_program_id3` when `v_nationalobjectives_all_level`.`l4` then `v_nationalobjectives_all_level`.`amp_program_id4` when `v_nationalobjectives_all_level`.`l5` then `v_nationalobjectives_all_level`.`amp_program_id5` when `v_nationalobjectives_all_level`.`l6` then `v_nationalobjectives_all_level`.`amp_program_id6` when `v_nationalobjectives_all_level`.`l7` then `v_nationalobjectives_all_level`.`amp_program_id7` when `v_nationalobjectives_all_level`.`l8` then `v_nationalobjectives_all_level`.`amp_program_id8` end) having (`name` is not null);;
CREATE OR REPLACE VIEW v_nationalobjectives_level_1 AS /* ALGORITHM=UNDEFINED */ select `v_nationalobjectives_all_level`.`amp_activity_id` AS `amp_activity_id`,(case 1 when `v_nationalobjectives_all_level`.`l1` then `v_nationalobjectives_all_level`.`n1` when `v_nationalobjectives_all_level`.`l2` then `v_nationalobjectives_all_level`.`n2` when `v_nationalobjectives_all_level`.`l3` then `v_nationalobjectives_all_level`.`n3` when `v_nationalobjectives_all_level`.`l4` then `v_nationalobjectives_all_level`.`n4` when `v_nationalobjectives_all_level`.`l5` then `v_nationalobjectives_all_level`.`n5` when `v_nationalobjectives_all_level`.`l6` then `v_nationalobjectives_all_level`.`n6` when `v_nationalobjectives_all_level`.`l7` then `v_nationalobjectives_all_level`.`n7` when `v_nationalobjectives_all_level`.`l8` then `v_nationalobjectives_all_level`.`n8` end) AS `name`,(case 1 when `v_nationalobjectives_all_level`.`l1` then `v_nationalobjectives_all_level`.`amp_program_id1` when `v_nationalobjectives_all_level`.`l2` then `v_nationalobjectives_all_level`.`amp_program_id2` when `v_nationalobjectives_all_level`.`l3` then `v_nationalobjectives_all_level`.`amp_program_id3` when `v_nationalobjectives_all_level`.`l4` then `v_nationalobjectives_all_level`.`amp_program_id4` when `v_nationalobjectives_all_level`.`l5` then `v_nationalobjectives_all_level`.`amp_program_id5` when `v_nationalobjectives_all_level`.`l6` then `v_nationalobjectives_all_level`.`amp_program_id6` when `v_nationalobjectives_all_level`.`l7` then `v_nationalobjectives_all_level`.`amp_program_id7` when `v_nationalobjectives_all_level`.`l8` then `v_nationalobjectives_all_level`.`amp_program_id8` end) AS `amp_program_id`,sum(`v_nationalobjectives_all_level`.`program_percentage`) AS `program_percentage` from `v_nationalobjectives_all_level` group by `v_nationalobjectives_all_level`.`amp_activity_id`,(case 1 when `v_nationalobjectives_all_level`.`l1` then `v_nationalobjectives_all_level`.`amp_program_id1` when `v_nationalobjectives_all_level`.`l2` then `v_nationalobjectives_all_level`.`amp_program_id2` when `v_nationalobjectives_all_level`.`l3` then `v_nationalobjectives_all_level`.`amp_program_id3` when `v_nationalobjectives_all_level`.`l4` then `v_nationalobjectives_all_level`.`amp_program_id4` when `v_nationalobjectives_all_level`.`l5` then `v_nationalobjectives_all_level`.`amp_program_id5` when `v_nationalobjectives_all_level`.`l6` then `v_nationalobjectives_all_level`.`amp_program_id6` when `v_nationalobjectives_all_level`.`l7` then `v_nationalobjectives_all_level`.`amp_program_id7` when `v_nationalobjectives_all_level`.`l8` then `v_nationalobjectives_all_level`.`amp_program_id8` end) having (`name` is not null);;
CREATE OR REPLACE VIEW v_nationalobjectives_level_2 AS /* ALGORITHM=UNDEFINED */ select `v_nationalobjectives_all_level`.`amp_activity_id` AS `amp_activity_id`,(case 2 when `v_nationalobjectives_all_level`.`l1` then `v_nationalobjectives_all_level`.`n1` when `v_nationalobjectives_all_level`.`l2` then `v_nationalobjectives_all_level`.`n2` when `v_nationalobjectives_all_level`.`l3` then `v_nationalobjectives_all_level`.`n3` when `v_nationalobjectives_all_level`.`l4` then `v_nationalobjectives_all_level`.`n4` when `v_nationalobjectives_all_level`.`l5` then `v_nationalobjectives_all_level`.`n5` when `v_nationalobjectives_all_level`.`l6` then `v_nationalobjectives_all_level`.`n6` when `v_nationalobjectives_all_level`.`l7` then `v_nationalobjectives_all_level`.`n7` when `v_nationalobjectives_all_level`.`l8` then `v_nationalobjectives_all_level`.`n8` end) AS `name`,(case 2 when `v_nationalobjectives_all_level`.`l1` then `v_nationalobjectives_all_level`.`amp_program_id1` when `v_nationalobjectives_all_level`.`l2` then `v_nationalobjectives_all_level`.`amp_program_id2` when `v_nationalobjectives_all_level`.`l3` then `v_nationalobjectives_all_level`.`amp_program_id3` when `v_nationalobjectives_all_level`.`l4` then `v_nationalobjectives_all_level`.`amp_program_id4` when `v_nationalobjectives_all_level`.`l5` then `v_nationalobjectives_all_level`.`amp_program_id5` when `v_nationalobjectives_all_level`.`l6` then `v_nationalobjectives_all_level`.`amp_program_id6` when `v_nationalobjectives_all_level`.`l7` then `v_nationalobjectives_all_level`.`amp_program_id7` when `v_nationalobjectives_all_level`.`l8` then `v_nationalobjectives_all_level`.`amp_program_id8` end) AS `amp_program_id`,sum(`v_nationalobjectives_all_level`.`program_percentage`) AS `program_percentage` from `v_nationalobjectives_all_level` group by `v_nationalobjectives_all_level`.`amp_activity_id`,(case 2 when `v_nationalobjectives_all_level`.`l1` then `v_nationalobjectives_all_level`.`amp_program_id1` when `v_nationalobjectives_all_level`.`l2` then `v_nationalobjectives_all_level`.`amp_program_id2` when `v_nationalobjectives_all_level`.`l3` then `v_nationalobjectives_all_level`.`amp_program_id3` when `v_nationalobjectives_all_level`.`l4` then `v_nationalobjectives_all_level`.`amp_program_id4` when `v_nationalobjectives_all_level`.`l5` then `v_nationalobjectives_all_level`.`amp_program_id5` when `v_nationalobjectives_all_level`.`l6` then `v_nationalobjectives_all_level`.`amp_program_id6` when `v_nationalobjectives_all_level`.`l7` then `v_nationalobjectives_all_level`.`amp_program_id7` when `v_nationalobjectives_all_level`.`l8` then `v_nationalobjectives_all_level`.`amp_program_id8` end) having (`name` is not null);;
CREATE OR REPLACE VIEW v_nationalobjectives_level_3 AS /* ALGORITHM=UNDEFINED */ select `v_nationalobjectives_all_level`.`amp_activity_id` AS `amp_activity_id`,(case 3 when `v_nationalobjectives_all_level`.`l1` then `v_nationalobjectives_all_level`.`n1` when `v_nationalobjectives_all_level`.`l2` then `v_nationalobjectives_all_level`.`n2` when `v_nationalobjectives_all_level`.`l3` then `v_nationalobjectives_all_level`.`n3` when `v_nationalobjectives_all_level`.`l4` then `v_nationalobjectives_all_level`.`n4` when `v_nationalobjectives_all_level`.`l5` then `v_nationalobjectives_all_level`.`n5` when `v_nationalobjectives_all_level`.`l6` then `v_nationalobjectives_all_level`.`n6` when `v_nationalobjectives_all_level`.`l7` then `v_nationalobjectives_all_level`.`n7` when `v_nationalobjectives_all_level`.`l8` then `v_nationalobjectives_all_level`.`n8` end) AS `name`,(case 3 when `v_nationalobjectives_all_level`.`l1` then `v_nationalobjectives_all_level`.`amp_program_id1` when `v_nationalobjectives_all_level`.`l2` then `v_nationalobjectives_all_level`.`amp_program_id2` when `v_nationalobjectives_all_level`.`l3` then `v_nationalobjectives_all_level`.`amp_program_id3` when `v_nationalobjectives_all_level`.`l4` then `v_nationalobjectives_all_level`.`amp_program_id4` when `v_nationalobjectives_all_level`.`l5` then `v_nationalobjectives_all_level`.`amp_program_id5` when `v_nationalobjectives_all_level`.`l6` then `v_nationalobjectives_all_level`.`amp_program_id6` when `v_nationalobjectives_all_level`.`l7` then `v_nationalobjectives_all_level`.`amp_program_id7` when `v_nationalobjectives_all_level`.`l8` then `v_nationalobjectives_all_level`.`amp_program_id8` end) AS `amp_program_id`,sum(`v_nationalobjectives_all_level`.`program_percentage`) AS `program_percentage` from `v_nationalobjectives_all_level` group by `v_nationalobjectives_all_level`.`amp_activity_id`,(case 3 when `v_nationalobjectives_all_level`.`l1` then `v_nationalobjectives_all_level`.`amp_program_id1` when `v_nationalobjectives_all_level`.`l2` then `v_nationalobjectives_all_level`.`amp_program_id2` when `v_nationalobjectives_all_level`.`l3` then `v_nationalobjectives_all_level`.`amp_program_id3` when `v_nationalobjectives_all_level`.`l4` then `v_nationalobjectives_all_level`.`amp_program_id4` when `v_nationalobjectives_all_level`.`l5` then `v_nationalobjectives_all_level`.`amp_program_id5` when `v_nationalobjectives_all_level`.`l6` then `v_nationalobjectives_all_level`.`amp_program_id6` when `v_nationalobjectives_all_level`.`l7` then `v_nationalobjectives_all_level`.`amp_program_id7` when `v_nationalobjectives_all_level`.`l8` then `v_nationalobjectives_all_level`.`amp_program_id8` end) having (`name` is not null);;
CREATE OR REPLACE VIEW v_nationalobjectives_level_4 AS /* ALGORITHM=UNDEFINED */ select `v_nationalobjectives_all_level`.`amp_activity_id` AS `amp_activity_id`,(case 4 when `v_nationalobjectives_all_level`.`l1` then `v_nationalobjectives_all_level`.`n1` when `v_nationalobjectives_all_level`.`l2` then `v_nationalobjectives_all_level`.`n2` when `v_nationalobjectives_all_level`.`l3` then `v_nationalobjectives_all_level`.`n3` when `v_nationalobjectives_all_level`.`l4` then `v_nationalobjectives_all_level`.`n4` when `v_nationalobjectives_all_level`.`l5` then `v_nationalobjectives_all_level`.`n5` when `v_nationalobjectives_all_level`.`l6` then `v_nationalobjectives_all_level`.`n6` when `v_nationalobjectives_all_level`.`l7` then `v_nationalobjectives_all_level`.`n7` when `v_nationalobjectives_all_level`.`l8` then `v_nationalobjectives_all_level`.`n8` end) AS `name`,(case 4 when `v_nationalobjectives_all_level`.`l1` then `v_nationalobjectives_all_level`.`amp_program_id1` when `v_nationalobjectives_all_level`.`l2` then `v_nationalobjectives_all_level`.`amp_program_id2` when `v_nationalobjectives_all_level`.`l3` then `v_nationalobjectives_all_level`.`amp_program_id3` when `v_nationalobjectives_all_level`.`l4` then `v_nationalobjectives_all_level`.`amp_program_id4` when `v_nationalobjectives_all_level`.`l5` then `v_nationalobjectives_all_level`.`amp_program_id5` when `v_nationalobjectives_all_level`.`l6` then `v_nationalobjectives_all_level`.`amp_program_id6` when `v_nationalobjectives_all_level`.`l7` then `v_nationalobjectives_all_level`.`amp_program_id7` when `v_nationalobjectives_all_level`.`l8` then `v_nationalobjectives_all_level`.`amp_program_id8` end) AS `amp_program_id`,sum(`v_nationalobjectives_all_level`.`program_percentage`) AS `program_percentage` from `v_nationalobjectives_all_level` group by `v_nationalobjectives_all_level`.`amp_activity_id`,(case 4 when `v_nationalobjectives_all_level`.`l1` then `v_nationalobjectives_all_level`.`amp_program_id1` when `v_nationalobjectives_all_level`.`l2` then `v_nationalobjectives_all_level`.`amp_program_id2` when `v_nationalobjectives_all_level`.`l3` then `v_nationalobjectives_all_level`.`amp_program_id3` when `v_nationalobjectives_all_level`.`l4` then `v_nationalobjectives_all_level`.`amp_program_id4` when `v_nationalobjectives_all_level`.`l5` then `v_nationalobjectives_all_level`.`amp_program_id5` when `v_nationalobjectives_all_level`.`l6` then `v_nationalobjectives_all_level`.`amp_program_id6` when `v_nationalobjectives_all_level`.`l7` then `v_nationalobjectives_all_level`.`amp_program_id7` when `v_nationalobjectives_all_level`.`l8` then `v_nationalobjectives_all_level`.`amp_program_id8` end) having (`name` is not null);;
CREATE OR REPLACE VIEW v_nationalobjectives_level_5 AS /* ALGORITHM=UNDEFINED */ select `v_nationalobjectives_all_level`.`amp_activity_id` AS `amp_activity_id`,(case 5 when `v_nationalobjectives_all_level`.`l1` then `v_nationalobjectives_all_level`.`n1` when `v_nationalobjectives_all_level`.`l2` then `v_nationalobjectives_all_level`.`n2` when `v_nationalobjectives_all_level`.`l3` then `v_nationalobjectives_all_level`.`n3` when `v_nationalobjectives_all_level`.`l4` then `v_nationalobjectives_all_level`.`n4` when `v_nationalobjectives_all_level`.`l5` then `v_nationalobjectives_all_level`.`n5` when `v_nationalobjectives_all_level`.`l6` then `v_nationalobjectives_all_level`.`n6` when `v_nationalobjectives_all_level`.`l7` then `v_nationalobjectives_all_level`.`n7` when `v_nationalobjectives_all_level`.`l8` then `v_nationalobjectives_all_level`.`n8` end) AS `name`,(case 5 when `v_nationalobjectives_all_level`.`l1` then `v_nationalobjectives_all_level`.`amp_program_id1` when `v_nationalobjectives_all_level`.`l2` then `v_nationalobjectives_all_level`.`amp_program_id2` when `v_nationalobjectives_all_level`.`l3` then `v_nationalobjectives_all_level`.`amp_program_id3` when `v_nationalobjectives_all_level`.`l4` then `v_nationalobjectives_all_level`.`amp_program_id4` when `v_nationalobjectives_all_level`.`l5` then `v_nationalobjectives_all_level`.`amp_program_id5` when `v_nationalobjectives_all_level`.`l6` then `v_nationalobjectives_all_level`.`amp_program_id6` when `v_nationalobjectives_all_level`.`l7` then `v_nationalobjectives_all_level`.`amp_program_id7` when `v_nationalobjectives_all_level`.`l8` then `v_nationalobjectives_all_level`.`amp_program_id8` end) AS `amp_program_id`,sum(`v_nationalobjectives_all_level`.`program_percentage`) AS `program_percentage` from `v_nationalobjectives_all_level` group by `v_nationalobjectives_all_level`.`amp_activity_id`,(case 5 when `v_nationalobjectives_all_level`.`l1` then `v_nationalobjectives_all_level`.`amp_program_id1` when `v_nationalobjectives_all_level`.`l2` then `v_nationalobjectives_all_level`.`amp_program_id2` when `v_nationalobjectives_all_level`.`l3` then `v_nationalobjectives_all_level`.`amp_program_id3` when `v_nationalobjectives_all_level`.`l4` then `v_nationalobjectives_all_level`.`amp_program_id4` when `v_nationalobjectives_all_level`.`l5` then `v_nationalobjectives_all_level`.`amp_program_id5` when `v_nationalobjectives_all_level`.`l6` then `v_nationalobjectives_all_level`.`amp_program_id6` when `v_nationalobjectives_all_level`.`l7` then `v_nationalobjectives_all_level`.`amp_program_id7` when `v_nationalobjectives_all_level`.`l8` then `v_nationalobjectives_all_level`.`amp_program_id8` end) having (`name` is not null);;
CREATE OR REPLACE VIEW v_nationalobjectives_level_6 AS /* ALGORITHM=UNDEFINED */ select `v_nationalobjectives_all_level`.`amp_activity_id` AS `amp_activity_id`,(case 6 when `v_nationalobjectives_all_level`.`l1` then `v_nationalobjectives_all_level`.`n1` when `v_nationalobjectives_all_level`.`l2` then `v_nationalobjectives_all_level`.`n2` when `v_nationalobjectives_all_level`.`l3` then `v_nationalobjectives_all_level`.`n3` when `v_nationalobjectives_all_level`.`l4` then `v_nationalobjectives_all_level`.`n4` when `v_nationalobjectives_all_level`.`l5` then `v_nationalobjectives_all_level`.`n5` when `v_nationalobjectives_all_level`.`l6` then `v_nationalobjectives_all_level`.`n6` when `v_nationalobjectives_all_level`.`l7` then `v_nationalobjectives_all_level`.`n7` when `v_nationalobjectives_all_level`.`l8` then `v_nationalobjectives_all_level`.`n8` end) AS `name`,(case 6 when `v_nationalobjectives_all_level`.`l1` then `v_nationalobjectives_all_level`.`amp_program_id1` when `v_nationalobjectives_all_level`.`l2` then `v_nationalobjectives_all_level`.`amp_program_id2` when `v_nationalobjectives_all_level`.`l3` then `v_nationalobjectives_all_level`.`amp_program_id3` when `v_nationalobjectives_all_level`.`l4` then `v_nationalobjectives_all_level`.`amp_program_id4` when `v_nationalobjectives_all_level`.`l5` then `v_nationalobjectives_all_level`.`amp_program_id5` when `v_nationalobjectives_all_level`.`l6` then `v_nationalobjectives_all_level`.`amp_program_id6` when `v_nationalobjectives_all_level`.`l7` then `v_nationalobjectives_all_level`.`amp_program_id7` when `v_nationalobjectives_all_level`.`l8` then `v_nationalobjectives_all_level`.`amp_program_id8` end) AS `amp_program_id`,sum(`v_nationalobjectives_all_level`.`program_percentage`) AS `program_percentage` from `v_nationalobjectives_all_level` group by `v_nationalobjectives_all_level`.`amp_activity_id`,(case 6 when `v_nationalobjectives_all_level`.`l1` then `v_nationalobjectives_all_level`.`amp_program_id1` when `v_nationalobjectives_all_level`.`l2` then `v_nationalobjectives_all_level`.`amp_program_id2` when `v_nationalobjectives_all_level`.`l3` then `v_nationalobjectives_all_level`.`amp_program_id3` when `v_nationalobjectives_all_level`.`l4` then `v_nationalobjectives_all_level`.`amp_program_id4` when `v_nationalobjectives_all_level`.`l5` then `v_nationalobjectives_all_level`.`amp_program_id5` when `v_nationalobjectives_all_level`.`l6` then `v_nationalobjectives_all_level`.`amp_program_id6` when `v_nationalobjectives_all_level`.`l7` then `v_nationalobjectives_all_level`.`amp_program_id7` when `v_nationalobjectives_all_level`.`l8` then `v_nationalobjectives_all_level`.`amp_program_id8` end) having (`name` is not null);;
CREATE OR REPLACE VIEW v_nationalobjectives_level_7 AS /* ALGORITHM=UNDEFINED */ select `v_nationalobjectives_all_level`.`amp_activity_id` AS `amp_activity_id`,(case 7 when `v_nationalobjectives_all_level`.`l1` then `v_nationalobjectives_all_level`.`n1` when `v_nationalobjectives_all_level`.`l2` then `v_nationalobjectives_all_level`.`n2` when `v_nationalobjectives_all_level`.`l3` then `v_nationalobjectives_all_level`.`n3` when `v_nationalobjectives_all_level`.`l4` then `v_nationalobjectives_all_level`.`n4` when `v_nationalobjectives_all_level`.`l5` then `v_nationalobjectives_all_level`.`n5` when `v_nationalobjectives_all_level`.`l6` then `v_nationalobjectives_all_level`.`n6` when `v_nationalobjectives_all_level`.`l7` then `v_nationalobjectives_all_level`.`n7` when `v_nationalobjectives_all_level`.`l8` then `v_nationalobjectives_all_level`.`n8` end) AS `name`,(case 7 when `v_nationalobjectives_all_level`.`l1` then `v_nationalobjectives_all_level`.`amp_program_id1` when `v_nationalobjectives_all_level`.`l2` then `v_nationalobjectives_all_level`.`amp_program_id2` when `v_nationalobjectives_all_level`.`l3` then `v_nationalobjectives_all_level`.`amp_program_id3` when `v_nationalobjectives_all_level`.`l4` then `v_nationalobjectives_all_level`.`amp_program_id4` when `v_nationalobjectives_all_level`.`l5` then `v_nationalobjectives_all_level`.`amp_program_id5` when `v_nationalobjectives_all_level`.`l6` then `v_nationalobjectives_all_level`.`amp_program_id6` when `v_nationalobjectives_all_level`.`l7` then `v_nationalobjectives_all_level`.`amp_program_id7` when `v_nationalobjectives_all_level`.`l8` then `v_nationalobjectives_all_level`.`amp_program_id8` end) AS `amp_program_id`,sum(`v_nationalobjectives_all_level`.`program_percentage`) AS `program_percentage` from `v_nationalobjectives_all_level` group by `v_nationalobjectives_all_level`.`amp_activity_id`,(case 7 when `v_nationalobjectives_all_level`.`l1` then `v_nationalobjectives_all_level`.`amp_program_id1` when `v_nationalobjectives_all_level`.`l2` then `v_nationalobjectives_all_level`.`amp_program_id2` when `v_nationalobjectives_all_level`.`l3` then `v_nationalobjectives_all_level`.`amp_program_id3` when `v_nationalobjectives_all_level`.`l4` then `v_nationalobjectives_all_level`.`amp_program_id4` when `v_nationalobjectives_all_level`.`l5` then `v_nationalobjectives_all_level`.`amp_program_id5` when `v_nationalobjectives_all_level`.`l6` then `v_nationalobjectives_all_level`.`amp_program_id6` when `v_nationalobjectives_all_level`.`l7` then `v_nationalobjectives_all_level`.`amp_program_id7` when `v_nationalobjectives_all_level`.`l8` then `v_nationalobjectives_all_level`.`amp_program_id8` end) having (`name` is not null);;
CREATE OR REPLACE VIEW v_nationalobjectives_level_8 AS /* ALGORITHM=UNDEFINED */ select `v_nationalobjectives_all_level`.`amp_activity_id` AS `amp_activity_id`,(case 8 when `v_nationalobjectives_all_level`.`l1` then `v_nationalobjectives_all_level`.`n1` when `v_nationalobjectives_all_level`.`l2` then `v_nationalobjectives_all_level`.`n2` when `v_nationalobjectives_all_level`.`l3` then `v_nationalobjectives_all_level`.`n3` when `v_nationalobjectives_all_level`.`l4` then `v_nationalobjectives_all_level`.`n4` when `v_nationalobjectives_all_level`.`l5` then `v_nationalobjectives_all_level`.`n5` when `v_nationalobjectives_all_level`.`l6` then `v_nationalobjectives_all_level`.`n6` when `v_nationalobjectives_all_level`.`l7` then `v_nationalobjectives_all_level`.`n7` when `v_nationalobjectives_all_level`.`l8` then `v_nationalobjectives_all_level`.`n8` end) AS `name`,(case 8 when `v_nationalobjectives_all_level`.`l1` then `v_nationalobjectives_all_level`.`amp_program_id1` when `v_nationalobjectives_all_level`.`l2` then `v_nationalobjectives_all_level`.`amp_program_id2` when `v_nationalobjectives_all_level`.`l3` then `v_nationalobjectives_all_level`.`amp_program_id3` when `v_nationalobjectives_all_level`.`l4` then `v_nationalobjectives_all_level`.`amp_program_id4` when `v_nationalobjectives_all_level`.`l5` then `v_nationalobjectives_all_level`.`amp_program_id5` when `v_nationalobjectives_all_level`.`l6` then `v_nationalobjectives_all_level`.`amp_program_id6` when `v_nationalobjectives_all_level`.`l7` then `v_nationalobjectives_all_level`.`amp_program_id7` when `v_nationalobjectives_all_level`.`l8` then `v_nationalobjectives_all_level`.`amp_program_id8` end) AS `amp_program_id`,sum(`v_nationalobjectives_all_level`.`program_percentage`) AS `program_percentage` from `v_nationalobjectives_all_level` group by `v_nationalobjectives_all_level`.`amp_activity_id`,(case 8 when `v_nationalobjectives_all_level`.`l1` then `v_nationalobjectives_all_level`.`amp_program_id1` when `v_nationalobjectives_all_level`.`l2` then `v_nationalobjectives_all_level`.`amp_program_id2` when `v_nationalobjectives_all_level`.`l3` then `v_nationalobjectives_all_level`.`amp_program_id3` when `v_nationalobjectives_all_level`.`l4` then `v_nationalobjectives_all_level`.`amp_program_id4` when `v_nationalobjectives_all_level`.`l5` then `v_nationalobjectives_all_level`.`amp_program_id5` when `v_nationalobjectives_all_level`.`l6` then `v_nationalobjectives_all_level`.`amp_program_id6` when `v_nationalobjectives_all_level`.`l7` then `v_nationalobjectives_all_level`.`amp_program_id7` when `v_nationalobjectives_all_level`.`l8` then `v_nationalobjectives_all_level`.`amp_program_id8` end) having (`name` is not null);;
CREATE OR REPLACE VIEW v_objectives AS /* ALGORITHM=UNDEFINED */ select `amp_activity`.`amp_activity_id` AS `amp_activity_id`,trim(`dg_editor`.`BODY`) AS `ebody` from (`amp_activity` join `dg_editor`) where (`amp_activity`.`objectives` = `dg_editor`.`EDITOR_KEY`) order by `amp_activity`.`amp_activity_id`;;
CREATE OR REPLACE VIEW v_on_off_budget AS /* ALGORITHM=UNDEFINED */ select `a`.`amp_activity_id` AS `amp_activity_id`,if((`a`.`budget` = 1),_utf8'yes',_utf8'no') AS `budget` from `amp_activity` `a` order by `a`.`amp_activity_id`;;
CREATE OR REPLACE VIEW v_organization_projectid AS /* ALGORITHM=UNDEFINED */ select `aaii`.`amp_activity_id` AS `amp_activity_id`,concat(`org`.`name`,_latin1' - ',`aaii`.`internal_id`) AS `orgname_id`,`aaii`.`amp_org_id` AS `amp_org_id` from `amp_activity_internal_id` `aaii` join `amp_organisation` `org` where (`aaii`.`amp_org_id` = `org`.`amp_org_id`);;
CREATE OR REPLACE VIEW v_physical_description AS /* ALGORITHM=UNDEFINED */ select `a`.`amp_activity_id` AS `amp_activity_id`,`a`.`description` AS `description` from `amp_physical_performance` `a` order by `a`.`amp_activity_id`;;
CREATE OR REPLACE VIEW v_physical_progress AS /* ALGORITHM=UNDEFINED */ select `p`.`amp_activity_id` AS `amp_activity_id`,`p`.`description` AS `description`,`p`.`amp_pp_id` AS `amp_pp_id` from `amp_physical_performance` `p` order by `p`.`reporting_date`;;
CREATE OR REPLACE VIEW v_physical_title AS /* ALGORITHM=UNDEFINED */ select `a`.`amp_activity_id` AS `amp_activity_id`,`a`.`description` AS `description` from `amp_physical_performance` `a` order by `a`.`amp_activity_id`;;
CREATE OR REPLACE VIEW v_primaryprogram AS /* ALGORITHM=UNDEFINED */ select `a`.`amp_activity_id` AS `amp_activity_id`,`t`.`name` AS `name`,`ap`.`amp_program_id` AS `amp_program_id`,`ap`.`program_percentage` AS `program_percentage` from ((`amp_activity` `a` join `amp_activity_program` `ap` on(((`a`.`amp_activity_id` = `ap`.`amp_activity_id`) and (`ap`.`program_setting` = 2)))) join `amp_theme` `t` on((`t`.`amp_theme_id` = `ap`.`amp_program_id`))) order by `a`.`amp_activity_id`,`t`.`name`;;
CREATE OR REPLACE VIEW v_primaryprogram_all_level AS /* ALGORITHM=UNDEFINED */ select `a`.`amp_activity_id` AS `amp_activity_id`,`a`.`program_percentage` AS `program_percentage`,`b`.`amp_theme_id` AS `amp_program_id1`,`b`.`name` AS `n1`,`b`.`level_` AS `l1`,`b1`.`amp_theme_id` AS `amp_program_id2`,`b1`.`name` AS `n2`,`b1`.`level_` AS `l2`,`b2`.`amp_theme_id` AS `amp_program_id3`,`b2`.`name` AS `n3`,`b2`.`level_` AS `l3`,`b3`.`amp_theme_id` AS `amp_program_id4`,`b3`.`name` AS `n4`,`b3`.`level_` AS `l4`,`b4`.`amp_theme_id` AS `amp_program_id5`,`b4`.`name` AS `n5`,`b4`.`level_` AS `l5`,`b5`.`amp_theme_id` AS `amp_program_id6`,`b5`.`name` AS `n6`,`b5`.`level_` AS `l6`,`b6`.`amp_theme_id` AS `amp_program_id7`,`b6`.`name` AS `n7`,`b6`.`level_` AS `l7`,`b7`.`amp_theme_id` AS `amp_program_id8`,`b7`.`name` AS `n8`,`b7`.`level_` AS `l8` from ((((((((`amp_activity_program` `a` join `amp_theme` `b` on((`a`.`amp_program_id` = `b`.`amp_theme_id`))) left join `amp_theme` `b1` on((`b1`.`amp_theme_id` = `b`.`parent_theme_id`))) left join `amp_theme` `b2` on((`b2`.`amp_theme_id` = `b1`.`parent_theme_id`))) left join `amp_theme` `b3` on((`b3`.`amp_theme_id` = `b2`.`parent_theme_id`))) left join `amp_theme` `b4` on((`b4`.`amp_theme_id` = `b3`.`parent_theme_id`))) left join `amp_theme` `b5` on((`b5`.`amp_theme_id` = `b4`.`parent_theme_id`))) left join `amp_theme` `b6` on((`b6`.`amp_theme_id` = `b5`.`parent_theme_id`))) left join `amp_theme` `b7` on((`b7`.`amp_theme_id` = `b6`.`parent_theme_id`))) where (`a`.`program_setting` = 2);;
CREATE OR REPLACE VIEW v_primaryprogram_cached AS /* ALGORITHM=UNDEFINED */ select `a`.`amp_activity_id` AS `amp_activity_id`,if((`ap`.`program_setting` = 3),`t`.`name`,NULL) AS `name`,`ap`.`amp_program_id` AS `amp_program_id`,`ap`.`program_percentage` AS `program_percentage`,`ap`.`program_setting` AS `program_setting` from ((`amp_activity` `a` left join `amp_activity_program` `ap` on((`a`.`amp_activity_id` = `ap`.`amp_activity_id`))) left join `amp_theme` `t` on((`t`.`amp_theme_id` = `ap`.`amp_program_id`))) order by `a`.`amp_activity_id`,`t`.`name`;;
CREATE OR REPLACE VIEW v_primaryprogram_level_0 AS /* ALGORITHM=UNDEFINED */ select `v_primaryprogram_all_level`.`amp_activity_id` AS `amp_activity_id`,(case 0 when `v_primaryprogram_all_level`.`l1` then `v_primaryprogram_all_level`.`n1` when `v_primaryprogram_all_level`.`l2` then `v_primaryprogram_all_level`.`n2` when `v_primaryprogram_all_level`.`l3` then `v_primaryprogram_all_level`.`n3` when `v_primaryprogram_all_level`.`l4` then `v_primaryprogram_all_level`.`n4` when `v_primaryprogram_all_level`.`l5` then `v_primaryprogram_all_level`.`n5` when `v_primaryprogram_all_level`.`l6` then `v_primaryprogram_all_level`.`n6` when `v_primaryprogram_all_level`.`l7` then `v_primaryprogram_all_level`.`n7` when `v_primaryprogram_all_level`.`l8` then `v_primaryprogram_all_level`.`n8` end) AS `name`,(case 0 when `v_primaryprogram_all_level`.`l1` then `v_primaryprogram_all_level`.`amp_program_id1` when `v_primaryprogram_all_level`.`l2` then `v_primaryprogram_all_level`.`amp_program_id2` when `v_primaryprogram_all_level`.`l3` then `v_primaryprogram_all_level`.`amp_program_id3` when `v_primaryprogram_all_level`.`l4` then `v_primaryprogram_all_level`.`amp_program_id4` when `v_primaryprogram_all_level`.`l5` then `v_primaryprogram_all_level`.`amp_program_id5` when `v_primaryprogram_all_level`.`l6` then `v_primaryprogram_all_level`.`amp_program_id6` when `v_primaryprogram_all_level`.`l7` then `v_primaryprogram_all_level`.`amp_program_id7` when `v_primaryprogram_all_level`.`l8` then `v_primaryprogram_all_level`.`amp_program_id8` end) AS `amp_program_id`,sum(`v_primaryprogram_all_level`.`program_percentage`) AS `program_percentage` from `v_primaryprogram_all_level` group by `v_primaryprogram_all_level`.`amp_activity_id`,(case 0 when `v_primaryprogram_all_level`.`l1` then `v_primaryprogram_all_level`.`amp_program_id1` when `v_primaryprogram_all_level`.`l2` then `v_primaryprogram_all_level`.`amp_program_id2` when `v_primaryprogram_all_level`.`l3` then `v_primaryprogram_all_level`.`amp_program_id3` when `v_primaryprogram_all_level`.`l4` then `v_primaryprogram_all_level`.`amp_program_id4` when `v_primaryprogram_all_level`.`l5` then `v_primaryprogram_all_level`.`amp_program_id5` when `v_primaryprogram_all_level`.`l6` then `v_primaryprogram_all_level`.`amp_program_id6` when `v_primaryprogram_all_level`.`l7` then `v_primaryprogram_all_level`.`amp_program_id7` when `v_primaryprogram_all_level`.`l8` then `v_primaryprogram_all_level`.`amp_program_id8` end) having (`name` is not null);;
CREATE OR REPLACE VIEW v_primaryprogram_level_1 AS /* ALGORITHM=UNDEFINED */ select `v_primaryprogram_all_level`.`amp_activity_id` AS `amp_activity_id`,(case 1 when `v_primaryprogram_all_level`.`l1` then `v_primaryprogram_all_level`.`n1` when `v_primaryprogram_all_level`.`l2` then `v_primaryprogram_all_level`.`n2` when `v_primaryprogram_all_level`.`l3` then `v_primaryprogram_all_level`.`n3` when `v_primaryprogram_all_level`.`l4` then `v_primaryprogram_all_level`.`n4` when `v_primaryprogram_all_level`.`l5` then `v_primaryprogram_all_level`.`n5` when `v_primaryprogram_all_level`.`l6` then `v_primaryprogram_all_level`.`n6` when `v_primaryprogram_all_level`.`l7` then `v_primaryprogram_all_level`.`n7` when `v_primaryprogram_all_level`.`l8` then `v_primaryprogram_all_level`.`n8` end) AS `name`,(case 1 when `v_primaryprogram_all_level`.`l1` then `v_primaryprogram_all_level`.`amp_program_id1` when `v_primaryprogram_all_level`.`l2` then `v_primaryprogram_all_level`.`amp_program_id2` when `v_primaryprogram_all_level`.`l3` then `v_primaryprogram_all_level`.`amp_program_id3` when `v_primaryprogram_all_level`.`l4` then `v_primaryprogram_all_level`.`amp_program_id4` when `v_primaryprogram_all_level`.`l5` then `v_primaryprogram_all_level`.`amp_program_id5` when `v_primaryprogram_all_level`.`l6` then `v_primaryprogram_all_level`.`amp_program_id6` when `v_primaryprogram_all_level`.`l7` then `v_primaryprogram_all_level`.`amp_program_id7` when `v_primaryprogram_all_level`.`l8` then `v_primaryprogram_all_level`.`amp_program_id8` end) AS `amp_program_id`,sum(`v_primaryprogram_all_level`.`program_percentage`) AS `program_percentage` from `v_primaryprogram_all_level` group by `v_primaryprogram_all_level`.`amp_activity_id`,(case 1 when `v_primaryprogram_all_level`.`l1` then `v_primaryprogram_all_level`.`amp_program_id1` when `v_primaryprogram_all_level`.`l2` then `v_primaryprogram_all_level`.`amp_program_id2` when `v_primaryprogram_all_level`.`l3` then `v_primaryprogram_all_level`.`amp_program_id3` when `v_primaryprogram_all_level`.`l4` then `v_primaryprogram_all_level`.`amp_program_id4` when `v_primaryprogram_all_level`.`l5` then `v_primaryprogram_all_level`.`amp_program_id5` when `v_primaryprogram_all_level`.`l6` then `v_primaryprogram_all_level`.`amp_program_id6` when `v_primaryprogram_all_level`.`l7` then `v_primaryprogram_all_level`.`amp_program_id7` when `v_primaryprogram_all_level`.`l8` then `v_primaryprogram_all_level`.`amp_program_id8` end) having (`name` is not null);;
CREATE OR REPLACE VIEW v_primaryprogram_level_2 AS /* ALGORITHM=UNDEFINED */ select `v_primaryprogram_all_level`.`amp_activity_id` AS `amp_activity_id`,(case 2 when `v_primaryprogram_all_level`.`l1` then `v_primaryprogram_all_level`.`n1` when `v_primaryprogram_all_level`.`l2` then `v_primaryprogram_all_level`.`n2` when `v_primaryprogram_all_level`.`l3` then `v_primaryprogram_all_level`.`n3` when `v_primaryprogram_all_level`.`l4` then `v_primaryprogram_all_level`.`n4` when `v_primaryprogram_all_level`.`l5` then `v_primaryprogram_all_level`.`n5` when `v_primaryprogram_all_level`.`l6` then `v_primaryprogram_all_level`.`n6` when `v_primaryprogram_all_level`.`l7` then `v_primaryprogram_all_level`.`n7` when `v_primaryprogram_all_level`.`l8` then `v_primaryprogram_all_level`.`n8` end) AS `name`,(case 2 when `v_primaryprogram_all_level`.`l1` then `v_primaryprogram_all_level`.`amp_program_id1` when `v_primaryprogram_all_level`.`l2` then `v_primaryprogram_all_level`.`amp_program_id2` when `v_primaryprogram_all_level`.`l3` then `v_primaryprogram_all_level`.`amp_program_id3` when `v_primaryprogram_all_level`.`l4` then `v_primaryprogram_all_level`.`amp_program_id4` when `v_primaryprogram_all_level`.`l5` then `v_primaryprogram_all_level`.`amp_program_id5` when `v_primaryprogram_all_level`.`l6` then `v_primaryprogram_all_level`.`amp_program_id6` when `v_primaryprogram_all_level`.`l7` then `v_primaryprogram_all_level`.`amp_program_id7` when `v_primaryprogram_all_level`.`l8` then `v_primaryprogram_all_level`.`amp_program_id8` end) AS `amp_program_id`,sum(`v_primaryprogram_all_level`.`program_percentage`) AS `program_percentage` from `v_primaryprogram_all_level` group by `v_primaryprogram_all_level`.`amp_activity_id`,(case 2 when `v_primaryprogram_all_level`.`l1` then `v_primaryprogram_all_level`.`amp_program_id1` when `v_primaryprogram_all_level`.`l2` then `v_primaryprogram_all_level`.`amp_program_id2` when `v_primaryprogram_all_level`.`l3` then `v_primaryprogram_all_level`.`amp_program_id3` when `v_primaryprogram_all_level`.`l4` then `v_primaryprogram_all_level`.`amp_program_id4` when `v_primaryprogram_all_level`.`l5` then `v_primaryprogram_all_level`.`amp_program_id5` when `v_primaryprogram_all_level`.`l6` then `v_primaryprogram_all_level`.`amp_program_id6` when `v_primaryprogram_all_level`.`l7` then `v_primaryprogram_all_level`.`amp_program_id7` when `v_primaryprogram_all_level`.`l8` then `v_primaryprogram_all_level`.`amp_program_id8` end) having (`name` is not null);;
CREATE OR REPLACE VIEW v_primaryprogram_level_3 AS /* ALGORITHM=UNDEFINED */ select `v_primaryprogram_all_level`.`amp_activity_id` AS `amp_activity_id`,(case 3 when `v_primaryprogram_all_level`.`l1` then `v_primaryprogram_all_level`.`n1` when `v_primaryprogram_all_level`.`l2` then `v_primaryprogram_all_level`.`n2` when `v_primaryprogram_all_level`.`l3` then `v_primaryprogram_all_level`.`n3` when `v_primaryprogram_all_level`.`l4` then `v_primaryprogram_all_level`.`n4` when `v_primaryprogram_all_level`.`l5` then `v_primaryprogram_all_level`.`n5` when `v_primaryprogram_all_level`.`l6` then `v_primaryprogram_all_level`.`n6` when `v_primaryprogram_all_level`.`l7` then `v_primaryprogram_all_level`.`n7` when `v_primaryprogram_all_level`.`l8` then `v_primaryprogram_all_level`.`n8` end) AS `name`,(case 3 when `v_primaryprogram_all_level`.`l1` then `v_primaryprogram_all_level`.`amp_program_id1` when `v_primaryprogram_all_level`.`l2` then `v_primaryprogram_all_level`.`amp_program_id2` when `v_primaryprogram_all_level`.`l3` then `v_primaryprogram_all_level`.`amp_program_id3` when `v_primaryprogram_all_level`.`l4` then `v_primaryprogram_all_level`.`amp_program_id4` when `v_primaryprogram_all_level`.`l5` then `v_primaryprogram_all_level`.`amp_program_id5` when `v_primaryprogram_all_level`.`l6` then `v_primaryprogram_all_level`.`amp_program_id6` when `v_primaryprogram_all_level`.`l7` then `v_primaryprogram_all_level`.`amp_program_id7` when `v_primaryprogram_all_level`.`l8` then `v_primaryprogram_all_level`.`amp_program_id8` end) AS `amp_program_id`,sum(`v_primaryprogram_all_level`.`program_percentage`) AS `program_percentage` from `v_primaryprogram_all_level` group by `v_primaryprogram_all_level`.`amp_activity_id`,(case 3 when `v_primaryprogram_all_level`.`l1` then `v_primaryprogram_all_level`.`amp_program_id1` when `v_primaryprogram_all_level`.`l2` then `v_primaryprogram_all_level`.`amp_program_id2` when `v_primaryprogram_all_level`.`l3` then `v_primaryprogram_all_level`.`amp_program_id3` when `v_primaryprogram_all_level`.`l4` then `v_primaryprogram_all_level`.`amp_program_id4` when `v_primaryprogram_all_level`.`l5` then `v_primaryprogram_all_level`.`amp_program_id5` when `v_primaryprogram_all_level`.`l6` then `v_primaryprogram_all_level`.`amp_program_id6` when `v_primaryprogram_all_level`.`l7` then `v_primaryprogram_all_level`.`amp_program_id7` when `v_primaryprogram_all_level`.`l8` then `v_primaryprogram_all_level`.`amp_program_id8` end) having (`name` is not null);;
CREATE OR REPLACE VIEW v_primaryprogram_level_4 AS /* ALGORITHM=UNDEFINED */ select `v_primaryprogram_all_level`.`amp_activity_id` AS `amp_activity_id`,(case 4 when `v_primaryprogram_all_level`.`l1` then `v_primaryprogram_all_level`.`n1` when `v_primaryprogram_all_level`.`l2` then `v_primaryprogram_all_level`.`n2` when `v_primaryprogram_all_level`.`l3` then `v_primaryprogram_all_level`.`n3` when `v_primaryprogram_all_level`.`l4` then `v_primaryprogram_all_level`.`n4` when `v_primaryprogram_all_level`.`l5` then `v_primaryprogram_all_level`.`n5` when `v_primaryprogram_all_level`.`l6` then `v_primaryprogram_all_level`.`n6` when `v_primaryprogram_all_level`.`l7` then `v_primaryprogram_all_level`.`n7` when `v_primaryprogram_all_level`.`l8` then `v_primaryprogram_all_level`.`n8` end) AS `name`,(case 4 when `v_primaryprogram_all_level`.`l1` then `v_primaryprogram_all_level`.`amp_program_id1` when `v_primaryprogram_all_level`.`l2` then `v_primaryprogram_all_level`.`amp_program_id2` when `v_primaryprogram_all_level`.`l3` then `v_primaryprogram_all_level`.`amp_program_id3` when `v_primaryprogram_all_level`.`l4` then `v_primaryprogram_all_level`.`amp_program_id4` when `v_primaryprogram_all_level`.`l5` then `v_primaryprogram_all_level`.`amp_program_id5` when `v_primaryprogram_all_level`.`l6` then `v_primaryprogram_all_level`.`amp_program_id6` when `v_primaryprogram_all_level`.`l7` then `v_primaryprogram_all_level`.`amp_program_id7` when `v_primaryprogram_all_level`.`l8` then `v_primaryprogram_all_level`.`amp_program_id8` end) AS `amp_program_id`,sum(`v_primaryprogram_all_level`.`program_percentage`) AS `program_percentage` from `v_primaryprogram_all_level` group by `v_primaryprogram_all_level`.`amp_activity_id`,(case 4 when `v_primaryprogram_all_level`.`l1` then `v_primaryprogram_all_level`.`amp_program_id1` when `v_primaryprogram_all_level`.`l2` then `v_primaryprogram_all_level`.`amp_program_id2` when `v_primaryprogram_all_level`.`l3` then `v_primaryprogram_all_level`.`amp_program_id3` when `v_primaryprogram_all_level`.`l4` then `v_primaryprogram_all_level`.`amp_program_id4` when `v_primaryprogram_all_level`.`l5` then `v_primaryprogram_all_level`.`amp_program_id5` when `v_primaryprogram_all_level`.`l6` then `v_primaryprogram_all_level`.`amp_program_id6` when `v_primaryprogram_all_level`.`l7` then `v_primaryprogram_all_level`.`amp_program_id7` when `v_primaryprogram_all_level`.`l8` then `v_primaryprogram_all_level`.`amp_program_id8` end) having (`name` is not null);;
CREATE OR REPLACE VIEW v_primaryprogram_level_5 AS /* ALGORITHM=UNDEFINED */ select `v_primaryprogram_all_level`.`amp_activity_id` AS `amp_activity_id`,(case 5 when `v_primaryprogram_all_level`.`l1` then `v_primaryprogram_all_level`.`n1` when `v_primaryprogram_all_level`.`l2` then `v_primaryprogram_all_level`.`n2` when `v_primaryprogram_all_level`.`l3` then `v_primaryprogram_all_level`.`n3` when `v_primaryprogram_all_level`.`l4` then `v_primaryprogram_all_level`.`n4` when `v_primaryprogram_all_level`.`l5` then `v_primaryprogram_all_level`.`n5` when `v_primaryprogram_all_level`.`l6` then `v_primaryprogram_all_level`.`n6` when `v_primaryprogram_all_level`.`l7` then `v_primaryprogram_all_level`.`n7` when `v_primaryprogram_all_level`.`l8` then `v_primaryprogram_all_level`.`n8` end) AS `name`,(case 5 when `v_primaryprogram_all_level`.`l1` then `v_primaryprogram_all_level`.`amp_program_id1` when `v_primaryprogram_all_level`.`l2` then `v_primaryprogram_all_level`.`amp_program_id2` when `v_primaryprogram_all_level`.`l3` then `v_primaryprogram_all_level`.`amp_program_id3` when `v_primaryprogram_all_level`.`l4` then `v_primaryprogram_all_level`.`amp_program_id4` when `v_primaryprogram_all_level`.`l5` then `v_primaryprogram_all_level`.`amp_program_id5` when `v_primaryprogram_all_level`.`l6` then `v_primaryprogram_all_level`.`amp_program_id6` when `v_primaryprogram_all_level`.`l7` then `v_primaryprogram_all_level`.`amp_program_id7` when `v_primaryprogram_all_level`.`l8` then `v_primaryprogram_all_level`.`amp_program_id8` end) AS `amp_program_id`,sum(`v_primaryprogram_all_level`.`program_percentage`) AS `program_percentage` from `v_primaryprogram_all_level` group by `v_primaryprogram_all_level`.`amp_activity_id`,(case 5 when `v_primaryprogram_all_level`.`l1` then `v_primaryprogram_all_level`.`amp_program_id1` when `v_primaryprogram_all_level`.`l2` then `v_primaryprogram_all_level`.`amp_program_id2` when `v_primaryprogram_all_level`.`l3` then `v_primaryprogram_all_level`.`amp_program_id3` when `v_primaryprogram_all_level`.`l4` then `v_primaryprogram_all_level`.`amp_program_id4` when `v_primaryprogram_all_level`.`l5` then `v_primaryprogram_all_level`.`amp_program_id5` when `v_primaryprogram_all_level`.`l6` then `v_primaryprogram_all_level`.`amp_program_id6` when `v_primaryprogram_all_level`.`l7` then `v_primaryprogram_all_level`.`amp_program_id7` when `v_primaryprogram_all_level`.`l8` then `v_primaryprogram_all_level`.`amp_program_id8` end) having (`name` is not null);;
CREATE OR REPLACE VIEW v_primaryprogram_level_6 AS /* ALGORITHM=UNDEFINED */ select `v_primaryprogram_all_level`.`amp_activity_id` AS `amp_activity_id`,(case 6 when `v_primaryprogram_all_level`.`l1` then `v_primaryprogram_all_level`.`n1` when `v_primaryprogram_all_level`.`l2` then `v_primaryprogram_all_level`.`n2` when `v_primaryprogram_all_level`.`l3` then `v_primaryprogram_all_level`.`n3` when `v_primaryprogram_all_level`.`l4` then `v_primaryprogram_all_level`.`n4` when `v_primaryprogram_all_level`.`l5` then `v_primaryprogram_all_level`.`n5` when `v_primaryprogram_all_level`.`l6` then `v_primaryprogram_all_level`.`n6` when `v_primaryprogram_all_level`.`l7` then `v_primaryprogram_all_level`.`n7` when `v_primaryprogram_all_level`.`l8` then `v_primaryprogram_all_level`.`n8` end) AS `name`,(case 6 when `v_primaryprogram_all_level`.`l1` then `v_primaryprogram_all_level`.`amp_program_id1` when `v_primaryprogram_all_level`.`l2` then `v_primaryprogram_all_level`.`amp_program_id2` when `v_primaryprogram_all_level`.`l3` then `v_primaryprogram_all_level`.`amp_program_id3` when `v_primaryprogram_all_level`.`l4` then `v_primaryprogram_all_level`.`amp_program_id4` when `v_primaryprogram_all_level`.`l5` then `v_primaryprogram_all_level`.`amp_program_id5` when `v_primaryprogram_all_level`.`l6` then `v_primaryprogram_all_level`.`amp_program_id6` when `v_primaryprogram_all_level`.`l7` then `v_primaryprogram_all_level`.`amp_program_id7` when `v_primaryprogram_all_level`.`l8` then `v_primaryprogram_all_level`.`amp_program_id8` end) AS `amp_program_id`,sum(`v_primaryprogram_all_level`.`program_percentage`) AS `program_percentage` from `v_primaryprogram_all_level` group by `v_primaryprogram_all_level`.`amp_activity_id`,(case 6 when `v_primaryprogram_all_level`.`l1` then `v_primaryprogram_all_level`.`amp_program_id1` when `v_primaryprogram_all_level`.`l2` then `v_primaryprogram_all_level`.`amp_program_id2` when `v_primaryprogram_all_level`.`l3` then `v_primaryprogram_all_level`.`amp_program_id3` when `v_primaryprogram_all_level`.`l4` then `v_primaryprogram_all_level`.`amp_program_id4` when `v_primaryprogram_all_level`.`l5` then `v_primaryprogram_all_level`.`amp_program_id5` when `v_primaryprogram_all_level`.`l6` then `v_primaryprogram_all_level`.`amp_program_id6` when `v_primaryprogram_all_level`.`l7` then `v_primaryprogram_all_level`.`amp_program_id7` when `v_primaryprogram_all_level`.`l8` then `v_primaryprogram_all_level`.`amp_program_id8` end) having (`name` is not null);;
CREATE OR REPLACE VIEW v_primaryprogram_level_7 AS /* ALGORITHM=UNDEFINED */ select `v_primaryprogram_all_level`.`amp_activity_id` AS `amp_activity_id`,(case 7 when `v_primaryprogram_all_level`.`l1` then `v_primaryprogram_all_level`.`n1` when `v_primaryprogram_all_level`.`l2` then `v_primaryprogram_all_level`.`n2` when `v_primaryprogram_all_level`.`l3` then `v_primaryprogram_all_level`.`n3` when `v_primaryprogram_all_level`.`l4` then `v_primaryprogram_all_level`.`n4` when `v_primaryprogram_all_level`.`l5` then `v_primaryprogram_all_level`.`n5` when `v_primaryprogram_all_level`.`l6` then `v_primaryprogram_all_level`.`n6` when `v_primaryprogram_all_level`.`l7` then `v_primaryprogram_all_level`.`n7` when `v_primaryprogram_all_level`.`l8` then `v_primaryprogram_all_level`.`n8` end) AS `name`,(case 7 when `v_primaryprogram_all_level`.`l1` then `v_primaryprogram_all_level`.`amp_program_id1` when `v_primaryprogram_all_level`.`l2` then `v_primaryprogram_all_level`.`amp_program_id2` when `v_primaryprogram_all_level`.`l3` then `v_primaryprogram_all_level`.`amp_program_id3` when `v_primaryprogram_all_level`.`l4` then `v_primaryprogram_all_level`.`amp_program_id4` when `v_primaryprogram_all_level`.`l5` then `v_primaryprogram_all_level`.`amp_program_id5` when `v_primaryprogram_all_level`.`l6` then `v_primaryprogram_all_level`.`amp_program_id6` when `v_primaryprogram_all_level`.`l7` then `v_primaryprogram_all_level`.`amp_program_id7` when `v_primaryprogram_all_level`.`l8` then `v_primaryprogram_all_level`.`amp_program_id8` end) AS `amp_program_id`,sum(`v_primaryprogram_all_level`.`program_percentage`) AS `program_percentage` from `v_primaryprogram_all_level` group by `v_primaryprogram_all_level`.`amp_activity_id`,(case 7 when `v_primaryprogram_all_level`.`l1` then `v_primaryprogram_all_level`.`amp_program_id1` when `v_primaryprogram_all_level`.`l2` then `v_primaryprogram_all_level`.`amp_program_id2` when `v_primaryprogram_all_level`.`l3` then `v_primaryprogram_all_level`.`amp_program_id3` when `v_primaryprogram_all_level`.`l4` then `v_primaryprogram_all_level`.`amp_program_id4` when `v_primaryprogram_all_level`.`l5` then `v_primaryprogram_all_level`.`amp_program_id5` when `v_primaryprogram_all_level`.`l6` then `v_primaryprogram_all_level`.`amp_program_id6` when `v_primaryprogram_all_level`.`l7` then `v_primaryprogram_all_level`.`amp_program_id7` when `v_primaryprogram_all_level`.`l8` then `v_primaryprogram_all_level`.`amp_program_id8` end) having (`name` is not null);;
CREATE OR REPLACE VIEW v_primaryprogram_level_8 AS /* ALGORITHM=UNDEFINED */ select `v_primaryprogram_all_level`.`amp_activity_id` AS `amp_activity_id`,(case 8 when `v_primaryprogram_all_level`.`l1` then `v_primaryprogram_all_level`.`n1` when `v_primaryprogram_all_level`.`l2` then `v_primaryprogram_all_level`.`n2` when `v_primaryprogram_all_level`.`l3` then `v_primaryprogram_all_level`.`n3` when `v_primaryprogram_all_level`.`l4` then `v_primaryprogram_all_level`.`n4` when `v_primaryprogram_all_level`.`l5` then `v_primaryprogram_all_level`.`n5` when `v_primaryprogram_all_level`.`l6` then `v_primaryprogram_all_level`.`n6` when `v_primaryprogram_all_level`.`l7` then `v_primaryprogram_all_level`.`n7` when `v_primaryprogram_all_level`.`l8` then `v_primaryprogram_all_level`.`n8` end) AS `name`,(case 8 when `v_primaryprogram_all_level`.`l1` then `v_primaryprogram_all_level`.`amp_program_id1` when `v_primaryprogram_all_level`.`l2` then `v_primaryprogram_all_level`.`amp_program_id2` when `v_primaryprogram_all_level`.`l3` then `v_primaryprogram_all_level`.`amp_program_id3` when `v_primaryprogram_all_level`.`l4` then `v_primaryprogram_all_level`.`amp_program_id4` when `v_primaryprogram_all_level`.`l5` then `v_primaryprogram_all_level`.`amp_program_id5` when `v_primaryprogram_all_level`.`l6` then `v_primaryprogram_all_level`.`amp_program_id6` when `v_primaryprogram_all_level`.`l7` then `v_primaryprogram_all_level`.`amp_program_id7` when `v_primaryprogram_all_level`.`l8` then `v_primaryprogram_all_level`.`amp_program_id8` end) AS `amp_program_id`,sum(`v_primaryprogram_all_level`.`program_percentage`) AS `program_percentage` from `v_primaryprogram_all_level` group by `v_primaryprogram_all_level`.`amp_activity_id`,(case 8 when `v_primaryprogram_all_level`.`l1` then `v_primaryprogram_all_level`.`amp_program_id1` when `v_primaryprogram_all_level`.`l2` then `v_primaryprogram_all_level`.`amp_program_id2` when `v_primaryprogram_all_level`.`l3` then `v_primaryprogram_all_level`.`amp_program_id3` when `v_primaryprogram_all_level`.`l4` then `v_primaryprogram_all_level`.`amp_program_id4` when `v_primaryprogram_all_level`.`l5` then `v_primaryprogram_all_level`.`amp_program_id5` when `v_primaryprogram_all_level`.`l6` then `v_primaryprogram_all_level`.`amp_program_id6` when `v_primaryprogram_all_level`.`l7` then `v_primaryprogram_all_level`.`amp_program_id7` when `v_primaryprogram_all_level`.`l8` then `v_primaryprogram_all_level`.`amp_program_id8` end) having (`name` is not null);;
CREATE OR REPLACE VIEW v_project_category AS /* ALGORITHM=UNDEFINED */ select `aac`.`amp_activity_id` AS `amp_activity_id`,`acv`.`category_value` AS `name`,`aac`.`amp_categoryvalue_id` AS `amp_category_id` from ((`amp_category_value` `acv` join `amp_category_class` `acc`) join `amp_activities_categoryvalues` `aac`) where ((`acv`.`id` = `aac`.`amp_categoryvalue_id`) and (`acc`.`id` = `acv`.`amp_category_class_id`) and (`acc`.`keyName` = _latin1'project_category'));;
CREATE OR REPLACE VIEW v_project_comments AS /* ALGORITHM=UNDEFINED */ select distinct `amp_activity`.`amp_activity_id` AS `amp_activity_id`,trim(`dg_editor`.`BODY`) AS `trim(dg_editor.body)` from (`amp_activity` join `dg_editor`) where (`amp_activity`.`projectComments` = `dg_editor`.`EDITOR_KEY`) order by `amp_activity`.`amp_activity_id`;;
CREATE OR REPLACE VIEW v_project_id AS /* ALGORITHM=UNDEFINED */ select `i`.`amp_activity_id` AS `amp_activity_id`,concat(convert(`i`.`internal_id` using utf8),_utf8' (',convert(`o`.`name` using utf8),_utf8')') AS `concat(i.internal_id,' (',o.name,')')` from (`amp_organisation` `o` join `amp_activity_internal_id` `i`) where (`o`.`amp_org_id` = `i`.`amp_org_id`);;
CREATE OR REPLACE VIEW v_proposed_completion_date AS /* ALGORITHM=UNDEFINED */ select `amp_activity`.`amp_activity_id` AS `amp_activity_id`,`amp_activity`.`proposed_completion_date` AS `proposed_completion_date` from `amp_activity` order by `amp_activity`.`amp_activity_id`;;
CREATE OR REPLACE VIEW v_proposed_cost AS /* ALGORITHM=UNDEFINED */ select `amp_activity`.`amp_activity_id` AS `amp_activity_id`,`amp_activity`.`amp_activity_id` AS `object_id`,`amp_activity`.`amp_activity_id` AS `object_id2`,`amp_activity`.`proj_cost_amount` AS `transaction_amount`,`amp_activity`.`proj_cost_currcode` AS `currency_code`,`amp_activity`.`proj_cost_date` AS `transaction_date` from `amp_activity` where (`amp_activity`.`proj_cost_amount` is not null);;
CREATE OR REPLACE VIEW v_purposes AS /* ALGORITHM=UNDEFINED */ select `amp_activity`.`amp_activity_id` AS `amp_activity_id`,trim(`dg_editor`.`BODY`) AS `ebody` from (`amp_activity` join `dg_editor`) where (`amp_activity`.`purpose` = `dg_editor`.`EDITOR_KEY`) order by `amp_activity`.`amp_activity_id`;;
CREATE OR REPLACE VIEW v_regional_funding AS /* ALGORITHM=UNDEFINED */ select `f`.`activity_id` AS `amp_activity_id`,`f`.`amp_regional_funding_id` AS `amp_regional_funding_id`,`f`.`amp_regional_funding_id` AS `amp_fund_detail_id`,`r`.`location_name` AS `region_name`,`f`.`transaction_type` AS `transaction_type`,`f`.`adjustment_type` AS `adjustment_type`,`f`.`transaction_date` AS `transaction_date`,`f`.`transaction_amount` AS `transaction_amount`,`c`.`currency_code` AS `currency_code`,`f`.`region_location_id` AS `region_id` from (((`amp_regional_funding` `f` join `amp_category_value_location` `r`) join `amp_currency` `c`) join `amp_category_value` `v`) where ((`c`.`amp_currency_id` = `f`.`currency_id`) and (`f`.`region_location_id` = `r`.`id`) and (`r`.`parent_category_value` = `v`.`id`) and (`v`.`category_value` = _latin1'Region')) order by `f`.`activity_id`;;
CREATE OR REPLACE VIEW v_regional_group AS /* ALGORITHM=UNDEFINED */ select `f`.`activity` AS `amp_activity_id`,`o`.`name` AS `name`,`f`.`organisation` AS `amp_org_id` from ((`amp_org_role` `f` join `amp_organisation` `o`) join `amp_role` `r` on(((`f`.`organisation` = `o`.`amp_org_id`) and (`f`.`role` = `r`.`amp_role_id`) and (`r`.`role_code` = _latin1'RG')))) order by `f`.`activity`,`o`.`name`;;
CREATE OR REPLACE VIEW v_regions AS /* ALGORITHM=UNDEFINED */ select `ra`.`amp_activity_id` AS `amp_activity_id`,`l`.`region` AS `region`,`l`.`region_location_id` AS `region_id`,sum(`ra`.`location_percentage`) AS `location_percentage` from ((`amp_activity_location` `ra` join `amp_location` `l` on((`ra`.`amp_location_id` = `l`.`amp_location_id`))) join `amp_category_value_location` `cvl` on((`l`.`location_id` = `cvl`.`id`))) where (`l`.`region_location_id` is not null) group by `ra`.`amp_activity_id`,`l`.`region_id` order by `ra`.`amp_activity_id`,`l`.`name`;;
CREATE OR REPLACE VIEW v_regions_cached AS /* ALGORITHM=UNDEFINED */ select `aa`.`amp_activity_id` AS `amp_activity_id`,`al`.`region_location_id` AS `region_id`,sum(`lp`.`location_percentage`) AS `location_percentage`,`acvl`.`location_name` AS `Region` from (((`amp_activity` `aa` left join `amp_activity_location` `lp` on((`aa`.`amp_activity_id` = `lp`.`amp_activity_id`))) left join `amp_location` `al` on((`lp`.`amp_location_id` = `al`.`amp_location_id`))) left join `amp_category_value_location` `acvl` on((`al`.`region_location_id` = `acvl`.`id`))) group by `aa`.`amp_activity_id`,`al`.`region_location_id`,`acvl`.`location_name` order by `aa`.`amp_activity_id`,`al`.`region_location_id`;;
CREATE OR REPLACE VIEW v_responsible_org_groups AS /* ALGORITHM=UNDEFINED */ select `f`.`activity` AS `amp_activity_id`,`b`.`org_grp_name` AS `name`,`b`.`amp_org_grp_id` AS `amp_org_grp_id` from (((`amp_org_role` `f` join `amp_organisation` `o`) join `amp_role` `r`) join `amp_org_group` `b` on(((`f`.`organisation` = `o`.`amp_org_id`) and (`f`.`role` = `r`.`amp_role_id`) and (`r`.`role_code` = _latin1'RO') and (`o`.`org_grp_id` = `b`.`amp_org_grp_id`)))) order by `f`.`activity`,`o`.`name`;;
CREATE OR REPLACE VIEW v_responsible_organisation AS /* ALGORITHM=UNDEFINED */ select `f`.`activity` AS `amp_activity_id`,`o`.`name` AS `name`,`f`.`organisation` AS `amp_org_id` from ((`amp_org_role` `f` join `amp_organisation` `o`) join `amp_role` `r` on(((`f`.`organisation` = `o`.`amp_org_id`) and (`f`.`role` = `r`.`amp_role_id`) and (`r`.`role_code` = _latin1'RO')))) order by `f`.`activity`,`o`.`name`;;
CREATE OR REPLACE VIEW v_results AS /* ALGORITHM=UNDEFINED */ select `amp_activity`.`amp_activity_id` AS `amp_activity_id`,trim(`dg_editor`.`BODY`) AS `ebody` from (`amp_activity` join `dg_editor`) where (`amp_activity`.`results` = `dg_editor`.`EDITOR_KEY`) order by `amp_activity`.`amp_activity_id`;;
CREATE OR REPLACE VIEW v_secondary_sectors AS /* ALGORITHM=UNDEFINED */ select `sa`.`amp_activity_id` AS `amp_activity_id`,`getSectorName`(`getParentSectorId`(`s`.`amp_sector_id`)) AS `sectorname`,`getParentSectorId`(`s`.`amp_sector_id`) AS `amp_sector_id`,sum(`sa`.`sector_percentage`) AS `sector_percentage`,`s`.`amp_sec_scheme_id` AS `amp_sector_scheme_id` from ((`amp_activity_sector` `sa` join `amp_sector` `s`) join `amp_sector_scheme` `ss`) where ((`s`.`amp_sector_id` = `sa`.`amp_sector_id`) and `s`.`amp_sec_scheme_id` in (select `amp_classification_config`.`classification_id` AS `classification_id` from `amp_classification_config` where (`amp_classification_config`.`name` = _latin1'Secondary')) and (`s`.`amp_sec_scheme_id` = `ss`.`amp_sec_scheme_id`)) group by `sa`.`amp_activity_id`,`getSectorName`(`getParentSectorId`(`s`.`amp_sector_id`)) order by `sa`.`amp_activity_id`,`getSectorName`(`getParentSectorId`(`s`.`amp_sector_id`));;
CREATE OR REPLACE VIEW v_secondary_sub_sectors AS /* ALGORITHM=UNDEFINED */ select `sa`.`amp_activity_id` AS `amp_activity_id`,`getSectorName`(`getParentSubSectorId`(`s`.`amp_sector_id`)) AS `sectorname`,`getParentSubSectorId`(`s`.`amp_sector_id`) AS `amp_sector_id`,sum(`sa`.`sector_percentage`) AS `sector_percentage`,`s`.`amp_sec_scheme_id` AS `amp_sec_scheme_id`,`ss`.`sec_scheme_name` AS `sec_scheme_name` from (((`amp_sector_scheme` `ss` join `amp_classification_config` `cc` on(((`cc`.`name` = _latin1'Secondary') and (`cc`.`classification_id` = `ss`.`amp_sec_scheme_id`)))) join `amp_sector` `s` on(((`s`.`amp_sec_scheme_id` = `ss`.`amp_sec_scheme_id`) and (`getSectorDepth`(`s`.`amp_sector_id`) >= 1)))) join `amp_activity_sector` `sa` on(((`sa`.`amp_sector_id` = `s`.`amp_sector_id`) and (`sa`.`classification_config_id` = `cc`.`id`)))) group by `sa`.`amp_activity_id`,`getParentSubSectorId`(`s`.`amp_sector_id`) order by `sa`.`amp_activity_id`,`getSectorName`(`getParentSubSectorId`(`s`.`amp_sector_id`));;
CREATE OR REPLACE VIEW v_secondary_sub_sub_sectors AS /* ALGORITHM=UNDEFINED */ select `a`.`amp_activity_id` AS `amp_activity_id`,`s`.`name` AS `name`,`s`.`amp_sector_id` AS `amp_sector_id`,`a`.`sector_percentage` AS `sector_percentage` from (`amp_activity_sector` `a` join `amp_sector` `s`) where ((`a`.`amp_sector_id` = `s`.`amp_sector_id`) and (`getSectorDepth`(`s`.`amp_sector_id`) = 2) and `s`.`amp_sec_scheme_id` in (select `c`.`classification_id` AS `classification_id` from `amp_classification_config` `c` where (`c`.`name` = _latin1'Secondary'))) order by `a`.`amp_activity_id`,`s`.`name`;;
CREATE OR REPLACE VIEW v_secondaryprogram AS /* ALGORITHM=UNDEFINED */ select `a`.`amp_activity_id` AS `amp_activity_id`,`t`.`name` AS `name`,`ap`.`amp_program_id` AS `amp_program_id`,`ap`.`program_percentage` AS `program_percentage` from ((`amp_activity` `a` join `amp_activity_program` `ap` on(((`a`.`amp_activity_id` = `ap`.`amp_activity_id`) and (`ap`.`program_setting` = 3)))) join `amp_theme` `t` on((`t`.`amp_theme_id` = `ap`.`amp_program_id`))) order by `a`.`amp_activity_id`,`t`.`name`;;
CREATE OR REPLACE VIEW v_secondaryprogram_all_level AS /* ALGORITHM=UNDEFINED */ select `a`.`amp_activity_id` AS `amp_activity_id`,`a`.`program_percentage` AS `program_percentage`,`b`.`amp_theme_id` AS `amp_program_id1`,`b`.`name` AS `n1`,`b`.`level_` AS `l1`,`b1`.`amp_theme_id` AS `amp_program_id2`,`b1`.`name` AS `n2`,`b1`.`level_` AS `l2`,`b2`.`amp_theme_id` AS `amp_program_id3`,`b2`.`name` AS `n3`,`b2`.`level_` AS `l3`,`b3`.`amp_theme_id` AS `amp_program_id4`,`b3`.`name` AS `n4`,`b3`.`level_` AS `l4`,`b4`.`amp_theme_id` AS `amp_program_id5`,`b4`.`name` AS `n5`,`b4`.`level_` AS `l5`,`b5`.`amp_theme_id` AS `amp_program_id6`,`b5`.`name` AS `n6`,`b5`.`level_` AS `l6`,`b6`.`amp_theme_id` AS `amp_program_id7`,`b6`.`name` AS `n7`,`b6`.`level_` AS `l7`,`b7`.`amp_theme_id` AS `amp_program_id8`,`b7`.`name` AS `n8`,`b7`.`level_` AS `l8` from ((((((((`amp_activity_program` `a` join `amp_theme` `b` on((`a`.`amp_program_id` = `b`.`amp_theme_id`))) left join `amp_theme` `b1` on((`b1`.`amp_theme_id` = `b`.`parent_theme_id`))) left join `amp_theme` `b2` on((`b2`.`amp_theme_id` = `b1`.`parent_theme_id`))) left join `amp_theme` `b3` on((`b3`.`amp_theme_id` = `b2`.`parent_theme_id`))) left join `amp_theme` `b4` on((`b4`.`amp_theme_id` = `b3`.`parent_theme_id`))) left join `amp_theme` `b5` on((`b5`.`amp_theme_id` = `b4`.`parent_theme_id`))) left join `amp_theme` `b6` on((`b6`.`amp_theme_id` = `b5`.`parent_theme_id`))) left join `amp_theme` `b7` on((`b7`.`amp_theme_id` = `b6`.`parent_theme_id`))) where (`a`.`program_setting` = 3);;
CREATE OR REPLACE VIEW v_secondaryprogram_cached AS /* ALGORITHM=UNDEFINED */ select `a`.`amp_activity_id` AS `amp_activity_id`,if((`ap`.`program_setting` = 3),`t`.`name`,NULL) AS `name`,`ap`.`amp_program_id` AS `amp_program_id`,`ap`.`program_percentage` AS `program_percentage`,`ap`.`program_setting` AS `program_setting` from ((`amp_activity` `a` left join `amp_activity_program` `ap` on((`a`.`amp_activity_id` = `ap`.`amp_activity_id`))) left join `amp_theme` `t` on((`t`.`amp_theme_id` = `ap`.`amp_program_id`))) order by `a`.`amp_activity_id`,`t`.`name`;;
CREATE OR REPLACE VIEW v_secondaryprogram_level_0 AS /* ALGORITHM=UNDEFINED */ select `v_secondaryprogram_all_level`.`amp_activity_id` AS `amp_activity_id`,(case 0 when `v_secondaryprogram_all_level`.`l1` then `v_secondaryprogram_all_level`.`n1` when `v_secondaryprogram_all_level`.`l2` then `v_secondaryprogram_all_level`.`n2` when `v_secondaryprogram_all_level`.`l3` then `v_secondaryprogram_all_level`.`n3` when `v_secondaryprogram_all_level`.`l4` then `v_secondaryprogram_all_level`.`n4` when `v_secondaryprogram_all_level`.`l5` then `v_secondaryprogram_all_level`.`n5` when `v_secondaryprogram_all_level`.`l6` then `v_secondaryprogram_all_level`.`n6` when `v_secondaryprogram_all_level`.`l7` then `v_secondaryprogram_all_level`.`n7` when `v_secondaryprogram_all_level`.`l8` then `v_secondaryprogram_all_level`.`n8` end) AS `name`,(case 0 when `v_secondaryprogram_all_level`.`l1` then `v_secondaryprogram_all_level`.`amp_program_id1` when `v_secondaryprogram_all_level`.`l2` then `v_secondaryprogram_all_level`.`amp_program_id2` when `v_secondaryprogram_all_level`.`l3` then `v_secondaryprogram_all_level`.`amp_program_id3` when `v_secondaryprogram_all_level`.`l4` then `v_secondaryprogram_all_level`.`amp_program_id4` when `v_secondaryprogram_all_level`.`l5` then `v_secondaryprogram_all_level`.`amp_program_id5` when `v_secondaryprogram_all_level`.`l6` then `v_secondaryprogram_all_level`.`amp_program_id6` when `v_secondaryprogram_all_level`.`l7` then `v_secondaryprogram_all_level`.`amp_program_id7` when `v_secondaryprogram_all_level`.`l8` then `v_secondaryprogram_all_level`.`amp_program_id8` end) AS `amp_program_id`,sum(`v_secondaryprogram_all_level`.`program_percentage`) AS `program_percentage` from `v_secondaryprogram_all_level` group by `v_secondaryprogram_all_level`.`amp_activity_id`,(case 0 when `v_secondaryprogram_all_level`.`l1` then `v_secondaryprogram_all_level`.`amp_program_id1` when `v_secondaryprogram_all_level`.`l2` then `v_secondaryprogram_all_level`.`amp_program_id2` when `v_secondaryprogram_all_level`.`l3` then `v_secondaryprogram_all_level`.`amp_program_id3` when `v_secondaryprogram_all_level`.`l4` then `v_secondaryprogram_all_level`.`amp_program_id4` when `v_secondaryprogram_all_level`.`l5` then `v_secondaryprogram_all_level`.`amp_program_id5` when `v_secondaryprogram_all_level`.`l6` then `v_secondaryprogram_all_level`.`amp_program_id6` when `v_secondaryprogram_all_level`.`l7` then `v_secondaryprogram_all_level`.`amp_program_id7` when `v_secondaryprogram_all_level`.`l8` then `v_secondaryprogram_all_level`.`amp_program_id8` end) having (`name` is not null);;
CREATE OR REPLACE VIEW v_secondaryprogram_level_1 AS /* ALGORITHM=UNDEFINED */ select `v_secondaryprogram_all_level`.`amp_activity_id` AS `amp_activity_id`,(case 1 when `v_secondaryprogram_all_level`.`l1` then `v_secondaryprogram_all_level`.`n1` when `v_secondaryprogram_all_level`.`l2` then `v_secondaryprogram_all_level`.`n2` when `v_secondaryprogram_all_level`.`l3` then `v_secondaryprogram_all_level`.`n3` when `v_secondaryprogram_all_level`.`l4` then `v_secondaryprogram_all_level`.`n4` when `v_secondaryprogram_all_level`.`l5` then `v_secondaryprogram_all_level`.`n5` when `v_secondaryprogram_all_level`.`l6` then `v_secondaryprogram_all_level`.`n6` when `v_secondaryprogram_all_level`.`l7` then `v_secondaryprogram_all_level`.`n7` when `v_secondaryprogram_all_level`.`l8` then `v_secondaryprogram_all_level`.`n8` end) AS `name`,(case 1 when `v_secondaryprogram_all_level`.`l1` then `v_secondaryprogram_all_level`.`amp_program_id1` when `v_secondaryprogram_all_level`.`l2` then `v_secondaryprogram_all_level`.`amp_program_id2` when `v_secondaryprogram_all_level`.`l3` then `v_secondaryprogram_all_level`.`amp_program_id3` when `v_secondaryprogram_all_level`.`l4` then `v_secondaryprogram_all_level`.`amp_program_id4` when `v_secondaryprogram_all_level`.`l5` then `v_secondaryprogram_all_level`.`amp_program_id5` when `v_secondaryprogram_all_level`.`l6` then `v_secondaryprogram_all_level`.`amp_program_id6` when `v_secondaryprogram_all_level`.`l7` then `v_secondaryprogram_all_level`.`amp_program_id7` when `v_secondaryprogram_all_level`.`l8` then `v_secondaryprogram_all_level`.`amp_program_id8` end) AS `amp_program_id`,sum(`v_secondaryprogram_all_level`.`program_percentage`) AS `program_percentage` from `v_secondaryprogram_all_level` group by `v_secondaryprogram_all_level`.`amp_activity_id`,(case 1 when `v_secondaryprogram_all_level`.`l1` then `v_secondaryprogram_all_level`.`amp_program_id1` when `v_secondaryprogram_all_level`.`l2` then `v_secondaryprogram_all_level`.`amp_program_id2` when `v_secondaryprogram_all_level`.`l3` then `v_secondaryprogram_all_level`.`amp_program_id3` when `v_secondaryprogram_all_level`.`l4` then `v_secondaryprogram_all_level`.`amp_program_id4` when `v_secondaryprogram_all_level`.`l5` then `v_secondaryprogram_all_level`.`amp_program_id5` when `v_secondaryprogram_all_level`.`l6` then `v_secondaryprogram_all_level`.`amp_program_id6` when `v_secondaryprogram_all_level`.`l7` then `v_secondaryprogram_all_level`.`amp_program_id7` when `v_secondaryprogram_all_level`.`l8` then `v_secondaryprogram_all_level`.`amp_program_id8` end) having (`name` is not null);;
CREATE OR REPLACE VIEW v_secondaryprogram_level_2 AS /* ALGORITHM=UNDEFINED */ select `v_secondaryprogram_all_level`.`amp_activity_id` AS `amp_activity_id`,(case 2 when `v_secondaryprogram_all_level`.`l1` then `v_secondaryprogram_all_level`.`n1` when `v_secondaryprogram_all_level`.`l2` then `v_secondaryprogram_all_level`.`n2` when `v_secondaryprogram_all_level`.`l3` then `v_secondaryprogram_all_level`.`n3` when `v_secondaryprogram_all_level`.`l4` then `v_secondaryprogram_all_level`.`n4` when `v_secondaryprogram_all_level`.`l5` then `v_secondaryprogram_all_level`.`n5` when `v_secondaryprogram_all_level`.`l6` then `v_secondaryprogram_all_level`.`n6` when `v_secondaryprogram_all_level`.`l7` then `v_secondaryprogram_all_level`.`n7` when `v_secondaryprogram_all_level`.`l8` then `v_secondaryprogram_all_level`.`n8` end) AS `name`,(case 2 when `v_secondaryprogram_all_level`.`l1` then `v_secondaryprogram_all_level`.`amp_program_id1` when `v_secondaryprogram_all_level`.`l2` then `v_secondaryprogram_all_level`.`amp_program_id2` when `v_secondaryprogram_all_level`.`l3` then `v_secondaryprogram_all_level`.`amp_program_id3` when `v_secondaryprogram_all_level`.`l4` then `v_secondaryprogram_all_level`.`amp_program_id4` when `v_secondaryprogram_all_level`.`l5` then `v_secondaryprogram_all_level`.`amp_program_id5` when `v_secondaryprogram_all_level`.`l6` then `v_secondaryprogram_all_level`.`amp_program_id6` when `v_secondaryprogram_all_level`.`l7` then `v_secondaryprogram_all_level`.`amp_program_id7` when `v_secondaryprogram_all_level`.`l8` then `v_secondaryprogram_all_level`.`amp_program_id8` end) AS `amp_program_id`,sum(`v_secondaryprogram_all_level`.`program_percentage`) AS `program_percentage` from `v_secondaryprogram_all_level` group by `v_secondaryprogram_all_level`.`amp_activity_id`,(case 2 when `v_secondaryprogram_all_level`.`l1` then `v_secondaryprogram_all_level`.`amp_program_id1` when `v_secondaryprogram_all_level`.`l2` then `v_secondaryprogram_all_level`.`amp_program_id2` when `v_secondaryprogram_all_level`.`l3` then `v_secondaryprogram_all_level`.`amp_program_id3` when `v_secondaryprogram_all_level`.`l4` then `v_secondaryprogram_all_level`.`amp_program_id4` when `v_secondaryprogram_all_level`.`l5` then `v_secondaryprogram_all_level`.`amp_program_id5` when `v_secondaryprogram_all_level`.`l6` then `v_secondaryprogram_all_level`.`amp_program_id6` when `v_secondaryprogram_all_level`.`l7` then `v_secondaryprogram_all_level`.`amp_program_id7` when `v_secondaryprogram_all_level`.`l8` then `v_secondaryprogram_all_level`.`amp_program_id8` end) having (`name` is not null);;
CREATE OR REPLACE VIEW v_secondaryprogram_level_3 AS /* ALGORITHM=UNDEFINED */ select `v_secondaryprogram_all_level`.`amp_activity_id` AS `amp_activity_id`,(case 3 when `v_secondaryprogram_all_level`.`l1` then `v_secondaryprogram_all_level`.`n1` when `v_secondaryprogram_all_level`.`l2` then `v_secondaryprogram_all_level`.`n2` when `v_secondaryprogram_all_level`.`l3` then `v_secondaryprogram_all_level`.`n3` when `v_secondaryprogram_all_level`.`l4` then `v_secondaryprogram_all_level`.`n4` when `v_secondaryprogram_all_level`.`l5` then `v_secondaryprogram_all_level`.`n5` when `v_secondaryprogram_all_level`.`l6` then `v_secondaryprogram_all_level`.`n6` when `v_secondaryprogram_all_level`.`l7` then `v_secondaryprogram_all_level`.`n7` when `v_secondaryprogram_all_level`.`l8` then `v_secondaryprogram_all_level`.`n8` end) AS `name`,(case 3 when `v_secondaryprogram_all_level`.`l1` then `v_secondaryprogram_all_level`.`amp_program_id1` when `v_secondaryprogram_all_level`.`l2` then `v_secondaryprogram_all_level`.`amp_program_id2` when `v_secondaryprogram_all_level`.`l3` then `v_secondaryprogram_all_level`.`amp_program_id3` when `v_secondaryprogram_all_level`.`l4` then `v_secondaryprogram_all_level`.`amp_program_id4` when `v_secondaryprogram_all_level`.`l5` then `v_secondaryprogram_all_level`.`amp_program_id5` when `v_secondaryprogram_all_level`.`l6` then `v_secondaryprogram_all_level`.`amp_program_id6` when `v_secondaryprogram_all_level`.`l7` then `v_secondaryprogram_all_level`.`amp_program_id7` when `v_secondaryprogram_all_level`.`l8` then `v_secondaryprogram_all_level`.`amp_program_id8` end) AS `amp_program_id`,sum(`v_secondaryprogram_all_level`.`program_percentage`) AS `program_percentage` from `v_secondaryprogram_all_level` group by `v_secondaryprogram_all_level`.`amp_activity_id`,(case 3 when `v_secondaryprogram_all_level`.`l1` then `v_secondaryprogram_all_level`.`amp_program_id1` when `v_secondaryprogram_all_level`.`l2` then `v_secondaryprogram_all_level`.`amp_program_id2` when `v_secondaryprogram_all_level`.`l3` then `v_secondaryprogram_all_level`.`amp_program_id3` when `v_secondaryprogram_all_level`.`l4` then `v_secondaryprogram_all_level`.`amp_program_id4` when `v_secondaryprogram_all_level`.`l5` then `v_secondaryprogram_all_level`.`amp_program_id5` when `v_secondaryprogram_all_level`.`l6` then `v_secondaryprogram_all_level`.`amp_program_id6` when `v_secondaryprogram_all_level`.`l7` then `v_secondaryprogram_all_level`.`amp_program_id7` when `v_secondaryprogram_all_level`.`l8` then `v_secondaryprogram_all_level`.`amp_program_id8` end) having (`name` is not null);;
CREATE OR REPLACE VIEW v_secondaryprogram_level_4 AS /* ALGORITHM=UNDEFINED */ select `v_secondaryprogram_all_level`.`amp_activity_id` AS `amp_activity_id`,(case 4 when `v_secondaryprogram_all_level`.`l1` then `v_secondaryprogram_all_level`.`n1` when `v_secondaryprogram_all_level`.`l2` then `v_secondaryprogram_all_level`.`n2` when `v_secondaryprogram_all_level`.`l3` then `v_secondaryprogram_all_level`.`n3` when `v_secondaryprogram_all_level`.`l4` then `v_secondaryprogram_all_level`.`n4` when `v_secondaryprogram_all_level`.`l5` then `v_secondaryprogram_all_level`.`n5` when `v_secondaryprogram_all_level`.`l6` then `v_secondaryprogram_all_level`.`n6` when `v_secondaryprogram_all_level`.`l7` then `v_secondaryprogram_all_level`.`n7` when `v_secondaryprogram_all_level`.`l8` then `v_secondaryprogram_all_level`.`n8` end) AS `name`,(case 4 when `v_secondaryprogram_all_level`.`l1` then `v_secondaryprogram_all_level`.`amp_program_id1` when `v_secondaryprogram_all_level`.`l2` then `v_secondaryprogram_all_level`.`amp_program_id2` when `v_secondaryprogram_all_level`.`l3` then `v_secondaryprogram_all_level`.`amp_program_id3` when `v_secondaryprogram_all_level`.`l4` then `v_secondaryprogram_all_level`.`amp_program_id4` when `v_secondaryprogram_all_level`.`l5` then `v_secondaryprogram_all_level`.`amp_program_id5` when `v_secondaryprogram_all_level`.`l6` then `v_secondaryprogram_all_level`.`amp_program_id6` when `v_secondaryprogram_all_level`.`l7` then `v_secondaryprogram_all_level`.`amp_program_id7` when `v_secondaryprogram_all_level`.`l8` then `v_secondaryprogram_all_level`.`amp_program_id8` end) AS `amp_program_id`,sum(`v_secondaryprogram_all_level`.`program_percentage`) AS `program_percentage` from `v_secondaryprogram_all_level` group by `v_secondaryprogram_all_level`.`amp_activity_id`,(case 4 when `v_secondaryprogram_all_level`.`l1` then `v_secondaryprogram_all_level`.`amp_program_id1` when `v_secondaryprogram_all_level`.`l2` then `v_secondaryprogram_all_level`.`amp_program_id2` when `v_secondaryprogram_all_level`.`l3` then `v_secondaryprogram_all_level`.`amp_program_id3` when `v_secondaryprogram_all_level`.`l4` then `v_secondaryprogram_all_level`.`amp_program_id4` when `v_secondaryprogram_all_level`.`l5` then `v_secondaryprogram_all_level`.`amp_program_id5` when `v_secondaryprogram_all_level`.`l6` then `v_secondaryprogram_all_level`.`amp_program_id6` when `v_secondaryprogram_all_level`.`l7` then `v_secondaryprogram_all_level`.`amp_program_id7` when `v_secondaryprogram_all_level`.`l8` then `v_secondaryprogram_all_level`.`amp_program_id8` end) having (`name` is not null);;
CREATE OR REPLACE VIEW v_secondaryprogram_level_5 AS /* ALGORITHM=UNDEFINED */ select `v_secondaryprogram_all_level`.`amp_activity_id` AS `amp_activity_id`,(case 5 when `v_secondaryprogram_all_level`.`l1` then `v_secondaryprogram_all_level`.`n1` when `v_secondaryprogram_all_level`.`l2` then `v_secondaryprogram_all_level`.`n2` when `v_secondaryprogram_all_level`.`l3` then `v_secondaryprogram_all_level`.`n3` when `v_secondaryprogram_all_level`.`l4` then `v_secondaryprogram_all_level`.`n4` when `v_secondaryprogram_all_level`.`l5` then `v_secondaryprogram_all_level`.`n5` when `v_secondaryprogram_all_level`.`l6` then `v_secondaryprogram_all_level`.`n6` when `v_secondaryprogram_all_level`.`l7` then `v_secondaryprogram_all_level`.`n7` when `v_secondaryprogram_all_level`.`l8` then `v_secondaryprogram_all_level`.`n8` end) AS `name`,(case 5 when `v_secondaryprogram_all_level`.`l1` then `v_secondaryprogram_all_level`.`amp_program_id1` when `v_secondaryprogram_all_level`.`l2` then `v_secondaryprogram_all_level`.`amp_program_id2` when `v_secondaryprogram_all_level`.`l3` then `v_secondaryprogram_all_level`.`amp_program_id3` when `v_secondaryprogram_all_level`.`l4` then `v_secondaryprogram_all_level`.`amp_program_id4` when `v_secondaryprogram_all_level`.`l5` then `v_secondaryprogram_all_level`.`amp_program_id5` when `v_secondaryprogram_all_level`.`l6` then `v_secondaryprogram_all_level`.`amp_program_id6` when `v_secondaryprogram_all_level`.`l7` then `v_secondaryprogram_all_level`.`amp_program_id7` when `v_secondaryprogram_all_level`.`l8` then `v_secondaryprogram_all_level`.`amp_program_id8` end) AS `amp_program_id`,sum(`v_secondaryprogram_all_level`.`program_percentage`) AS `program_percentage` from `v_secondaryprogram_all_level` group by `v_secondaryprogram_all_level`.`amp_activity_id`,(case 5 when `v_secondaryprogram_all_level`.`l1` then `v_secondaryprogram_all_level`.`amp_program_id1` when `v_secondaryprogram_all_level`.`l2` then `v_secondaryprogram_all_level`.`amp_program_id2` when `v_secondaryprogram_all_level`.`l3` then `v_secondaryprogram_all_level`.`amp_program_id3` when `v_secondaryprogram_all_level`.`l4` then `v_secondaryprogram_all_level`.`amp_program_id4` when `v_secondaryprogram_all_level`.`l5` then `v_secondaryprogram_all_level`.`amp_program_id5` when `v_secondaryprogram_all_level`.`l6` then `v_secondaryprogram_all_level`.`amp_program_id6` when `v_secondaryprogram_all_level`.`l7` then `v_secondaryprogram_all_level`.`amp_program_id7` when `v_secondaryprogram_all_level`.`l8` then `v_secondaryprogram_all_level`.`amp_program_id8` end) having (`name` is not null);;
CREATE OR REPLACE VIEW v_secondaryprogram_level_6 AS /* ALGORITHM=UNDEFINED */ select `v_secondaryprogram_all_level`.`amp_activity_id` AS `amp_activity_id`,(case 6 when `v_secondaryprogram_all_level`.`l1` then `v_secondaryprogram_all_level`.`n1` when `v_secondaryprogram_all_level`.`l2` then `v_secondaryprogram_all_level`.`n2` when `v_secondaryprogram_all_level`.`l3` then `v_secondaryprogram_all_level`.`n3` when `v_secondaryprogram_all_level`.`l4` then `v_secondaryprogram_all_level`.`n4` when `v_secondaryprogram_all_level`.`l5` then `v_secondaryprogram_all_level`.`n5` when `v_secondaryprogram_all_level`.`l6` then `v_secondaryprogram_all_level`.`n6` when `v_secondaryprogram_all_level`.`l7` then `v_secondaryprogram_all_level`.`n7` when `v_secondaryprogram_all_level`.`l8` then `v_secondaryprogram_all_level`.`n8` end) AS `name`,(case 6 when `v_secondaryprogram_all_level`.`l1` then `v_secondaryprogram_all_level`.`amp_program_id1` when `v_secondaryprogram_all_level`.`l2` then `v_secondaryprogram_all_level`.`amp_program_id2` when `v_secondaryprogram_all_level`.`l3` then `v_secondaryprogram_all_level`.`amp_program_id3` when `v_secondaryprogram_all_level`.`l4` then `v_secondaryprogram_all_level`.`amp_program_id4` when `v_secondaryprogram_all_level`.`l5` then `v_secondaryprogram_all_level`.`amp_program_id5` when `v_secondaryprogram_all_level`.`l6` then `v_secondaryprogram_all_level`.`amp_program_id6` when `v_secondaryprogram_all_level`.`l7` then `v_secondaryprogram_all_level`.`amp_program_id7` when `v_secondaryprogram_all_level`.`l8` then `v_secondaryprogram_all_level`.`amp_program_id8` end) AS `amp_program_id`,sum(`v_secondaryprogram_all_level`.`program_percentage`) AS `program_percentage` from `v_secondaryprogram_all_level` group by `v_secondaryprogram_all_level`.`amp_activity_id`,(case 6 when `v_secondaryprogram_all_level`.`l1` then `v_secondaryprogram_all_level`.`amp_program_id1` when `v_secondaryprogram_all_level`.`l2` then `v_secondaryprogram_all_level`.`amp_program_id2` when `v_secondaryprogram_all_level`.`l3` then `v_secondaryprogram_all_level`.`amp_program_id3` when `v_secondaryprogram_all_level`.`l4` then `v_secondaryprogram_all_level`.`amp_program_id4` when `v_secondaryprogram_all_level`.`l5` then `v_secondaryprogram_all_level`.`amp_program_id5` when `v_secondaryprogram_all_level`.`l6` then `v_secondaryprogram_all_level`.`amp_program_id6` when `v_secondaryprogram_all_level`.`l7` then `v_secondaryprogram_all_level`.`amp_program_id7` when `v_secondaryprogram_all_level`.`l8` then `v_secondaryprogram_all_level`.`amp_program_id8` end) having (`name` is not null);;
CREATE OR REPLACE VIEW v_secondaryprogram_level_7 AS /* ALGORITHM=UNDEFINED */ select `v_secondaryprogram_all_level`.`amp_activity_id` AS `amp_activity_id`,(case 7 when `v_secondaryprogram_all_level`.`l1` then `v_secondaryprogram_all_level`.`n1` when `v_secondaryprogram_all_level`.`l2` then `v_secondaryprogram_all_level`.`n2` when `v_secondaryprogram_all_level`.`l3` then `v_secondaryprogram_all_level`.`n3` when `v_secondaryprogram_all_level`.`l4` then `v_secondaryprogram_all_level`.`n4` when `v_secondaryprogram_all_level`.`l5` then `v_secondaryprogram_all_level`.`n5` when `v_secondaryprogram_all_level`.`l6` then `v_secondaryprogram_all_level`.`n6` when `v_secondaryprogram_all_level`.`l7` then `v_secondaryprogram_all_level`.`n7` when `v_secondaryprogram_all_level`.`l8` then `v_secondaryprogram_all_level`.`n8` end) AS `name`,(case 7 when `v_secondaryprogram_all_level`.`l1` then `v_secondaryprogram_all_level`.`amp_program_id1` when `v_secondaryprogram_all_level`.`l2` then `v_secondaryprogram_all_level`.`amp_program_id2` when `v_secondaryprogram_all_level`.`l3` then `v_secondaryprogram_all_level`.`amp_program_id3` when `v_secondaryprogram_all_level`.`l4` then `v_secondaryprogram_all_level`.`amp_program_id4` when `v_secondaryprogram_all_level`.`l5` then `v_secondaryprogram_all_level`.`amp_program_id5` when `v_secondaryprogram_all_level`.`l6` then `v_secondaryprogram_all_level`.`amp_program_id6` when `v_secondaryprogram_all_level`.`l7` then `v_secondaryprogram_all_level`.`amp_program_id7` when `v_secondaryprogram_all_level`.`l8` then `v_secondaryprogram_all_level`.`amp_program_id8` end) AS `amp_program_id`,sum(`v_secondaryprogram_all_level`.`program_percentage`) AS `program_percentage` from `v_secondaryprogram_all_level` group by `v_secondaryprogram_all_level`.`amp_activity_id`,(case 7 when `v_secondaryprogram_all_level`.`l1` then `v_secondaryprogram_all_level`.`amp_program_id1` when `v_secondaryprogram_all_level`.`l2` then `v_secondaryprogram_all_level`.`amp_program_id2` when `v_secondaryprogram_all_level`.`l3` then `v_secondaryprogram_all_level`.`amp_program_id3` when `v_secondaryprogram_all_level`.`l4` then `v_secondaryprogram_all_level`.`amp_program_id4` when `v_secondaryprogram_all_level`.`l5` then `v_secondaryprogram_all_level`.`amp_program_id5` when `v_secondaryprogram_all_level`.`l6` then `v_secondaryprogram_all_level`.`amp_program_id6` when `v_secondaryprogram_all_level`.`l7` then `v_secondaryprogram_all_level`.`amp_program_id7` when `v_secondaryprogram_all_level`.`l8` then `v_secondaryprogram_all_level`.`amp_program_id8` end) having (`name` is not null);;
CREATE OR REPLACE VIEW v_secondaryprogram_level_8 AS /* ALGORITHM=UNDEFINED */ select `v_secondaryprogram_all_level`.`amp_activity_id` AS `amp_activity_id`,(case 8 when `v_secondaryprogram_all_level`.`l1` then `v_secondaryprogram_all_level`.`n1` when `v_secondaryprogram_all_level`.`l2` then `v_secondaryprogram_all_level`.`n2` when `v_secondaryprogram_all_level`.`l3` then `v_secondaryprogram_all_level`.`n3` when `v_secondaryprogram_all_level`.`l4` then `v_secondaryprogram_all_level`.`n4` when `v_secondaryprogram_all_level`.`l5` then `v_secondaryprogram_all_level`.`n5` when `v_secondaryprogram_all_level`.`l6` then `v_secondaryprogram_all_level`.`n6` when `v_secondaryprogram_all_level`.`l7` then `v_secondaryprogram_all_level`.`n7` when `v_secondaryprogram_all_level`.`l8` then `v_secondaryprogram_all_level`.`n8` end) AS `name`,(case 8 when `v_secondaryprogram_all_level`.`l1` then `v_secondaryprogram_all_level`.`amp_program_id1` when `v_secondaryprogram_all_level`.`l2` then `v_secondaryprogram_all_level`.`amp_program_id2` when `v_secondaryprogram_all_level`.`l3` then `v_secondaryprogram_all_level`.`amp_program_id3` when `v_secondaryprogram_all_level`.`l4` then `v_secondaryprogram_all_level`.`amp_program_id4` when `v_secondaryprogram_all_level`.`l5` then `v_secondaryprogram_all_level`.`amp_program_id5` when `v_secondaryprogram_all_level`.`l6` then `v_secondaryprogram_all_level`.`amp_program_id6` when `v_secondaryprogram_all_level`.`l7` then `v_secondaryprogram_all_level`.`amp_program_id7` when `v_secondaryprogram_all_level`.`l8` then `v_secondaryprogram_all_level`.`amp_program_id8` end) AS `amp_program_id`,sum(`v_secondaryprogram_all_level`.`program_percentage`) AS `program_percentage` from `v_secondaryprogram_all_level` group by `v_secondaryprogram_all_level`.`amp_activity_id`,(case 8 when `v_secondaryprogram_all_level`.`l1` then `v_secondaryprogram_all_level`.`amp_program_id1` when `v_secondaryprogram_all_level`.`l2` then `v_secondaryprogram_all_level`.`amp_program_id2` when `v_secondaryprogram_all_level`.`l3` then `v_secondaryprogram_all_level`.`amp_program_id3` when `v_secondaryprogram_all_level`.`l4` then `v_secondaryprogram_all_level`.`amp_program_id4` when `v_secondaryprogram_all_level`.`l5` then `v_secondaryprogram_all_level`.`amp_program_id5` when `v_secondaryprogram_all_level`.`l6` then `v_secondaryprogram_all_level`.`amp_program_id6` when `v_secondaryprogram_all_level`.`l7` then `v_secondaryprogram_all_level`.`amp_program_id7` when `v_secondaryprogram_all_level`.`l8` then `v_secondaryprogram_all_level`.`amp_program_id8` end) having (`name` is not null);;
CREATE OR REPLACE VIEW v_sector_group AS /* ALGORITHM=UNDEFINED */ select `f`.`activity` AS `amp_activity_id`,`o`.`name` AS `name`,`f`.`organisation` AS `amp_org_id` from ((`amp_org_role` `f` join `amp_organisation` `o`) join `amp_role` `r` on(((`f`.`organisation` = `o`.`amp_org_id`) and (`f`.`role` = `r`.`amp_role_id`) and (`r`.`role_code` = _latin1'SG')))) order by `f`.`activity`,`o`.`name`;;
CREATE OR REPLACE VIEW v_sectors AS /* ALGORITHM=UNDEFINED */ select `sa`.`amp_activity_id` AS `amp_activity_id`,`getSectorName`(`getParentSectorId`(`s`.`amp_sector_id`)) AS `sectorname`,`getParentSectorId`(`s`.`amp_sector_id`) AS `amp_sector_id`,sum(`sa`.`sector_percentage`) AS `sector_percentage`,`s`.`amp_sec_scheme_id` AS `amp_sector_scheme_id`,`ss`.`sec_scheme_name` AS `sec_scheme_name` from (((`amp_sector_scheme` `ss` join `amp_classification_config` `cc` on(((`cc`.`name` = _latin1'Primary') and (`cc`.`classification_id` = `ss`.`amp_sec_scheme_id`)))) join `amp_sector` `s` on((`s`.`amp_sec_scheme_id` = `ss`.`amp_sec_scheme_id`))) join `amp_activity_sector` `sa` on(((`sa`.`amp_sector_id` = `s`.`amp_sector_id`) and (`sa`.`classification_config_id` = `cc`.`id`)))) group by `sa`.`amp_activity_id`,`getParentSectorId`(`s`.`amp_sector_id`) order by `sa`.`amp_activity_id`,`getSectorName`(`getParentSectorId`(`s`.`amp_sector_id`));;
CREATE OR REPLACE VIEW v_sectors_cached AS /* ALGORITHM=UNDEFINED */ select `sa`.`amp_activity_id` AS `amp_activity_id`,`getSectorName`(`getParentSectorId`(`s`.`amp_sector_id`)) AS `sectorname`,`getParentSectorId`(`s`.`amp_sector_id`) AS `amp_sector_id`,`s`.`amp_sec_scheme_id` AS `amp_sector_scheme_id`,`ss`.`sec_scheme_name` AS `sec_scheme_name`,`sa`.`sector_percentage` AS `sector_percentage`,((`fd`.`transaction_amount` * `sa`.`sector_percentage`) / 100) AS `transaction_amount`,`fd`.`transaction_type` AS `transaction_type`,`fd`.`adjustment_type` AS `adjustment_type`,`fd`.`transaction_date` AS `transaction_date`,`fd`.`fixed_exchange_rate` AS `fixed_exchange_rate`,`c`.`currency_code` AS `currency_code` from ((`amp_funding_detail` `fd` left join ((((`amp_sector_scheme` `ss` join `amp_classification_config` `cc` on((`cc`.`name` = _latin1'Primary'))) join `amp_sector` `s` on((`s`.`amp_sec_scheme_id` = `ss`.`amp_sec_scheme_id`))) join `amp_activity_sector` `sa` on((`sa`.`amp_sector_id` = `s`.`amp_sector_id`))) join `amp_funding` `f` on((`sa`.`amp_activity_id` = `f`.`amp_activity_id`))) on((`f`.`amp_funding_id` = `fd`.`amp_funding_id`))) join `amp_currency` `c` on((`fd`.`amp_currency_id` = `c`.`amp_currency_id`))) where ((`cc`.`classification_id` = `ss`.`amp_sec_scheme_id`) and (`sa`.`classification_config_id` = `cc`.`id`)) group by `sa`.`amp_activity_id`,`getParentSectorId`(`s`.`amp_sector_id`),`fd`.`transaction_type`,`fd`.`amp_fund_detail_id`,`f`.`amp_funding_id`,`fd`.`adjustment_type`,`s`.`sector_code` order by `sa`.`amp_activity_id`,`getSectorName`(`getParentSectorId`(`s`.`amp_sector_id`)),`fd`.`transaction_type`,`f`.`amp_funding_id`;;
CREATE OR REPLACE VIEW v_status AS /* ALGORITHM=UNDEFINED */ select `aac`.`amp_activity_id` AS `amp_activity_id`,`acv`.`category_value` AS `name`,`aac`.`amp_categoryvalue_id` AS `amp_status_id` from ((`amp_category_value` `acv` join `amp_category_class` `acc`) join `amp_activities_categoryvalues` `aac`) where ((`acv`.`id` = `aac`.`amp_categoryvalue_id`) and (`acc`.`id` = `acv`.`amp_category_class_id`) and (`acc`.`keyName` = _latin1'activity_status'));;
CREATE OR REPLACE VIEW v_sub_sectors AS /* ALGORITHM=UNDEFINED */ select `sa`.`amp_activity_id` AS `amp_activity_id`,`getSectorName`(`getParentSubSectorId`(`s`.`amp_sector_id`)) AS `sectorname`,`getParentSubSectorId`(`s`.`amp_sector_id`) AS `amp_sector_id`,sum(`sa`.`sector_percentage`) AS `sector_percentage`,`s`.`amp_sec_scheme_id` AS `amp_sec_scheme_id`,`ss`.`sec_scheme_name` AS `sec_scheme_name` from (((`amp_sector_scheme` `ss` join `amp_classification_config` `cc` on(((`cc`.`name` = _latin1'Primary') and (`cc`.`classification_id` = `ss`.`amp_sec_scheme_id`)))) join `amp_sector` `s` on(((`s`.`amp_sec_scheme_id` = `ss`.`amp_sec_scheme_id`) and (`getSectorDepth`(`s`.`amp_sector_id`) >= 1)))) join `amp_activity_sector` `sa` on(((`sa`.`amp_sector_id` = `s`.`amp_sector_id`) and (`sa`.`classification_config_id` = `cc`.`id`)))) group by `sa`.`amp_activity_id`,`getParentSubSectorId`(`s`.`amp_sector_id`) order by `sa`.`amp_activity_id`,`getSectorName`(`getParentSubSectorId`(`s`.`amp_sector_id`));;
CREATE OR REPLACE VIEW v_sub_sub_sectors AS /* ALGORITHM=UNDEFINED */ select `a`.`amp_activity_id` AS `amp_activity_id`,`s`.`name` AS `name`,`s`.`amp_sector_id` AS `amp_sector_id`,`a`.`sector_percentage` AS `sector_percentage` from (`amp_activity_sector` `a` join `amp_sector` `s`) where ((`a`.`amp_sector_id` = `s`.`amp_sector_id`) and (`getSectorDepth`(`s`.`amp_sector_id`) = 2) and `s`.`amp_sec_scheme_id` in (select `c`.`classification_id` AS `classification_id` from `amp_classification_config` `c` where (`c`.`name` = _latin1'Primary'))) order by `a`.`amp_activity_id`,`s`.`name`;;
CREATE OR REPLACE VIEW v_teams AS /* ALGORITHM=UNDEFINED */ select `a`.`amp_activity_id` AS `amp_activity_id`,`t`.`name` AS `name`,`t`.`amp_team_id` AS `amp_team_id` from (`amp_activity` `a` join `amp_team` `t`) where (`a`.`amp_team_id` = `t`.`amp_team_id`) order by `a`.`amp_activity_id`,`t`.`amp_team_id`;;
CREATE OR REPLACE VIEW v_terms_assist AS /* ALGORITHM=UNDEFINED */ select `a`.`amp_activity_id` AS `amp_activity_id`,`val`.`category_value` AS `terms_assist_name`,`val`.`id` AS `terms_assist_code` from ((`amp_activity` `a` join `amp_funding` `fund`) join `amp_category_value` `val`) where ((`fund`.`amp_activity_id` = `a`.`amp_activity_id`) and (`val`.`id` = `fund`.`type_of_assistance_category_va`)) group by `a`.`amp_activity_id`,`val`.`id` order by `a`.`amp_activity_id`,`val`.`category_value`;;
CREATE OR REPLACE VIEW v_titles AS /* ALGORITHM=UNDEFINED */ select `amp_activity`.`amp_activity_id` AS `amp_activity_id`,`amp_activity`.`name` AS `name`,`amp_activity`.`amp_activity_id` AS `title_id`,`amp_activity`.`draft` AS `draft`,`amp_activity`.`approval_status` AS `status` from `amp_activity` order by `amp_activity`.`amp_activity_id`;;
CREATE OR REPLACE VIEW v_updated_date AS /* ALGORITHM=UNDEFINED */ select `a`.`amp_activity_id` AS `amp_activity_id`,`a`.`date_updated` AS `date_updated` from `amp_activity` `a` order by `a`.`amp_activity_id`;;

