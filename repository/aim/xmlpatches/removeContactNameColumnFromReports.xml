<?xml version="1.0" encoding="UTF-8"?>
<tns:patch closeOnSuccess="true" retryOnFail="true"
	xmlns:tns="http://docs.ampdev.net/schemas/xmlpatcher" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://docs.ampdev.net/schemas/xmlpatcher ../doc/xmlpatcher.xsd ">
	
	<jira>AMP-7624</jira>
	<author>dare</author>
	<description>
		drop contact name column from reports and v_contact_name view
	</description>
	
	<apply>
		<script>			
			<lang type="mysql" delimiter=";">
				drop temporary table if exists tmp_rep_cont;

				create temporary table if not exists tmp_rep_cont (
					select columnName, columnId  from amp_columns where columnName like 'Contact Name'
				);

				delete from amp_report_column where columnId in (select columnId from tmp_rep_cont);
				delete from amp_report_hierarchy where columnId in (select columnId from tmp_rep_cont);
				delete from amp_columns where columnId in (select columnId from tmp_rep_cont);

				drop view if exists v_contact_name;
			</lang>
		</script>
	</apply>
</tns:patch> 