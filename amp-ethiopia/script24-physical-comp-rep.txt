delete from amp_physical_component_report;

insert into amp_physical_component_report
select distinct '',amp_activity.amp_activity_id,amp_activity.name 'activity_name',amp_organisation.amp_org_id 'amp_donor_id',amp_organisation.name 'donor_name',amp_components.amp_component_id 'amp_component_id',amp_components.title 'component_name',amp_components.description 'objective',
signature_date,amp_activity.actual_start_date,amp_activity.actual_completion_date,
case when (transaction_type=0 and adjustment_type=1) then transaction_amount else 0 end 'actual_commitment',
case when (transaction_type=0 and adjustment_type=1) then currency_code else null end 'comm_currency_code', amount 'actual_expenditure',currency_code 'exp_currency_code',amp_physical_performance.title 'status',amp_physical_performance.reporting_date,
case when (mofed_cnt_first_name is not null or mofed_cnt_last_name is not null) then concat_ws(' ',mofed_cnt_first_name,mofed_cnt_last_name) else null end 'mofed_contact',
case when (cont_first_name is not null or cont_last_name is not null) then concat_ws(' ',cont_first_name,cont_last_name) else null end 'donor_contact',
amp_team_id,transaction_date,extract(YEAR from transaction_date) 'fiscal_year',
amp_status_id,amp_funding.amp_modality_id from amp_components,amp_physical_performance,amp_activity,amp_funding,amp_funding_detail,amp_organisation,amp_currency
where amp_components.amp_component_id=amp_physical_performance.amp_component_id
and amp_components.amp_activity_id=amp_activity.amp_activity_id
and amp_activity.amp_activity_id=amp_funding.amp_activity_id
and amp_funding.amp_donor_org_id=amp_organisation.amp_org_id
and amp_funding.amp_funding_id=amp_funding_detail.amp_funding_id
and amp_funding_detail.amp_currency_id=amp_currency.amp_currency_id
and amp_components.currency_id=amp_currency.amp_currency_id
and org_role_code='MA'
order by amp_organisation.amp_org_id,amp_activity.amp_activity_id,amp_components.amp_component_id,amp_physical_performance.reporting_date;






<%Session.setMaxInactiveInterval(300)%>