SELECT COALESCE(CONCAT('DROP TABLE IF EXISTS ',kcu.referenced_table_name,'_temporary; CREATE TEMPORARY TABLE ',kcu.referenced_table_name,'_temporary AS (SELECT * FROM ',kcu.referenced_table_name,'); DELETE FROM ',kcu.table_name,'  WHERE ',kcu.column_name,' IS NOT NULL AND ',kcu.column_name,' NOT IN (SELECT ref.',kcu.referenced_column_name,' FROM ',kcu.referenced_table_name,'_temporary ref);'),'') AS '' FROM information_schema.key_column_usage kcu WHERE kcu.table_schema=DATABASE() and kcu.constraint_name != 'PRIMARY';