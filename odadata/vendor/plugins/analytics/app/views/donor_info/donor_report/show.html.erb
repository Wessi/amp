<style>
  TABLE.donor_report
  {
    padding:0px 0px 0px 0px;
  }
  TH
  {
    border: 1px groove #cecece;
    background-color:#e0e0e0;
    text-align:center;
    padding:0px 10px 0px 10px;
    
  }
</style>
<div style="overflow:auto;width:880px;border:1px solid #cecece;">

<table class="donor_report" cellspacing="0" cellpadding="0">
  <tr>
    <th style="border-bottom:0px;">
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    </th>
<% (Project::FIRST_YEAR_OF_RELEVANCE_DONOR_REPORT..Time.now.year+4).to_a.map do |y| %>
    <th colspan="2"><%= y %></th>
<% end %>
  </tr>
  <tr>
    <th style="border-top:0px;">&nbsp;</th>
<% (Project::FIRST_YEAR_OF_RELEVANCE_DONOR_REPORT..Time.now.year+4).to_a.map do |y| %>
    <th style="font-size:10px;">Committed</th>
    <th style="font-size:10px;">Disbursed</th>
<% end %>
  </tr>
<% AidModality.all.group_by(&:group_name).each do | toagroup |%>
  <%
  if toagroup[0].nil?
  
    toagroup[1].each do |am|
    %>
  <tr>
    <td style="background-color:#e0e0e0;border-bottom:1px groove #cecece;border-right:1px groove #cecece;border-left:1px groove #cecece;font-size:10px;">
      <strong><%= am.name %></strong>
    </td>
      <% (Project::FIRST_YEAR_OF_RELEVANCE_DONOR_REPORT..Time.now.year+4).to_a.map do |y| %>
          <td align="center" style="border-bottom:1px solid #cecece;border-right:1px solid #cecece;"><%= @donor.commitments_by_aid_modality(y)[am.id] %></td>
          <td align="center" style="border-bottom:1px solid #cecece;border-right:1px solid black;"><%= @donor.payments_by_aid_modality(y)[am.id] %></td>
      <% end %>
    <% end %>
  </tr>
  <%
  else #Group Name
  %>
  <tr>
    <td style="background-color:#e0e0e0;border-bottom:1px groove #cecece;border-right:1px groove #cecece;border-left:1px groove #cecece;font-size:10px;">
      <strong><%= toagroup[0] %></strong>
    </td>
      <% (Project::FIRST_YEAR_OF_RELEVANCE_DONOR_REPORT..Time.now.year+4).to_a.map do |y| %>
          <td align="center" style="border-bottom:1px solid #cecece;border-right:1px solid #cecece;"></td>
          <td align="center" style="border-bottom:1px solid #cecece;border-right:1px solid black;"></td>
      <% end %>
  </tr>
  <%
    toagroup[1].each do |am|
    %>
  <tr>
    <td style="padding-left:20px;background-color:#e0e0e0;border-bottom:1px groove #cecece;border-right:1px groove #cecece;border-left:1px groove #cecece;font-size:10px;">
      <%= am.name %>
    </td>
      <% (Project::FIRST_YEAR_OF_RELEVANCE_DONOR_REPORT..Time.now.year+4).to_a.map do |y| %>
          <td align="center" style="border-bottom:1px solid #cecece;border-right:1px solid #cecece;"><%= @donor.commitments_by_aid_modality(y)[am.id] %></td>
          <td align="center" style="border-bottom:1px solid #cecece;border-right:1px solid black;"><%= @donor.payments_by_aid_modality(y)[am.id] %></td>
      <% end %>
    <% end %>
  </tr>
  <%
  end
  %>
<% end %>
<!--  <tr>
    <td>All Aid Modalities</td>
  <% (Project::FIRST_YEAR_OF_RELEVANCE_DONOR_REPORT..Time.now.year+4).to_a.map do |y| %>
      <td><%= y %></td>
  <% end %>
  </tr>-->
</table>
  </div>
