<?xml version="1.0" encoding="UTF-8"?>
<tns:patch closeOnSuccess="true" retryOnFail="false" xmlns:tns="http://docs.ampdev.net/schemas/xmlpatcher" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://docs.ampdev.net/schemas/xmlpatcher ../doc/xmlpatcher.xsd ">
  <jira>AMP-7603</jira>
  <keyword>NGO</keyword>
  <keyword>Budget</keyword>
  <author>Medea Gugushvili</author>
  <description>description</description>

  <trigger type="all">
      <condition type="custom">
          <script returnVar="y">
              <lang type="sql">SELECT count(*) from amp_category_class where keyName='ngo_budget_type'</lang>
          </script>
          <test>y.intValue()==0</test>
      </condition>
  </trigger>

  <apply>
    <script>
    <lang delimiter=";" type="mysql">
        INSERT INTO `amp_category_class`(category_name,is_ordered,keyName,is_multiselect) VALUES ('NGO Budget Type', false, 'ngo_budget_type',false);
        SET @classId=(select id FROM `amp_category_class` where keyName='ngo_budget_type');
		INSERT INTO `amp_category_value` (`category_value`,`amp_category_class_id`,index_column)
        SELECT 'Annual budget of internal/administrative functioning',@classId,0 FROM DUAL
        UNION
        SELECT 'Total Amount',@classId,1 FROM DUAL
        UNION
        SELECT 'Organization personal resources',@classId,2 FROM DUAL
        UNION
        SELECT 'Donors resources',@classId,3 FROM DUAL;
	</lang>
    </script>
  </apply>

</tns:patch>
