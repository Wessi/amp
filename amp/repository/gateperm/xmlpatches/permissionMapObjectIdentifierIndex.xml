<?xml version="1.0" encoding="UTF-8"?>
<tns:patch closeOnSuccess="true" retryOnFail="true"
	xmlns:tns="http://docs.ampdev.net/schemas/xmlpatcher" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://docs.ampdev.net/schemas/xmlpatcher ../doc/xmlpatcher.xsd ">

	<jira>AMP-6037</jira>
	<keyword>permission</keyword>
	<keyword>feature manager</keyword>
	<keyword>FM</keyword>
	<keyword>map</keyword>
	<author>mpostelnicu</author>
	<description>This creates a MySQL table index to speed to search in perm_map table for object identifiers.
	This patch will run ONLY if the index does not exist AND if the other patch related to this ticket has already been applied.
	</description>
	
	<trigger type="all">
		<condition type="appliedPatch">permissionMapForNonLongIdentifiers.xml</condition>
		<condition type="indexExists" inverted="true">perm_map_object_identifier_idx</condition>
	</trigger>
	
	<apply>
		<script>
			<lang type="mysql">
				 CREATE INDEX perm_map_object_identifier_idx ON perm_map(object_identifier);
			</lang>
		</script>
	</apply>

</tns:patch>