<?xml version="1.0" encoding="UTF-8"?>
<tns:patch closeOnSuccess="true" retryOnFail="true" xmlns:tns="http://docs.ampdev.net/schemas/xmlpatcher" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://docs.ampdev.net/schemas/xmlpatcher ../doc/xmlpatcher.xsd ">
  <jira>AMP-14060</jira>
  <keyword>programs</keyword>
  <author>Alex</author>
  <description>Program views need to sum up percentages from subprograms</description>
  <deprecate>AMP-13539-primary_progs.xml</deprecate>
  <apply>
    <script>
      <lang delimiter=";" type="postgres">
      		drop view v_primaryprogram_level_0;
			drop view v_primaryprogram_level_1;
			drop view v_primaryprogram_level_2;
			drop view v_primaryprogram_level_3;
			drop view v_primaryprogram_level_4;
			drop view v_primaryprogram_level_5;
			drop view v_primaryprogram_level_6;
			drop view v_primaryprogram_level_7;
			drop view v_primaryprogram_level_8;			
			DROP VIEW v_primaryprogram_all_level;		
			
			CREATE OR REPLACE VIEW v_primaryprogram_all_level AS 
 SELECT a.amp_activity_id, a.program_percentage, a.amp_program_id AS amp_program_id1, b.name AS n1, b.level_ AS l1, b1.name AS n2, b1.level_ AS l2, b2.name AS n3, b2.level_ AS l3, b3.name AS n4, b3.level_ AS l4, b4.name AS n5, b4.level_ AS l5, b5.name AS n6, b5.level_ AS l6, b6.name AS n7, b6.level_ AS l7, b7.name AS n8, b7.level_ AS l8, b1.amp_theme_id AS amp_program_id2, b2.amp_theme_id AS amp_program_id3, b3.amp_theme_id AS amp_program_id4, b4.amp_theme_id AS amp_program_id5, b5.amp_theme_id AS amp_program_id6, b6.amp_theme_id AS amp_program_id7, b7.amp_theme_id AS amp_program_id8
   FROM amp_activity_program a
   JOIN amp_theme b ON a.amp_program_id = b.amp_theme_id
   LEFT JOIN amp_theme b1 ON b1.amp_theme_id = b.parent_theme_id
   LEFT JOIN amp_theme b2 ON b2.amp_theme_id = b1.parent_theme_id
   LEFT JOIN amp_theme b3 ON b3.amp_theme_id = b2.parent_theme_id
   LEFT JOIN amp_theme b4 ON b4.amp_theme_id = b3.parent_theme_id
   LEFT JOIN amp_theme b5 ON b5.amp_theme_id = b4.parent_theme_id
   LEFT JOIN amp_theme b6 ON b6.amp_theme_id = b5.parent_theme_id
   LEFT JOIN amp_theme b7 ON b7.amp_theme_id = b6.parent_theme_id
  WHERE getprogramsettingid(a.amp_program_id) = 2;
  
  
CREATE OR REPLACE VIEW v_primaryprogram_level_0 AS 
 SELECT v_primaryprogram_all_level.amp_activity_id, 
        CASE 0
            WHEN v_primaryprogram_all_level.l1 THEN v_primaryprogram_all_level.n1
            WHEN v_primaryprogram_all_level.l2 THEN v_primaryprogram_all_level.n2
            WHEN v_primaryprogram_all_level.l3 THEN v_primaryprogram_all_level.n3
            WHEN v_primaryprogram_all_level.l4 THEN v_primaryprogram_all_level.n4
            WHEN v_primaryprogram_all_level.l5 THEN v_primaryprogram_all_level.n5
            WHEN v_primaryprogram_all_level.l6 THEN v_primaryprogram_all_level.n6
            WHEN v_primaryprogram_all_level.l7 THEN v_primaryprogram_all_level.n7
            WHEN v_primaryprogram_all_level.l8 THEN v_primaryprogram_all_level.n8
            ELSE NULL::character varying
        END AS name, 
        CASE 0
            WHEN v_primaryprogram_all_level.l1 THEN v_primaryprogram_all_level.amp_program_id1
            WHEN v_primaryprogram_all_level.l2 THEN v_primaryprogram_all_level.amp_program_id2
            WHEN v_primaryprogram_all_level.l3 THEN v_primaryprogram_all_level.amp_program_id3
            WHEN v_primaryprogram_all_level.l4 THEN v_primaryprogram_all_level.amp_program_id4
            WHEN v_primaryprogram_all_level.l5 THEN v_primaryprogram_all_level.amp_program_id5
            WHEN v_primaryprogram_all_level.l6 THEN v_primaryprogram_all_level.amp_program_id6
            WHEN v_primaryprogram_all_level.l7 THEN v_primaryprogram_all_level.amp_program_id7
            WHEN v_primaryprogram_all_level.l8 THEN v_primaryprogram_all_level.amp_program_id8
            ELSE NULL::bigint
        END AS amp_program_id, sum(v_primaryprogram_all_level.program_percentage) AS program_percentage
   FROM v_primaryprogram_all_level
  WHERE (
  		CASE 0
            WHEN v_primaryprogram_all_level.l1 THEN v_primaryprogram_all_level.n1
            WHEN v_primaryprogram_all_level.l2 THEN v_primaryprogram_all_level.n2
            WHEN v_primaryprogram_all_level.l3 THEN v_primaryprogram_all_level.n3
            WHEN v_primaryprogram_all_level.l4 THEN v_primaryprogram_all_level.n4
            WHEN v_primaryprogram_all_level.l5 THEN v_primaryprogram_all_level.n5
            WHEN v_primaryprogram_all_level.l6 THEN v_primaryprogram_all_level.n6
            WHEN v_primaryprogram_all_level.l7 THEN v_primaryprogram_all_level.n7
            WHEN v_primaryprogram_all_level.l8 THEN v_primaryprogram_all_level.n8
            ELSE NULL::character varying
        END
  ) is not null 
  GROUP BY v_primaryprogram_all_level.amp_activity_id, 
        CASE 0
            WHEN v_primaryprogram_all_level.l1 THEN v_primaryprogram_all_level.n1
            WHEN v_primaryprogram_all_level.l2 THEN v_primaryprogram_all_level.n2
            WHEN v_primaryprogram_all_level.l3 THEN v_primaryprogram_all_level.n3
            WHEN v_primaryprogram_all_level.l4 THEN v_primaryprogram_all_level.n4
            WHEN v_primaryprogram_all_level.l5 THEN v_primaryprogram_all_level.n5
            WHEN v_primaryprogram_all_level.l6 THEN v_primaryprogram_all_level.n6
            WHEN v_primaryprogram_all_level.l7 THEN v_primaryprogram_all_level.n7
            WHEN v_primaryprogram_all_level.l8 THEN v_primaryprogram_all_level.n8
            ELSE NULL::character varying
        END, 
        CASE 0
            WHEN v_primaryprogram_all_level.l1 THEN v_primaryprogram_all_level.amp_program_id1
            WHEN v_primaryprogram_all_level.l2 THEN v_primaryprogram_all_level.amp_program_id2
            WHEN v_primaryprogram_all_level.l3 THEN v_primaryprogram_all_level.amp_program_id3
            WHEN v_primaryprogram_all_level.l4 THEN v_primaryprogram_all_level.amp_program_id4
            WHEN v_primaryprogram_all_level.l5 THEN v_primaryprogram_all_level.amp_program_id5
            WHEN v_primaryprogram_all_level.l6 THEN v_primaryprogram_all_level.amp_program_id6
            WHEN v_primaryprogram_all_level.l7 THEN v_primaryprogram_all_level.amp_program_id7
            WHEN v_primaryprogram_all_level.l8 THEN v_primaryprogram_all_level.amp_program_id8
            ELSE NULL::bigint
        END;
        
        
        
CREATE OR REPLACE VIEW v_primaryprogram_level_1 AS 
 SELECT v_primaryprogram_all_level.amp_activity_id, 
        CASE 1
            WHEN v_primaryprogram_all_level.l1 THEN v_primaryprogram_all_level.n1
            WHEN v_primaryprogram_all_level.l2 THEN v_primaryprogram_all_level.n2
            WHEN v_primaryprogram_all_level.l3 THEN v_primaryprogram_all_level.n3
            WHEN v_primaryprogram_all_level.l4 THEN v_primaryprogram_all_level.n4
            WHEN v_primaryprogram_all_level.l5 THEN v_primaryprogram_all_level.n5
            WHEN v_primaryprogram_all_level.l6 THEN v_primaryprogram_all_level.n6
            WHEN v_primaryprogram_all_level.l7 THEN v_primaryprogram_all_level.n7
            WHEN v_primaryprogram_all_level.l8 THEN v_primaryprogram_all_level.n8
            ELSE NULL::character varying
        END AS name, 
        CASE 1
            WHEN v_primaryprogram_all_level.l1 THEN v_primaryprogram_all_level.amp_program_id1
            WHEN v_primaryprogram_all_level.l2 THEN v_primaryprogram_all_level.amp_program_id2
            WHEN v_primaryprogram_all_level.l3 THEN v_primaryprogram_all_level.amp_program_id3
            WHEN v_primaryprogram_all_level.l4 THEN v_primaryprogram_all_level.amp_program_id4
            WHEN v_primaryprogram_all_level.l5 THEN v_primaryprogram_all_level.amp_program_id5
            WHEN v_primaryprogram_all_level.l6 THEN v_primaryprogram_all_level.amp_program_id6
            WHEN v_primaryprogram_all_level.l7 THEN v_primaryprogram_all_level.amp_program_id7
            WHEN v_primaryprogram_all_level.l8 THEN v_primaryprogram_all_level.amp_program_id8
            ELSE NULL::bigint
        END AS amp_program_id, sum(v_primaryprogram_all_level.program_percentage) AS program_percentage
   FROM v_primaryprogram_all_level
  WHERE (
  		CASE 1
            WHEN v_primaryprogram_all_level.l1 THEN v_primaryprogram_all_level.n1
            WHEN v_primaryprogram_all_level.l2 THEN v_primaryprogram_all_level.n2
            WHEN v_primaryprogram_all_level.l3 THEN v_primaryprogram_all_level.n3
            WHEN v_primaryprogram_all_level.l4 THEN v_primaryprogram_all_level.n4
            WHEN v_primaryprogram_all_level.l5 THEN v_primaryprogram_all_level.n5
            WHEN v_primaryprogram_all_level.l6 THEN v_primaryprogram_all_level.n6
            WHEN v_primaryprogram_all_level.l7 THEN v_primaryprogram_all_level.n7
            WHEN v_primaryprogram_all_level.l8 THEN v_primaryprogram_all_level.n8
            ELSE NULL::character varying
        END
  ) is not null 
  GROUP BY v_primaryprogram_all_level.amp_activity_id, 
        CASE 1
            WHEN v_primaryprogram_all_level.l1 THEN v_primaryprogram_all_level.n1
            WHEN v_primaryprogram_all_level.l2 THEN v_primaryprogram_all_level.n2
            WHEN v_primaryprogram_all_level.l3 THEN v_primaryprogram_all_level.n3
            WHEN v_primaryprogram_all_level.l4 THEN v_primaryprogram_all_level.n4
            WHEN v_primaryprogram_all_level.l5 THEN v_primaryprogram_all_level.n5
            WHEN v_primaryprogram_all_level.l6 THEN v_primaryprogram_all_level.n6
            WHEN v_primaryprogram_all_level.l7 THEN v_primaryprogram_all_level.n7
            WHEN v_primaryprogram_all_level.l8 THEN v_primaryprogram_all_level.n8
            ELSE NULL::character varying
        END, 
        CASE 1
            WHEN v_primaryprogram_all_level.l1 THEN v_primaryprogram_all_level.amp_program_id1
            WHEN v_primaryprogram_all_level.l2 THEN v_primaryprogram_all_level.amp_program_id2
            WHEN v_primaryprogram_all_level.l3 THEN v_primaryprogram_all_level.amp_program_id3
            WHEN v_primaryprogram_all_level.l4 THEN v_primaryprogram_all_level.amp_program_id4
            WHEN v_primaryprogram_all_level.l5 THEN v_primaryprogram_all_level.amp_program_id5
            WHEN v_primaryprogram_all_level.l6 THEN v_primaryprogram_all_level.amp_program_id6
            WHEN v_primaryprogram_all_level.l7 THEN v_primaryprogram_all_level.amp_program_id7
            WHEN v_primaryprogram_all_level.l8 THEN v_primaryprogram_all_level.amp_program_id8
            ELSE NULL::bigint
        END;
        
        
CREATE OR REPLACE VIEW v_primaryprogram_level_2 AS 
 SELECT v_primaryprogram_all_level.amp_activity_id, 
        CASE 2
            WHEN v_primaryprogram_all_level.l1 THEN v_primaryprogram_all_level.n1
            WHEN v_primaryprogram_all_level.l2 THEN v_primaryprogram_all_level.n2
            WHEN v_primaryprogram_all_level.l3 THEN v_primaryprogram_all_level.n3
            WHEN v_primaryprogram_all_level.l4 THEN v_primaryprogram_all_level.n4
            WHEN v_primaryprogram_all_level.l5 THEN v_primaryprogram_all_level.n5
            WHEN v_primaryprogram_all_level.l6 THEN v_primaryprogram_all_level.n6
            WHEN v_primaryprogram_all_level.l7 THEN v_primaryprogram_all_level.n7
            WHEN v_primaryprogram_all_level.l8 THEN v_primaryprogram_all_level.n8
            ELSE NULL::character varying
        END AS name, 
        CASE 2
            WHEN v_primaryprogram_all_level.l1 THEN v_primaryprogram_all_level.amp_program_id1
            WHEN v_primaryprogram_all_level.l2 THEN v_primaryprogram_all_level.amp_program_id2
            WHEN v_primaryprogram_all_level.l3 THEN v_primaryprogram_all_level.amp_program_id3
            WHEN v_primaryprogram_all_level.l4 THEN v_primaryprogram_all_level.amp_program_id4
            WHEN v_primaryprogram_all_level.l5 THEN v_primaryprogram_all_level.amp_program_id5
            WHEN v_primaryprogram_all_level.l6 THEN v_primaryprogram_all_level.amp_program_id6
            WHEN v_primaryprogram_all_level.l7 THEN v_primaryprogram_all_level.amp_program_id7
            WHEN v_primaryprogram_all_level.l8 THEN v_primaryprogram_all_level.amp_program_id8
            ELSE NULL::bigint
        END AS amp_program_id, sum(v_primaryprogram_all_level.program_percentage) AS program_percentage
   FROM v_primaryprogram_all_level
  WHERE (
  		CASE 2
            WHEN v_primaryprogram_all_level.l1 THEN v_primaryprogram_all_level.n1
            WHEN v_primaryprogram_all_level.l2 THEN v_primaryprogram_all_level.n2
            WHEN v_primaryprogram_all_level.l3 THEN v_primaryprogram_all_level.n3
            WHEN v_primaryprogram_all_level.l4 THEN v_primaryprogram_all_level.n4
            WHEN v_primaryprogram_all_level.l5 THEN v_primaryprogram_all_level.n5
            WHEN v_primaryprogram_all_level.l6 THEN v_primaryprogram_all_level.n6
            WHEN v_primaryprogram_all_level.l7 THEN v_primaryprogram_all_level.n7
            WHEN v_primaryprogram_all_level.l8 THEN v_primaryprogram_all_level.n8
            ELSE NULL::character varying
        END
  ) is not null 
  GROUP BY v_primaryprogram_all_level.amp_activity_id, 
        CASE 2
            WHEN v_primaryprogram_all_level.l1 THEN v_primaryprogram_all_level.n1
            WHEN v_primaryprogram_all_level.l2 THEN v_primaryprogram_all_level.n2
            WHEN v_primaryprogram_all_level.l3 THEN v_primaryprogram_all_level.n3
            WHEN v_primaryprogram_all_level.l4 THEN v_primaryprogram_all_level.n4
            WHEN v_primaryprogram_all_level.l5 THEN v_primaryprogram_all_level.n5
            WHEN v_primaryprogram_all_level.l6 THEN v_primaryprogram_all_level.n6
            WHEN v_primaryprogram_all_level.l7 THEN v_primaryprogram_all_level.n7
            WHEN v_primaryprogram_all_level.l8 THEN v_primaryprogram_all_level.n8
            ELSE NULL::character varying
        END, 
        CASE 2
            WHEN v_primaryprogram_all_level.l1 THEN v_primaryprogram_all_level.amp_program_id1
            WHEN v_primaryprogram_all_level.l2 THEN v_primaryprogram_all_level.amp_program_id2
            WHEN v_primaryprogram_all_level.l3 THEN v_primaryprogram_all_level.amp_program_id3
            WHEN v_primaryprogram_all_level.l4 THEN v_primaryprogram_all_level.amp_program_id4
            WHEN v_primaryprogram_all_level.l5 THEN v_primaryprogram_all_level.amp_program_id5
            WHEN v_primaryprogram_all_level.l6 THEN v_primaryprogram_all_level.amp_program_id6
            WHEN v_primaryprogram_all_level.l7 THEN v_primaryprogram_all_level.amp_program_id7
            WHEN v_primaryprogram_all_level.l8 THEN v_primaryprogram_all_level.amp_program_id8
            ELSE NULL::bigint
        END;
        
       
CREATE OR REPLACE VIEW v_primaryprogram_level_3 AS 
 SELECT v_primaryprogram_all_level.amp_activity_id, 
        CASE 3
            WHEN v_primaryprogram_all_level.l1 THEN v_primaryprogram_all_level.n1
            WHEN v_primaryprogram_all_level.l2 THEN v_primaryprogram_all_level.n2
            WHEN v_primaryprogram_all_level.l3 THEN v_primaryprogram_all_level.n3
            WHEN v_primaryprogram_all_level.l4 THEN v_primaryprogram_all_level.n4
            WHEN v_primaryprogram_all_level.l5 THEN v_primaryprogram_all_level.n5
            WHEN v_primaryprogram_all_level.l6 THEN v_primaryprogram_all_level.n6
            WHEN v_primaryprogram_all_level.l7 THEN v_primaryprogram_all_level.n7
            WHEN v_primaryprogram_all_level.l8 THEN v_primaryprogram_all_level.n8
            ELSE NULL::character varying
        END AS name, 
        CASE 3
            WHEN v_primaryprogram_all_level.l1 THEN v_primaryprogram_all_level.amp_program_id1
            WHEN v_primaryprogram_all_level.l2 THEN v_primaryprogram_all_level.amp_program_id2
            WHEN v_primaryprogram_all_level.l3 THEN v_primaryprogram_all_level.amp_program_id3
            WHEN v_primaryprogram_all_level.l4 THEN v_primaryprogram_all_level.amp_program_id4
            WHEN v_primaryprogram_all_level.l5 THEN v_primaryprogram_all_level.amp_program_id5
            WHEN v_primaryprogram_all_level.l6 THEN v_primaryprogram_all_level.amp_program_id6
            WHEN v_primaryprogram_all_level.l7 THEN v_primaryprogram_all_level.amp_program_id7
            WHEN v_primaryprogram_all_level.l8 THEN v_primaryprogram_all_level.amp_program_id8
            ELSE NULL::bigint
        END AS amp_program_id, sum(v_primaryprogram_all_level.program_percentage) AS program_percentage
   FROM v_primaryprogram_all_level
  WHERE (
  		CASE 3
            WHEN v_primaryprogram_all_level.l1 THEN v_primaryprogram_all_level.n1
            WHEN v_primaryprogram_all_level.l2 THEN v_primaryprogram_all_level.n2
            WHEN v_primaryprogram_all_level.l3 THEN v_primaryprogram_all_level.n3
            WHEN v_primaryprogram_all_level.l4 THEN v_primaryprogram_all_level.n4
            WHEN v_primaryprogram_all_level.l5 THEN v_primaryprogram_all_level.n5
            WHEN v_primaryprogram_all_level.l6 THEN v_primaryprogram_all_level.n6
            WHEN v_primaryprogram_all_level.l7 THEN v_primaryprogram_all_level.n7
            WHEN v_primaryprogram_all_level.l8 THEN v_primaryprogram_all_level.n8
            ELSE NULL::character varying
        END
  ) is not null 
  GROUP BY v_primaryprogram_all_level.amp_activity_id, 
        CASE 3
            WHEN v_primaryprogram_all_level.l1 THEN v_primaryprogram_all_level.n1
            WHEN v_primaryprogram_all_level.l2 THEN v_primaryprogram_all_level.n2
            WHEN v_primaryprogram_all_level.l3 THEN v_primaryprogram_all_level.n3
            WHEN v_primaryprogram_all_level.l4 THEN v_primaryprogram_all_level.n4
            WHEN v_primaryprogram_all_level.l5 THEN v_primaryprogram_all_level.n5
            WHEN v_primaryprogram_all_level.l6 THEN v_primaryprogram_all_level.n6
            WHEN v_primaryprogram_all_level.l7 THEN v_primaryprogram_all_level.n7
            WHEN v_primaryprogram_all_level.l8 THEN v_primaryprogram_all_level.n8
            ELSE NULL::character varying
        END, 
        CASE 3
            WHEN v_primaryprogram_all_level.l1 THEN v_primaryprogram_all_level.amp_program_id1
            WHEN v_primaryprogram_all_level.l2 THEN v_primaryprogram_all_level.amp_program_id2
            WHEN v_primaryprogram_all_level.l3 THEN v_primaryprogram_all_level.amp_program_id3
            WHEN v_primaryprogram_all_level.l4 THEN v_primaryprogram_all_level.amp_program_id4
            WHEN v_primaryprogram_all_level.l5 THEN v_primaryprogram_all_level.amp_program_id5
            WHEN v_primaryprogram_all_level.l6 THEN v_primaryprogram_all_level.amp_program_id6
            WHEN v_primaryprogram_all_level.l7 THEN v_primaryprogram_all_level.amp_program_id7
            WHEN v_primaryprogram_all_level.l8 THEN v_primaryprogram_all_level.amp_program_id8
            ELSE NULL::bigint
        END;
        

CREATE OR REPLACE VIEW v_primaryprogram_level_4 AS 
 SELECT v_primaryprogram_all_level.amp_activity_id, 
        CASE 4
            WHEN v_primaryprogram_all_level.l1 THEN v_primaryprogram_all_level.n1
            WHEN v_primaryprogram_all_level.l2 THEN v_primaryprogram_all_level.n2
            WHEN v_primaryprogram_all_level.l3 THEN v_primaryprogram_all_level.n3
            WHEN v_primaryprogram_all_level.l4 THEN v_primaryprogram_all_level.n4
            WHEN v_primaryprogram_all_level.l5 THEN v_primaryprogram_all_level.n5
            WHEN v_primaryprogram_all_level.l6 THEN v_primaryprogram_all_level.n6
            WHEN v_primaryprogram_all_level.l7 THEN v_primaryprogram_all_level.n7
            WHEN v_primaryprogram_all_level.l8 THEN v_primaryprogram_all_level.n8
            ELSE NULL::character varying
        END AS name, 
        CASE 4
            WHEN v_primaryprogram_all_level.l1 THEN v_primaryprogram_all_level.amp_program_id1
            WHEN v_primaryprogram_all_level.l2 THEN v_primaryprogram_all_level.amp_program_id2
            WHEN v_primaryprogram_all_level.l3 THEN v_primaryprogram_all_level.amp_program_id3
            WHEN v_primaryprogram_all_level.l4 THEN v_primaryprogram_all_level.amp_program_id4
            WHEN v_primaryprogram_all_level.l5 THEN v_primaryprogram_all_level.amp_program_id5
            WHEN v_primaryprogram_all_level.l6 THEN v_primaryprogram_all_level.amp_program_id6
            WHEN v_primaryprogram_all_level.l7 THEN v_primaryprogram_all_level.amp_program_id7
            WHEN v_primaryprogram_all_level.l8 THEN v_primaryprogram_all_level.amp_program_id8
            ELSE NULL::bigint
        END AS amp_program_id, sum(v_primaryprogram_all_level.program_percentage) AS program_percentage
   FROM v_primaryprogram_all_level
  WHERE (
  		CASE 4
            WHEN v_primaryprogram_all_level.l1 THEN v_primaryprogram_all_level.n1
            WHEN v_primaryprogram_all_level.l2 THEN v_primaryprogram_all_level.n2
            WHEN v_primaryprogram_all_level.l3 THEN v_primaryprogram_all_level.n3
            WHEN v_primaryprogram_all_level.l4 THEN v_primaryprogram_all_level.n4
            WHEN v_primaryprogram_all_level.l5 THEN v_primaryprogram_all_level.n5
            WHEN v_primaryprogram_all_level.l6 THEN v_primaryprogram_all_level.n6
            WHEN v_primaryprogram_all_level.l7 THEN v_primaryprogram_all_level.n7
            WHEN v_primaryprogram_all_level.l8 THEN v_primaryprogram_all_level.n8
            ELSE NULL::character varying
        END
  ) is not null 
  GROUP BY v_primaryprogram_all_level.amp_activity_id, 
        CASE 4
            WHEN v_primaryprogram_all_level.l1 THEN v_primaryprogram_all_level.n1
            WHEN v_primaryprogram_all_level.l2 THEN v_primaryprogram_all_level.n2
            WHEN v_primaryprogram_all_level.l3 THEN v_primaryprogram_all_level.n3
            WHEN v_primaryprogram_all_level.l4 THEN v_primaryprogram_all_level.n4
            WHEN v_primaryprogram_all_level.l5 THEN v_primaryprogram_all_level.n5
            WHEN v_primaryprogram_all_level.l6 THEN v_primaryprogram_all_level.n6
            WHEN v_primaryprogram_all_level.l7 THEN v_primaryprogram_all_level.n7
            WHEN v_primaryprogram_all_level.l8 THEN v_primaryprogram_all_level.n8
            ELSE NULL::character varying
        END, 
        CASE 4
            WHEN v_primaryprogram_all_level.l1 THEN v_primaryprogram_all_level.amp_program_id1
            WHEN v_primaryprogram_all_level.l2 THEN v_primaryprogram_all_level.amp_program_id2
            WHEN v_primaryprogram_all_level.l3 THEN v_primaryprogram_all_level.amp_program_id3
            WHEN v_primaryprogram_all_level.l4 THEN v_primaryprogram_all_level.amp_program_id4
            WHEN v_primaryprogram_all_level.l5 THEN v_primaryprogram_all_level.amp_program_id5
            WHEN v_primaryprogram_all_level.l6 THEN v_primaryprogram_all_level.amp_program_id6
            WHEN v_primaryprogram_all_level.l7 THEN v_primaryprogram_all_level.amp_program_id7
            WHEN v_primaryprogram_all_level.l8 THEN v_primaryprogram_all_level.amp_program_id8
            ELSE NULL::bigint
        END;
                
CREATE OR REPLACE VIEW v_primaryprogram_level_5 AS 
 SELECT v_primaryprogram_all_level.amp_activity_id, 
        CASE 5
            WHEN v_primaryprogram_all_level.l1 THEN v_primaryprogram_all_level.n1
            WHEN v_primaryprogram_all_level.l2 THEN v_primaryprogram_all_level.n2
            WHEN v_primaryprogram_all_level.l3 THEN v_primaryprogram_all_level.n3
            WHEN v_primaryprogram_all_level.l4 THEN v_primaryprogram_all_level.n4
            WHEN v_primaryprogram_all_level.l5 THEN v_primaryprogram_all_level.n5
            WHEN v_primaryprogram_all_level.l6 THEN v_primaryprogram_all_level.n6
            WHEN v_primaryprogram_all_level.l7 THEN v_primaryprogram_all_level.n7
            WHEN v_primaryprogram_all_level.l8 THEN v_primaryprogram_all_level.n8
            ELSE NULL::character varying
        END AS name, 
        CASE 5
            WHEN v_primaryprogram_all_level.l1 THEN v_primaryprogram_all_level.amp_program_id1
            WHEN v_primaryprogram_all_level.l2 THEN v_primaryprogram_all_level.amp_program_id2
            WHEN v_primaryprogram_all_level.l3 THEN v_primaryprogram_all_level.amp_program_id3
            WHEN v_primaryprogram_all_level.l4 THEN v_primaryprogram_all_level.amp_program_id4
            WHEN v_primaryprogram_all_level.l5 THEN v_primaryprogram_all_level.amp_program_id5
            WHEN v_primaryprogram_all_level.l6 THEN v_primaryprogram_all_level.amp_program_id6
            WHEN v_primaryprogram_all_level.l7 THEN v_primaryprogram_all_level.amp_program_id7
            WHEN v_primaryprogram_all_level.l8 THEN v_primaryprogram_all_level.amp_program_id8
            ELSE NULL::bigint
        END AS amp_program_id, sum(v_primaryprogram_all_level.program_percentage) AS program_percentage
   FROM v_primaryprogram_all_level
  WHERE (
  		CASE 5
            WHEN v_primaryprogram_all_level.l1 THEN v_primaryprogram_all_level.n1
            WHEN v_primaryprogram_all_level.l2 THEN v_primaryprogram_all_level.n2
            WHEN v_primaryprogram_all_level.l3 THEN v_primaryprogram_all_level.n3
            WHEN v_primaryprogram_all_level.l4 THEN v_primaryprogram_all_level.n4
            WHEN v_primaryprogram_all_level.l5 THEN v_primaryprogram_all_level.n5
            WHEN v_primaryprogram_all_level.l6 THEN v_primaryprogram_all_level.n6
            WHEN v_primaryprogram_all_level.l7 THEN v_primaryprogram_all_level.n7
            WHEN v_primaryprogram_all_level.l8 THEN v_primaryprogram_all_level.n8
            ELSE NULL::character varying
        END
  ) is not null 
  GROUP BY v_primaryprogram_all_level.amp_activity_id, 
        CASE 5
            WHEN v_primaryprogram_all_level.l1 THEN v_primaryprogram_all_level.n1
            WHEN v_primaryprogram_all_level.l2 THEN v_primaryprogram_all_level.n2
            WHEN v_primaryprogram_all_level.l3 THEN v_primaryprogram_all_level.n3
            WHEN v_primaryprogram_all_level.l4 THEN v_primaryprogram_all_level.n4
            WHEN v_primaryprogram_all_level.l5 THEN v_primaryprogram_all_level.n5
            WHEN v_primaryprogram_all_level.l6 THEN v_primaryprogram_all_level.n6
            WHEN v_primaryprogram_all_level.l7 THEN v_primaryprogram_all_level.n7
            WHEN v_primaryprogram_all_level.l8 THEN v_primaryprogram_all_level.n8
            ELSE NULL::character varying
        END, 
        CASE 5
            WHEN v_primaryprogram_all_level.l1 THEN v_primaryprogram_all_level.amp_program_id1
            WHEN v_primaryprogram_all_level.l2 THEN v_primaryprogram_all_level.amp_program_id2
            WHEN v_primaryprogram_all_level.l3 THEN v_primaryprogram_all_level.amp_program_id3
            WHEN v_primaryprogram_all_level.l4 THEN v_primaryprogram_all_level.amp_program_id4
            WHEN v_primaryprogram_all_level.l5 THEN v_primaryprogram_all_level.amp_program_id5
            WHEN v_primaryprogram_all_level.l6 THEN v_primaryprogram_all_level.amp_program_id6
            WHEN v_primaryprogram_all_level.l7 THEN v_primaryprogram_all_level.amp_program_id7
            WHEN v_primaryprogram_all_level.l8 THEN v_primaryprogram_all_level.amp_program_id8
            ELSE NULL::bigint
        END;
                        

CREATE OR REPLACE VIEW v_primaryprogram_level_6 AS 
 SELECT v_primaryprogram_all_level.amp_activity_id, 
        CASE 6
            WHEN v_primaryprogram_all_level.l1 THEN v_primaryprogram_all_level.n1
            WHEN v_primaryprogram_all_level.l2 THEN v_primaryprogram_all_level.n2
            WHEN v_primaryprogram_all_level.l3 THEN v_primaryprogram_all_level.n3
            WHEN v_primaryprogram_all_level.l4 THEN v_primaryprogram_all_level.n4
            WHEN v_primaryprogram_all_level.l5 THEN v_primaryprogram_all_level.n5
            WHEN v_primaryprogram_all_level.l6 THEN v_primaryprogram_all_level.n6
            WHEN v_primaryprogram_all_level.l7 THEN v_primaryprogram_all_level.n7
            WHEN v_primaryprogram_all_level.l8 THEN v_primaryprogram_all_level.n8
            ELSE NULL::character varying
        END AS name, 
        CASE 6
            WHEN v_primaryprogram_all_level.l1 THEN v_primaryprogram_all_level.amp_program_id1
            WHEN v_primaryprogram_all_level.l2 THEN v_primaryprogram_all_level.amp_program_id2
            WHEN v_primaryprogram_all_level.l3 THEN v_primaryprogram_all_level.amp_program_id3
            WHEN v_primaryprogram_all_level.l4 THEN v_primaryprogram_all_level.amp_program_id4
            WHEN v_primaryprogram_all_level.l5 THEN v_primaryprogram_all_level.amp_program_id5
            WHEN v_primaryprogram_all_level.l6 THEN v_primaryprogram_all_level.amp_program_id6
            WHEN v_primaryprogram_all_level.l7 THEN v_primaryprogram_all_level.amp_program_id7
            WHEN v_primaryprogram_all_level.l8 THEN v_primaryprogram_all_level.amp_program_id8
            ELSE NULL::bigint
        END AS amp_program_id, sum(v_primaryprogram_all_level.program_percentage) AS program_percentage
   FROM v_primaryprogram_all_level
  WHERE (
  		CASE 6
            WHEN v_primaryprogram_all_level.l1 THEN v_primaryprogram_all_level.n1
            WHEN v_primaryprogram_all_level.l2 THEN v_primaryprogram_all_level.n2
            WHEN v_primaryprogram_all_level.l3 THEN v_primaryprogram_all_level.n3
            WHEN v_primaryprogram_all_level.l4 THEN v_primaryprogram_all_level.n4
            WHEN v_primaryprogram_all_level.l5 THEN v_primaryprogram_all_level.n5
            WHEN v_primaryprogram_all_level.l6 THEN v_primaryprogram_all_level.n6
            WHEN v_primaryprogram_all_level.l7 THEN v_primaryprogram_all_level.n7
            WHEN v_primaryprogram_all_level.l8 THEN v_primaryprogram_all_level.n8
            ELSE NULL::character varying
        END
  ) is not null 
  GROUP BY v_primaryprogram_all_level.amp_activity_id, 
        CASE 6
            WHEN v_primaryprogram_all_level.l1 THEN v_primaryprogram_all_level.n1
            WHEN v_primaryprogram_all_level.l2 THEN v_primaryprogram_all_level.n2
            WHEN v_primaryprogram_all_level.l3 THEN v_primaryprogram_all_level.n3
            WHEN v_primaryprogram_all_level.l4 THEN v_primaryprogram_all_level.n4
            WHEN v_primaryprogram_all_level.l5 THEN v_primaryprogram_all_level.n5
            WHEN v_primaryprogram_all_level.l6 THEN v_primaryprogram_all_level.n6
            WHEN v_primaryprogram_all_level.l7 THEN v_primaryprogram_all_level.n7
            WHEN v_primaryprogram_all_level.l8 THEN v_primaryprogram_all_level.n8
            ELSE NULL::character varying
        END, 
        CASE 6
            WHEN v_primaryprogram_all_level.l1 THEN v_primaryprogram_all_level.amp_program_id1
            WHEN v_primaryprogram_all_level.l2 THEN v_primaryprogram_all_level.amp_program_id2
            WHEN v_primaryprogram_all_level.l3 THEN v_primaryprogram_all_level.amp_program_id3
            WHEN v_primaryprogram_all_level.l4 THEN v_primaryprogram_all_level.amp_program_id4
            WHEN v_primaryprogram_all_level.l5 THEN v_primaryprogram_all_level.amp_program_id5
            WHEN v_primaryprogram_all_level.l6 THEN v_primaryprogram_all_level.amp_program_id6
            WHEN v_primaryprogram_all_level.l7 THEN v_primaryprogram_all_level.amp_program_id7
            WHEN v_primaryprogram_all_level.l8 THEN v_primaryprogram_all_level.amp_program_id8
            ELSE NULL::bigint
        END;
        

CREATE OR REPLACE VIEW v_primaryprogram_level_7 AS 
 SELECT v_primaryprogram_all_level.amp_activity_id, 
        CASE 7
            WHEN v_primaryprogram_all_level.l1 THEN v_primaryprogram_all_level.n1
            WHEN v_primaryprogram_all_level.l2 THEN v_primaryprogram_all_level.n2
            WHEN v_primaryprogram_all_level.l3 THEN v_primaryprogram_all_level.n3
            WHEN v_primaryprogram_all_level.l4 THEN v_primaryprogram_all_level.n4
            WHEN v_primaryprogram_all_level.l5 THEN v_primaryprogram_all_level.n5
            WHEN v_primaryprogram_all_level.l6 THEN v_primaryprogram_all_level.n6
            WHEN v_primaryprogram_all_level.l7 THEN v_primaryprogram_all_level.n7
            WHEN v_primaryprogram_all_level.l8 THEN v_primaryprogram_all_level.n8
            ELSE NULL::character varying
        END AS name, 
        CASE 7
            WHEN v_primaryprogram_all_level.l1 THEN v_primaryprogram_all_level.amp_program_id1
            WHEN v_primaryprogram_all_level.l2 THEN v_primaryprogram_all_level.amp_program_id2
            WHEN v_primaryprogram_all_level.l3 THEN v_primaryprogram_all_level.amp_program_id3
            WHEN v_primaryprogram_all_level.l4 THEN v_primaryprogram_all_level.amp_program_id4
            WHEN v_primaryprogram_all_level.l5 THEN v_primaryprogram_all_level.amp_program_id5
            WHEN v_primaryprogram_all_level.l6 THEN v_primaryprogram_all_level.amp_program_id6
            WHEN v_primaryprogram_all_level.l7 THEN v_primaryprogram_all_level.amp_program_id7
            WHEN v_primaryprogram_all_level.l8 THEN v_primaryprogram_all_level.amp_program_id8
            ELSE NULL::bigint
        END AS amp_program_id, sum(v_primaryprogram_all_level.program_percentage) AS program_percentage
   FROM v_primaryprogram_all_level
  WHERE (
  		CASE 7
            WHEN v_primaryprogram_all_level.l1 THEN v_primaryprogram_all_level.n1
            WHEN v_primaryprogram_all_level.l2 THEN v_primaryprogram_all_level.n2
            WHEN v_primaryprogram_all_level.l3 THEN v_primaryprogram_all_level.n3
            WHEN v_primaryprogram_all_level.l4 THEN v_primaryprogram_all_level.n4
            WHEN v_primaryprogram_all_level.l5 THEN v_primaryprogram_all_level.n5
            WHEN v_primaryprogram_all_level.l6 THEN v_primaryprogram_all_level.n6
            WHEN v_primaryprogram_all_level.l7 THEN v_primaryprogram_all_level.n7
            WHEN v_primaryprogram_all_level.l8 THEN v_primaryprogram_all_level.n8
            ELSE NULL::character varying
        END
  ) is not null 
  GROUP BY v_primaryprogram_all_level.amp_activity_id, 
        CASE 7
            WHEN v_primaryprogram_all_level.l1 THEN v_primaryprogram_all_level.n1
            WHEN v_primaryprogram_all_level.l2 THEN v_primaryprogram_all_level.n2
            WHEN v_primaryprogram_all_level.l3 THEN v_primaryprogram_all_level.n3
            WHEN v_primaryprogram_all_level.l4 THEN v_primaryprogram_all_level.n4
            WHEN v_primaryprogram_all_level.l5 THEN v_primaryprogram_all_level.n5
            WHEN v_primaryprogram_all_level.l6 THEN v_primaryprogram_all_level.n6
            WHEN v_primaryprogram_all_level.l7 THEN v_primaryprogram_all_level.n7
            WHEN v_primaryprogram_all_level.l8 THEN v_primaryprogram_all_level.n8
            ELSE NULL::character varying
        END, 
        CASE 7
            WHEN v_primaryprogram_all_level.l1 THEN v_primaryprogram_all_level.amp_program_id1
            WHEN v_primaryprogram_all_level.l2 THEN v_primaryprogram_all_level.amp_program_id2
            WHEN v_primaryprogram_all_level.l3 THEN v_primaryprogram_all_level.amp_program_id3
            WHEN v_primaryprogram_all_level.l4 THEN v_primaryprogram_all_level.amp_program_id4
            WHEN v_primaryprogram_all_level.l5 THEN v_primaryprogram_all_level.amp_program_id5
            WHEN v_primaryprogram_all_level.l6 THEN v_primaryprogram_all_level.amp_program_id6
            WHEN v_primaryprogram_all_level.l7 THEN v_primaryprogram_all_level.amp_program_id7
            WHEN v_primaryprogram_all_level.l8 THEN v_primaryprogram_all_level.amp_program_id8
            ELSE NULL::bigint
        END;
        
CREATE OR REPLACE VIEW v_primaryprogram_level_8 AS 
 SELECT v_primaryprogram_all_level.amp_activity_id, 
        CASE 8
            WHEN v_primaryprogram_all_level.l1 THEN v_primaryprogram_all_level.n1
            WHEN v_primaryprogram_all_level.l2 THEN v_primaryprogram_all_level.n2
            WHEN v_primaryprogram_all_level.l3 THEN v_primaryprogram_all_level.n3
            WHEN v_primaryprogram_all_level.l4 THEN v_primaryprogram_all_level.n4
            WHEN v_primaryprogram_all_level.l5 THEN v_primaryprogram_all_level.n5
            WHEN v_primaryprogram_all_level.l6 THEN v_primaryprogram_all_level.n6
            WHEN v_primaryprogram_all_level.l7 THEN v_primaryprogram_all_level.n7
            WHEN v_primaryprogram_all_level.l8 THEN v_primaryprogram_all_level.n8
            ELSE NULL::character varying
        END AS name, 
        CASE 8
            WHEN v_primaryprogram_all_level.l1 THEN v_primaryprogram_all_level.amp_program_id1
            WHEN v_primaryprogram_all_level.l2 THEN v_primaryprogram_all_level.amp_program_id2
            WHEN v_primaryprogram_all_level.l3 THEN v_primaryprogram_all_level.amp_program_id3
            WHEN v_primaryprogram_all_level.l4 THEN v_primaryprogram_all_level.amp_program_id4
            WHEN v_primaryprogram_all_level.l5 THEN v_primaryprogram_all_level.amp_program_id5
            WHEN v_primaryprogram_all_level.l6 THEN v_primaryprogram_all_level.amp_program_id6
            WHEN v_primaryprogram_all_level.l7 THEN v_primaryprogram_all_level.amp_program_id7
            WHEN v_primaryprogram_all_level.l8 THEN v_primaryprogram_all_level.amp_program_id8
            ELSE NULL::bigint
        END AS amp_program_id, sum(v_primaryprogram_all_level.program_percentage) AS program_percentage
   FROM v_primaryprogram_all_level
  WHERE (
  		CASE 8
            WHEN v_primaryprogram_all_level.l1 THEN v_primaryprogram_all_level.n1
            WHEN v_primaryprogram_all_level.l2 THEN v_primaryprogram_all_level.n2
            WHEN v_primaryprogram_all_level.l3 THEN v_primaryprogram_all_level.n3
            WHEN v_primaryprogram_all_level.l4 THEN v_primaryprogram_all_level.n4
            WHEN v_primaryprogram_all_level.l5 THEN v_primaryprogram_all_level.n5
            WHEN v_primaryprogram_all_level.l6 THEN v_primaryprogram_all_level.n6
            WHEN v_primaryprogram_all_level.l7 THEN v_primaryprogram_all_level.n7
            WHEN v_primaryprogram_all_level.l8 THEN v_primaryprogram_all_level.n8
            ELSE NULL::character varying
        END
  ) is not null 
  GROUP BY v_primaryprogram_all_level.amp_activity_id, 
        CASE 8
            WHEN v_primaryprogram_all_level.l1 THEN v_primaryprogram_all_level.n1
            WHEN v_primaryprogram_all_level.l2 THEN v_primaryprogram_all_level.n2
            WHEN v_primaryprogram_all_level.l3 THEN v_primaryprogram_all_level.n3
            WHEN v_primaryprogram_all_level.l4 THEN v_primaryprogram_all_level.n4
            WHEN v_primaryprogram_all_level.l5 THEN v_primaryprogram_all_level.n5
            WHEN v_primaryprogram_all_level.l6 THEN v_primaryprogram_all_level.n6
            WHEN v_primaryprogram_all_level.l7 THEN v_primaryprogram_all_level.n7
            WHEN v_primaryprogram_all_level.l8 THEN v_primaryprogram_all_level.n8
            ELSE NULL::character varying
        END, 
        CASE 8
            WHEN v_primaryprogram_all_level.l1 THEN v_primaryprogram_all_level.amp_program_id1
            WHEN v_primaryprogram_all_level.l2 THEN v_primaryprogram_all_level.amp_program_id2
            WHEN v_primaryprogram_all_level.l3 THEN v_primaryprogram_all_level.amp_program_id3
            WHEN v_primaryprogram_all_level.l4 THEN v_primaryprogram_all_level.amp_program_id4
            WHEN v_primaryprogram_all_level.l5 THEN v_primaryprogram_all_level.amp_program_id5
            WHEN v_primaryprogram_all_level.l6 THEN v_primaryprogram_all_level.amp_program_id6
            WHEN v_primaryprogram_all_level.l7 THEN v_primaryprogram_all_level.amp_program_id7
            WHEN v_primaryprogram_all_level.l8 THEN v_primaryprogram_all_level.amp_program_id8
            ELSE NULL::bigint
        END;                                        
        
        
      </lang>
    </script>
  </apply>

</tns:patch>
