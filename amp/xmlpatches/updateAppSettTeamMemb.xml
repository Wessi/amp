<?xml version="1.0" encoding="UTF-8"?>
<tns:patch closeOnSuccess="true" retryOnFail="false" xmlns:tns="http://docs.ampdev.net/schemas/xmlpatcher" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://docs.ampdev.net/schemas/xmlpatcher ../doc/xmlpatcher.xsd ">
    <jira>AMP-7684</jira>
    <keyword>keyword</keyword>
    <author>Medea Gugushvili</author>
    <description>Updated incomplete data of team members, because the app. settings were missing for them, they were unable to login. </description>
    <apply>
        <script>
            <lang delimiter=";" type="mysql">
                INSERT INTO amp_application_settings(def_rec_per_page,language,team_id,currency_id ,fis_cal_id,member)
                select settings.def_rec_per_page, settings.language,settings.team_id,settings.currency_id ,settings.fis_cal_id,member.amp_team_mem_id from
                (select def_rec_per_page,language,team_id,currency_id ,fis_cal_id from  amp_application_settings a where a.team_id in (select amp_team_id from amp_team_member left join amp_application_settings on member=amp_team_mem_id where amp_app_settings_id is NULL) and a.member is null ) as settings
                inner join
                (select amp_team_id,amp_team_mem_id from amp_team_member left join amp_application_settings on member=amp_team_mem_id where amp_app_settings_id is NULL) member on member.amp_team_id=settings.team_id;
            </lang>
        </script>
    </apply>

</tns:patch>