CREATE OR REPLACE SQL SECURITY DEFINER VIEW  `v_tertiary_sectors` AS select `sa`.`amp_activity_id` AS `amp_activity_id`,`getSectorName`(`getParentSectorId`(`s`.`amp_sector_id`)) AS `sectorname`,`getParentSectorId`(`s`.`amp_sector_id`) AS `amp_sector_id`,sum(`sa`.`sector_percentage`) AS `sector_percentage`,`s`.`amp_sec_scheme_id` AS `amp_sector_scheme_id` from ((`amp_activity_sector` `sa` join `amp_sector` `s`) join `amp_sector_scheme` `ss`) where ((`s`.`amp_sector_id` = `sa`.`amp_sector_id`) and `s`.`amp_sec_scheme_id` in (select `amp_classification_config`.`classification_id` AS `classification_id` from `amp_classification_config` where (`amp_classification_config`.`name` = _utf8'Tertiary')) and (`s`.`amp_sec_scheme_id` = `ss`.`amp_sec_scheme_id`)) group by `sa`.`amp_activity_id`,`getSectorName`(`getParentSectorId`(`s`.`amp_sector_id`)) order by `sa`.`amp_activity_id`,`getSectorName`(`getParentSectorId`(`s`.`amp_sector_id`));
CREATE OR REPLACE SQL SECURITY DEFINER VIEW `v_tertiary_sub_sectors` AS select `sa`.`amp_activity_id` AS `amp_activity_id`,`getSectorName`(`getParentSubSectorId`(`s`.`amp_sector_id`)) AS `sectorname`,`getParentSubSectorId`(`s`.`amp_sector_id`) AS `amp_sector_id`,sum(`sa`.`sector_percentage`) AS `sector_percentage`,`s`.`amp_sec_scheme_id` AS `amp_sec_scheme_id`,`ss`.`sec_scheme_name` AS `sec_scheme_name` from (((`amp_sector_scheme` `ss` join `amp_classification_config` `cc` on(((`cc`.`name` = _utf8'Tertiary') and (`cc`.`classification_id` = `ss`.`amp_sec_scheme_id`)))) join `amp_sector` `s` on(((`s`.`amp_sec_scheme_id` = `ss`.`amp_sec_scheme_id`) and (`getSectorDepth`(`s`.`amp_sector_id`) >= 1)))) join `amp_activity_sector` `sa` on(((`sa`.`amp_sector_id` = `s`.`amp_sector_id`) and (`sa`.`classification_config_id` = `cc`.`id`)))) group by `sa`.`amp_activity_id`,`getParentSubSectorId`(`s`.`amp_sector_id`) order by `sa`.`amp_activity_id`,`getSectorName`(`getParentSubSectorId`(`s`.`amp_sector_id`));
CREATE OR REPLACE SQL SECURITY DEFINER VIEW `v_tertiary_sub_sub_sectors` AS select `a`.`amp_activity_id` AS `amp_activity_id`,`s`.`name` AS `name`,`s`.`amp_sector_id` AS `amp_sector_id`,`a`.`sector_percentage` AS `sector_percentage` from (`amp_activity_sector` `a` join `amp_sector` `s`) where ((`a`.`amp_sector_id` = `s`.`amp_sector_id`) and (`getSectorDepth`(`s`.`amp_sector_id`) = 2) and `s`.`amp_sec_scheme_id` in (select `c`.`classification_id` AS `classification_id` from `amp_classification_config` `c` where (`c`.`name` = _utf8'Tertiary'))) order by `a`.`amp_activity_id`,`s`.`name`;

insert into amp_columns(columnName, cellType, extractorview,relatedContentPersisterClass,filterRetrievable ) values("Tertiary Sector", "org.dgfoundation.amp.ar.cell.MetaTextCell","v_tertiary_sectors",'org.digijava.module.aim.dbentity.AmpSector',true);
insert into amp_columns(columnName, cellType, extractorview,relatedContentPersisterClass,filterRetrievable ) values("Tertiary Sector Sub-Sector", "org.dgfoundation.amp.ar.cell.MetaTextCell","v_tertiary_sub_sectors",'org.digijava.module.aim.dbentity.AmpSector',true);
insert into amp_columns(columnName, cellType, extractorview,relatedContentPersisterClass,filterRetrievable ) values("Tertiary Sector Sub-Sub-Sector", "org.dgfoundation.amp.ar.cell.MetaTextCell","v_tertiary_sub_sub_sectors",'org.digijava.module.aim.dbentity.AmpSector',true);