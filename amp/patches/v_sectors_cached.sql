CREATE VIEW `v_sectors_cached` AS select `sa`.`amp_activity_id` AS `amp_activity_id`,`getSectorName`(`getParentSectorId`(`s`.`amp_sector_id`)) AS `sectorname`,`getParentSectorId`(`s`.`amp_sector_id`) AS `amp_sector_id`,`s`.`amp_sec_scheme_id` AS `amp_sector_scheme_id`,`ss`.`sec_scheme_name` AS `sec_scheme_name`,`sa`.`sector_percentage` AS `sector_percentage`,((`fd`.`transaction_amount` * `sa`.`sector_percentage`) / 100) AS `transaction_amount`,`fd`.`transaction_type` AS `transaction_type`,`fd`.`adjustment_type` AS `adjustment_type`,`fd`.`transaction_date` AS `transaction_date`,`fd`.`fixed_exchange_rate` AS `fixed_exchange_rate`,`c`.`currency_code` AS `currency_code` from ((`amp_funding_detail` `fd` left join ((((`amp_sector_scheme` `ss` join `amp_classification_config` `cc` on((`cc`.`name` = _latin1'Primary'))) join `amp_sector` `s` on((`s`.`amp_sec_scheme_id` = `ss`.`amp_sec_scheme_id`))) join `amp_activity_sector` `sa` on((`sa`.`amp_sector_id` = `s`.`amp_sector_id`))) join `amp_funding` `f` on((`sa`.`amp_activity_id` = `f`.`amp_activity_id`))) on((`f`.`amp_funding_id` = `fd`.`AMP_FUNDING_ID`))) join `amp_currency` `c` on((`fd`.`amp_currency_id` = `c`.`amp_currency_id`))) where ((`cc`.`classification_id` = `ss`.`amp_sec_scheme_id`) and (`sa`.`classification_config_id` = `cc`.`id`)) group by `sa`.`amp_activity_id`,`getParentSectorId`(`s`.`amp_sector_id`),`fd`.`transaction_type`,`fd`.`amp_fund_detail_id`,`f`.`amp_funding_id`,`fd`.`adjustment_type`,`s`.`sector_code` order by `sa`.`amp_activity_id`,`getSectorName`(`getParentSectorId`(`s`.`amp_sector_id`)),`fd`.`transaction_type`,`f`.`amp_funding_id`;