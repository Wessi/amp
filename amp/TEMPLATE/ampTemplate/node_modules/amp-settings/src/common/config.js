var _ = require('underscore');
var Utils = require('./utils');
var Constants = require('./constants');
module.exports = {
	DASHBOARDS : {
		DEFINITION_URL : '/rest/amp/settings',
		parse : function(settings) {
			return _(settings).chain()
			// mark weird options with non-int keys hidden
			.map(Utils.tagIf(function(setting) {
				return !Utils.isIntStr(setting.id);
			}, 'ignore'))
			// mark funding type setting hidden, since it's set per-chart...
			.map(Utils.tagIf(function(setting) {
				return setting.id === Constants.SETTINGS.FUNDING_TYPE_ID;
			}, 'ignore'))
			// ...but also flag it so the charts can see the the funding type options
			.map(Utils.tagIf(function(setting) {
				return setting.id === Constants.SETTINGS.FUNDING_TYPE_ID;
			}, 'ftype'))
			// mark all options as selected per the defaults provided
			.map(function(setting) {
				return _(setting).extend({
					options : _(setting.options).map(Utils.tagIf(function(option) {
						return option.id === setting.defaultId;
					}, 'selected'))
				})
			}).value();
		}
	},
	DEFAULT : {
		DEFINITION_URL : '/rest/amp/settings',
		IS_POPUP : true
	}
};
