var fs = require('fs');
var _ = require('underscore');
var $ = require('jquery');
var Backbone = require('backbone');
//loading hacks
Backbone.$ = $;

var bootstrap_enabled = (typeof $().modal == 'function');

if (bootstrap_enabled) {
  require('bootstrap/dist/js/bootstrap');
}

var MenuView = require('./src/views/menu-view.js');
var HeaderFooterView = require('./src/views/header-footer-view.js');

/* example of use
 * this.menus = new Menus({
 *   translator: this.translator,
 *   caller: 'GIS'
 * });
 */


function Widget() {
  this.initialize.apply(this, arguments);
}

_.extend(Widget.prototype, Backbone.Events, {

    initialize: function(options) {
    options = _.defaults(options, {});
    if (_.has(options, 'sync')) {
      Backbone.sync = options.sync;
    }
    this.headerFooter = new HeaderFooterView(options);
    this.menu = new MenuView(options);

    this.listenTo(this.headerFooter, 'all', function() {
      this.trigger.apply(this, arguments);
    });
    this.listenTo(this.menu, 'all', function() {
        this.trigger.apply(this, arguments);
      });
  },

});


module.exports = {
  layout: Widget,
  header: fs.readFileSync(__dirname + '/header.html', 'UTF8'),
};
